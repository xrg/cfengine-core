<html lang="en"><head>
<title>GNU cfengine</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="GNU cfengine">
<meta name=generator content="makeinfo 4.0">
<link href="http://texinfo.org/" rel=generator-home>
</head><body>

<p><hr>
Node:<a name="Top">Top</a>,
Next:<a rel=next href="#Reference%20introduction">Reference introduction</a>,
Previous:<a rel=previous href="#(dir)">(dir)</a>,
Up:<a rel=up href="#(dir)">(dir)</a>
<br>

<h1>Cfengine-Reference</h1>

<ul>
<li><a href="#Reference%20introduction">Reference introduction</a>: 
<li><a href="#Cfkey">Cfkey</a>: 
<li><a href="#Cfagent%20reference">Cfagent reference</a>: 
<li><a href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>: 
<li><a href="#Cfexecd%20reference">Cfexecd reference</a>: 
<li><a href="#Problem%20solving">Problem solving</a>: 
<li><a href="#Example%20configuration%20file">Example configuration file</a>: 
<li><a href="#Variable%20Index">Variable Index</a>: 
<li><a href="#Concept%20Index">Concept Index</a>: 
<li><a href="#FAQ%20Index">FAQ Index</a>: 
</ul>

<p><hr>
Node:<a name="Reference%20introduction">Reference introduction</a>,
Next:<a rel=next href="#Cfkey">Cfkey</a>,
Previous:<a rel=previous href="#Top">Top</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Inroduction to reference manual</h1>

<p>The purpose of the cfengine reference manual is to collect together and
document the raw facts about the different components of cfengine. Once
you have become proficient in the use of cfengine, you will no longer
have need of the tutorial. The reference manual, on the other hand,
changes with each version of cfengine. You will be able to use it
online, or in printed form to find out the details you require to
implement configurations in practice.

<ul>
<li><a href="#Installation">Installation</a>: 
<li><a href="#Work%20directory">Work directory</a>: 
<li><a href="#Hard%20classes">Hard classes</a>: 
<li><a href="#Evaluated%20classes">Evaluated classes</a>: 
<li><a href="#Filenames%20and%20paths">Filenames and paths</a>: 
</ul>

<p><hr>
Node:<a name="Installation">Installation</a>,
Next:<a rel=next href="#Work%20directory">Work directory</a>,
Previous:<a rel=previous href="#Reference%20introduction">Reference introduction</a>,
Up:<a rel=up href="#Reference%20introduction">Reference introduction</a>
<br>

<h2>Installation</h2>

<p>In order to install cfengine, you should first ensure that the following
packages are installed.

<pre>OpenSSL                   http://www.openssl.org
Berkeley DB 3.2 or later  http://www.sleepycat.com
</pre>

<p>The preferred method of installation is then
<pre>tar zxf cfengine-x.x.x.tar.gz
cd cfengine-x.x.x
./configure
make
make install
</pre>

<p>This results in binaries being installed in <code>/usr/local/sbin</code>. 
Since this is not necessarily a local file system on all hosts, users
are encouraged to keep local copies of the binaries on each host, inside
the cfengine trusted work directory.

<p><hr>
Node:<a name="Work%20directory">Work directory</a>,
Next:<a rel=next href="#Hard%20classes">Hard classes</a>,
Previous:<a rel=previous href="#Installation">Installation</a>,
Up:<a rel=up href="#Reference%20introduction">Reference introduction</a>
<br>

<h2>Work directory</h2>

<p>In order to achieve the desired simplifications, it was decided to
reserve a private work area for the cfengine tool-set. In cfengine 1.x,
the administrator could choose the locations of configuration files, locks,
and logging data independently. In cfengine 2.x, this diversity has been rationalized
to a single directory which defaults to <code>/var/cfengine</code> (by analogy with
<code>/var/cron</code>):

<pre>/var/cfengine
/var/cfengine/bin
/var/cfengine/inputs
/var/cfengine/outputs
</pre>

<p>The installation location
<code>/usr/local/sbin</code> is not necessarily a local file system, and cannot
therefore be trusted i) to be present, and ii) to be authentic on an
arbitrary system.

<p>Similarly, a trusted cache of the input files must now be maintained
in the <code>inputs</code> sub-directory. When cfengine is invoked by the
scheduler, it reads only from this directory. It is up to the user to
keep this cache updated, on each host. This simplifies and
consolidates the cfengine resources in a single place. The environment
variable <code>CFINPUTS</code> still overrides this default location, as before,
but in its absence or when called from the scheduler, this becomes the
location of trusted files.  A special configuration file cf.update is
parsed and run before the main configuration is parsed, which is
used to ensure that the currently caches policy is up-to-date. 
If no value is set for <code>CFINPUTS</code>, then the default location
is the trusted cfengine directory
<code>/var/cfengine/inputs</code>.

<p>The <code>outputs</code> directory is now a record of spooled run-reports. These
are mailed to the administrator, as previously, or can be copied
to another central location and viewed in an alternative browser..

<p><hr>
Node:<a name="Hard%20classes">Hard classes</a>,
Next:<a rel=next href="#Evaluated%20classes">Evaluated classes</a>,
Previous:<a rel=previous href="#Work%20directory">Work directory</a>,
Up:<a rel=up href="#Reference%20introduction">Reference introduction</a>
<br>

<h2>Cfengine hard classes</h2>

<p>A single class can be one of several things:

<ul>

<li>The name of an operating system architecture e.g.  <code>ultrix</code>, <code>sun4</code> etc. 
This is referred to henceforth as a <em>hard class</em>.

<li>The (unqualified) name of a particular host. If your system returns a fully
qualified domain name for your host, cfagent truncates it so as to unqualify
the name.

<li>The name of a user-defined group of hosts.

<li>A day of the week (in the form <code>Monday Tuesday Wednesday..</code>).

<li>An hour of the day (in the form <code>Hr00, Hr01 ... Hr23</code>).

<li>Minutes in the hour (in the form <code>Min00, Min17 ... Min45</code>).

<li>A five minute interval in the hour (in the form <code>Min00_05, Min05_10 ... Min55_00</code>)

<li>A day of the month (in the form <code>Day1 ... Day31</code>).

<li>A month (in the form <code>January, February, ... December</code>).

<li>A year (in the form <code>Yr1997, Yr2001</code>).

<li>An arbitrary user-defined string.  (see the reference manual).

<li>The ip-address octets of any active interface, in the form (<code>ipv4_192_0_0_1</code>,
<code>ipv4_192_0_0</code>,<code>ipv4_192_0</code>,<code>ipv4_192</code>).

</ul>

<p>To see all of the classes define on a particular host, run
<pre>host# cfagent -p -v
</pre>
as a privileged user. Note that some of the classes are set only
if a trusted link can be established with cfenvd, i.e. if both
are running with privilege, and the <code>/var/cfengine/env_data</code>
file is secure.

<p><hr>
Node:<a name="Evaluated%20classes">Evaluated classes</a>,
Next:<a rel=next href="#Filenames%20and%20paths">Filenames and paths</a>,
Previous:<a rel=previous href="#Hard%20classes">Hard classes</a>,
Up:<a rel=up href="#Reference%20introduction">Reference introduction</a>
<br>

<h2>Evaluated classes</h2>

<p>Cfengine provides a number of in-built functions for evaluating classes,
based on file tests. Using these internal functions is quicker than
calling the shell <code>test</code> function. The time functions place their
arguments in chronological order.

<dl>
<dt><code>IsNewerThan(<var>f1</var>,<var>f2</var>)</code>
<dd>True if file 2 is modified more recently than file 1. (mtime)
<br><dt><code>AccessedBefore(<var>f1</var>,<var>f2</var>)</code>
<dd>True if file 1 had its last access earlier than file 2 (atime)
<br><dt><code>ChangedBefore(<var>f1</var>,<var>f2</var>)</code>
<dd>True if file 1's attributes were changed in any way before file 2's (ctime). 
<br><dt><code>FileExists(<var>file</var>)</code>
<dd>True if the named file object exists. 
<br><dt><code>IsDir(<var>f</var>)</code>
<dd>True if the named file object is a directory. 
<br><dt><code>IsLink(<var>f</var>)</code>
<dd>True if the named file object is a symbolic link. 
<br><dt><code>IsPlain(<var>f</var>)</code>
<dd>True if the named file object is a plain file. 
<br><dt><code>ReturnsZero(<var>command</var>)</code>
<dd>True if the named shell command returns with exit code zero (okay). 
</dl>

<p>For example:
<pre>
classes:

 access_to_dir = ( ReturnsZero(/bin/cd /mydir) )
 compare       = ( ChangedBefore(/etc/passwd_master,/etc/passwd) )
 isplain       = ( IsPlain(/tmp/import) )

</pre>

<p><hr>
Node:<a name="Filenames%20and%20paths">Filenames and paths</a>,
Previous:<a rel=previous href="#Evaluated%20classes">Evaluated classes</a>,
Up:<a rel=up href="#Reference%20introduction">Reference introduction</a>
<br>

<h2>Filenames and paths</h2>

<p>Filenames in Unix-lik operating systems

<p>The directory separator is the forward slash '/' character. All references
to file locations must be absolute names in cfengine, i.e. they must begin
with a complete specification of which directory they are in. For example:

<pre>/etc/passwd
/usr/local/masterfiles/distfile
</pre>

<p>The only place where it makes sense to refer to a file without a complete
directory specification is when searching through directories for different
kinds of file, e.g.
<pre>tidy:

  /home/user pattern=core age=0 recurse=inf

</pre>

<p>Here, one can write <code>core</code> without a path, because one is looking for any
file of that name in a number of directories.

<p>Cfengine was implemented primarily on Unix-like operating systems, but
has since been ported to Windows operating systems and MacOS X. The Windows
operating systems traditionally use a different filename convention. 
The following are all valid absolute file names under Windows:
<pre> c:\winnt
 c:/winnt
 /var/cfengine/inputs
 //<var>fileserver</var>/share2\dir
</pre>
The `drive' name "C:" in Windows refers to a partition or device. Unlike Unix,
Windows does not integrate these seamlessly into a single file-tree. 
This is not a valid absolute filename:
<pre>\var\cfengine\inputs
</pre>
Paths beginning with a backslash are assumed to be win32 paths.  They
must begin with a drive letter or double-slash server name.

<ul>
<li><a href="#Cfagent%20reference">Cfagent reference</a>: 
<li><a href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>: 
<li><a href="#Cfexecd%20reference">Cfexecd reference</a>: 
<li><a href="#Problem%20solving">Problem solving</a>: 
<li><a href="#Example%20configuration%20file">Example configuration file</a>: 
<li><a href="#Variable%20Index">Variable Index</a>: 
<li><a href="#Concept%20Index">Concept Index</a>: 
<li><a href="#FAQ%20Index">FAQ Index</a>: 
</ul>

<p><hr>
Node:<a name="Cfkey">Cfkey</a>,
Next:<a rel=next href="#Cfagent%20reference">Cfagent reference</a>,
Previous:<a rel=previous href="#Reference%20introduction">Reference introduction</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Cfkey reference</h1>

<p>The very first thing you should do on every host is to establish a
public-private key pair. To do this, you need to run the program
<pre>everyhost# cfkey
</pre>

<p>on every host. This program needs to produce random numbers, and needs a
source of randomness. A good strategy is to install and run the
<code>cfenvd</code> program for a week or two in advance of deploying cfengine
2, since <code>cfenvd</code> collects random events, which are an excellent source
of entropy for random number generation.

<p>If you get the error message "PRNG not seeded", it means that insufficient
data were found in order to make a random key. In that case, run <code>cfenvd</code>
for a few days more and try again.

<ul>
<li><a href="#Cfagent%20reference">Cfagent reference</a>: 
<li><a href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>: 
<li><a href="#Cfexecd%20reference">Cfexecd reference</a>: 
<li><a href="#Problem%20solving">Problem solving</a>: 
<li><a href="#Example%20configuration%20file">Example configuration file</a>: 
<li><a href="#Variable%20Index">Variable Index</a>: 
<li><a href="#Concept%20Index">Concept Index</a>: 
<li><a href="#FAQ%20Index">FAQ Index</a>: 
</ul>

<p><hr>
Node:<a name="Cfagent%20reference">Cfagent reference</a>,
Next:<a rel=next href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>,
Previous:<a rel=previous href="#Cfkey">Cfkey</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Cfagent reference</h1>

<ul>
<li><a href="#Cfagent%20intro">Cfagent intro</a>: 
<li><a href="#Special%20variables">Special variables</a>: 
<li><a href="#Cfengine%20classes">Cfengine classes</a>: 
<li><a href="#acl">acl</a>: 
<li><a href="#binservers">binservers</a>: 
<li><a href="#broadcast">broadcast</a>: 
<li><a href="#control">control</a>: 
<li><a href="#classes">classes</a>: 
<li><a href="#copy">copy</a>: 
<li><a href="#defaultroute">defaultroute</a>: 
<li><a href="#disks">disks</a>: 
<li><a href="#directories">directories</a>: 
<li><a href="#disable">disable</a>: 
<li><a href="#editfiles">editfiles</a>: 
<li><a href="#files">files</a>: 
<li><a href="#filters">filters</a>: 
<li><a href="#groups">groups</a>: 
<li><a href="#homeservers">homeservers</a>: 
<li><a href="#ignore">ignore</a>: 
<li><a href="#import">import</a>: 
<li><a href="#interfaces">interfaces</a>: 
<li><a href="#links">links</a>: 
<li><a href="#mailserver">mailserver</a>: 
<li><a href="#miscmounts">miscmounts</a>: 
<li><a href="#mountables">mountables</a>: 
<li><a href="#processes">processes</a>: 
<li><a href="#required">required</a>: 
<li><a href="#resolve">resolve</a>: 
<li><a href="#shellcommands">shellcommands</a>: 
<li><a href="#tidy">tidy</a>: 
<li><a href="#unmount">unmount</a>: 
</ul>

<p><hr>
Node:<a name="Cfagent%20intro">Cfagent intro</a>,
Next:<a rel=next href="#Special%20variables">Special variables</a>,
Previous:<a rel=previous href="#Cfagent%20reference">Cfagent reference</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>Cfagent intro</h2>

<ul>
<li><a href="#The%20file%20cfagent.conf">The file cfagent.conf</a>: 
<li><a href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>: 
</ul>

<p><hr>
Node:<a name="The%20file%20cfagent.conf">The file cfagent.conf</a>,
Next:<a rel=next href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>,
Previous:<a rel=previous href="#Cfagent%20intro">Cfagent intro</a>,
Up:<a rel=up href="#Cfagent%20intro">Cfagent intro</a>
<br>

<h3>The file cfagent.conf</h3>

<pre>
 control:

   <var>classes</var>::

       domain = ( <var>DNS-domain-name</var> )

 classes:

   <var>Class/Group definitions</var>

 import:

   <var>Files to import</var>

 # other items

</pre>


<p><hr>
Node:<a name="Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>,
Previous:<a rel=previous href="#The%20file%20cfagent.conf">The file cfagent.conf</a>,
Up:<a rel=up href="#Cfagent%20intro">Cfagent intro</a>
<br>

<h3>Cfagent runtime options</h3>

<p>Note that GNU long options are available with the syntax
<code>--longoption</code>.  The long names are given in brackets.

<dl>

<br><dt><code>-a</code>
<dd>(<code>--sysadm</code>) Print only the name of the system administrator then quit.

<br><dt><code>-A</code>
<dd>(<code>--auto</code>) Can be used to signify an automatic run of cfengine, as opposed
to a manual run. The distinction is not predetermined. Use of this option
currently causes cfengine to ignore locks. This option is reserved for future
development.

<br><dt><code>-b</code>
<dd>(<code>--force-net-copy</code>) Normally cfengine detects attempts to copy
from a server via the network, if they loop back to the localhost. 
It then avoids using the network to make the copy. This option forces
cfengine to copy using the network. (Yes, someone thinks this is useful!)

<br><dt><code>-c</code>
<dd>(<code>--no-check-files</code>) Do not check file systems for ownership / permissions etc.

<br><dt><code>-C</code>
<dd>(<code>--no-check-mounts</code>) Check mount points for consistency.  If this
option is specified then directories which lie in the "mount point"
area are checked to see whether there is anything mounted on them. 
Normally this is <em>off</em> since not all machines use mounted file
systems in the same way.  e.g.  HPUX does not generally operate with
partitions, but nevertheless one might wish to mimick a partition-like
environment there, but it would be irritating to be informed that
nothing was mounted on the mount point.

<br><dt><code>-d</code>
<dd>(<code>--debug</code>) Enable debugging output.  Normally you will want to
send this to a file using the shell script command or a pipe. 
 -d1 shows only parsing output.  -d2 shows only
runtime action output.  -d0 shows both levels. Debugging ouput is
intended mainly for the author's convenience and is not a supported
feature. The details of this output may change at any time.

<br><dt><code>-D</code>
<dd>(<code>--define</code>) Define a compound class symbol of the form
<em>alpha.beta.gamma</em>.

<br><dt><code>-e</code>
<dd>(<code>--no-edits</code>) Suppress file editing.

<br><dt><code>-E</code>
<dd>(<code>--enforce-links</code>) Globally force links to be created where plain
files or links already exist. Since this option
is a big hammer, you have to use it in interactive mode and
answer a yes/no query before cfengine will run like this.

<br><dt><code>-f</code>
<dd>(<code>--file</code>) Parse filename after this switch.  By default cfengine
looks for a file called <em>cfengine.conf</em> in the current directory.

<br><dt><code>-h</code>
<dd>(<code>--help</code>) Help information.  Display version banner and options
summary.

<br><dt><code>-H</code>
<dd>(<code>--no-hard-classes</code>). Prevents cfengine from generating any internal
class name information. Can be used for emulation purposes.

<br><dt><code>-i</code>
<dd>(<code>--no-ifconfig</code>) Do not attempt to configure the local area
network interface.

<br><dt><code>-I</code>
<dd>(<code>--inform</code>) Switches on the inform output level, whereby cfengine
reports everything it changes..

<br><dt><code>-k</code>
<dd>(<code>--no-copy</code>) Do not copy/image any files.

<br><dt><code>-K</code>
<dd>(<code>--no-lock</code>) Ignore locks when running.

<br><dt><code>-l</code>
<dd>(<code>--traverse-links</code>) Normally cfengine does not follow symbolic
links when recursively parsing directories.  This option will force it
to do so.

<br><dt><code>-L</code>
<dd>(<code>--delete-stale-links</code>) Delete links which do not point to
existing files (except in user home directories, which are not touched).

<br><dt><code>-m</code>
<dd>(<code>--no-mount</code>) Do not attempt to mount file systems or edit the
filesystem table.

<br><dt><code>-M</code>
<dd>(<code>--no-modules</code>)
Ignore modules in actionsequence.

<br><dt><code>-n</code>
<dd>(<code>--recon</code>,<code>--dry-run</code>,<code>--just-print</code>) No action.  Only
print what has to be done without actually doing it.

<br><dt><code>-N</code>
<dd>(<code>--negate</code>,<code>--undefine</code>) Cancel a set of classes,
or undefine (set value to <em>false</em>) a compound class of the form
<em>alpha.beta.gamma</em>.

<br><dt><code>-p</code>
<dd>(<code>--parse-only</code>) Parse file and then stop.  Used for checking the
syntax of a program.  You do not have to be superuser to use this
option.

<br><dt><code>-q</code>
<dd>(<code>--no-splay</code>) Switch off host splaying (sleeping).

<br><dt><code>-s</code>
<dd>(<code>--no-commands</code>) Do not execute scripts or shell commands.

<br><dt><code>-S</code>
<dd>(<code>--silent</code>) Silence run time warnings.

<br><dt><code>-t</code>
<dd>(<code>--no-tidy</code>) Do not tidy file systems.

<br><dt><code>-u</code>
<dd>(<code>--use-env</code>) Causes cfengine to generate an environment variable
<code>CFALLCLASSES</code> which can be read by child processes (scripts). This
variable contains a summary of all the currently defined classes at any
given time. This option causes some system 5 systems to generate a Bus
Error or segmentation fault. The same information is available from the
cfengine internal variable <code>$(allclasses)</code> and can be passed as a
parameter to scripts.

<br><dt><code>-U</code>
<dd>(<code>--underscore-classes</code>). When this option is set, cfengine adds
an underscore to the beginning of the hard system classes (like <code>_sun4</code>, <code>_linux</code>
etc. The longer compound classes are not underscored, since these are already
complex and would unlikely result in collisions.) This can be used to avoid naming conflicts if you are so
unjudicious as to name a host by the name of a hard class. Other classes
are not affected.

<br><dt><code>-v</code>
<dd>(<code>--verbose</code>) Verbose mode.  Prints detailed information about
actions and state.

<br><dt><code>-V</code>
<dd>(<code>--version</code>) Print only the version string and then quit.

<br><dt><code>-x</code>
<dd>(<code>--no-preconf</code>) Do not execute the <code>cf.preconf</code> net
configuration file.

<br><dt><code>-X</code>
<dd>(<code>--no-links</code>) Do not execute the <code>links</code> section of a
program.

<br><dt><code>-w</code>
<dd>(<code>--no-warn</code>,<code>--quiet</code>) Do not print warning
messages.

<br><dt><code>-z</code>
<dd>(<code>--smtp</code>) Print the SMTP server for the LAN (used by cfexecd).

</dl>

<p><hr>
Node:<a name="Special%20variables">Special variables</a>,
Next:<a rel=next href="#Cfengine%20classes">Cfengine classes</a>,
Previous:<a rel=previous href="#Cfagent%20intro">Cfagent intro</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>Special variables</h2>

<p>Variables are referred to in either of two different ways, depending on
your taste.  You can use the forms <code>$(variable)</code> or
<code>${variable}</code>.  The variable in braces or parentheses can be the
name of any user defined macro, environment variable or one of the
following special internal variables.

<dl>

<br><dt><code>AllClasses</code>
<dd>A long string in the form <code>CFALLCLASSES=class1:class2...</code>.  This
variable is a summary of all the defined classes at any given time. It
is always kept up to date so that scripts can make use of cfengine's
class data.

<br><dt><code>arch</code>
<dd>The current detailed architecture string--an amalgamation of the
information from <em>uname</em>. Non-definable.

<br><dt><code>binserver</code>
<dd>The default server for binary data. 
Non definable.

<br><dt><code>ChecksumDatabase</code>
<dd>If set to the name of a file, cfagent will use this to store checksums of important
files, and give `tripwire functionality', See <a href="#ChecksumDatabase">ChecksumDatabase</a>.

<br><dt><code>ChecksumUpdates</code>
<dd>If set to `on', security information is automatically updated, See <a href="#ChecksumUpdates">ChecksumUpdates</a>.

<br><dt><code>class</code>
<dd>The currently defined system hard-class (e.g. <code>sun4</code>, <code>hpux</code>). 
Non-definable.

<br><dt><code>date</code>
<dd>The current date string. Note that if you use this in a shell command it might
be interpreted as a list variable, since it contains the default separator
<code>:</code>.

<br><dt><code>domain</code>
<dd>The currently defined domain.

<br><dt><code>faculty</code>
<dd>The faculty or site as defined in control (see site).

<br><dt><code>fqhost</code>
<dd>The fully qualified (DNS/BIND) hostname of the system, which
includes the domain name as well.

<br><dt><code>host</code>
<dd>The hostname of the machine running the program.

<br><dt><code>ipaddress</code>
<dd>The numerical form of the internet address of the host currently running
cfengine.

<br><dt><code>MaxCfengines</code>
<dd>The maximum number of cfengines which should be allowed to
co-exist concurrently on the system. This can prevent excessive
load due to unintentional spamming in situations where several
cfengines are started independently. The default value is unlimited.

<br><dt><code>ostype</code>
<dd>A short for of <code>$(arch)</code>.

<br><dt><code>OutputPrefix</code>
<dd>This quoted string can be used to change the default `cfengine:'
prefix on output lines to something else. You might wish to shorten
the string, or have a different prefix for different hosts. The value
in this variable is appended with the name of the host. The default is
equivalent to,
<pre>  OutputPrefix = ( "cfengine:$(host):")
</pre>

<br><dt><code>RepChar</code>
<dd>The character value of the string used by the file repository in
constructing unique filenames from path names. This is the character which
replaces <code>/</code> (see the reference manual).

<br><dt><code>site</code>
<dd>This variable is identical to <code>$(faculty)</code> and may be used interchangeably.

<br><dt><code>split</code>
<dd>The character on which list variables are split (see the reference manual).

<br><dt><code>sysadm</code>
<dd>The name or mail address of the system administrator.

<br><dt><code>timezone</code>
<dd>The current timezone as defined in <code>control</code>.

<br><dt><code>UnderscoreClasses</code>
<dd>If this is set to `on' cfengine uses hard-classes which begin with
an underscore, so as to avoid name collisions. See also Runtime Options in the
Reference manual.

<br><dt><code>year</code>
<dd>The current year. 
</dl>

<p>These variables are kept special because they play a special role in
setting up a system configuration. 
You are encouraged to use them to define fully
generalized rules in your programs.  Variables can be used to advantage
in defining filenames, directory names and in passing arguments to shell
commands.  The judicious use of variables can reduce many definitions to
a single one if you plan carefully.

<p><em>NOTE: the above control variables are not case sensitive, unlike
user macros, so you should not define your own macros with these names.</em>


<p>The following variables are also reserved and may be used to produce
troublesome special characters in strings.
<dl>

<br><dt><code>cr</code>
<dd>Expands to the carriage-return character.

<br><dt><code>dblquote</code>
<dd>Expands to a double quote <code>"</code>

<br><dt><code>dollar</code>
<dd>Expands to <code>$</code>.

<br><dt><code>lf</code>
<dd>Expands to a line-feed character (Unix end of line).

<br><dt><code>n</code>
<dd>Expands to a newline character.

<br><dt><code>quote</code>
<dd>Expands to a single quote <code>'</code>.

<br><dt><code>spc</code>
<dd>Expands simply to a single space. This can be used to place spaces in
filenames etc.

<br><dt><code>tab</code>
<dd>Expands to a single tab character.

</dl>

<p><hr>
Node:<a name="Cfengine%20classes">Cfengine classes</a>,
Next:<a rel=next href="#acl">acl</a>,
Previous:<a rel=previous href="#Special%20variables">Special variables</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>Cfengine classes</h2>

<p>A <em>cfengine action</em> looks like this:

<pre>
<var>action-type</var>:

   <var>compound-class</var>::

       <var>declaration</var>
</pre>

<p>A single class can be one of several things:

<ul>

<li>The name of an operating system architecture e.g.  <code>ultrix</code>, <code>sun4</code> etc. 
This is referred to henceforth as a <em>hard class</em>.

<li>The (unqualified) name of a particular host. If your system returns a fully
qualified domain name for your host, cfagent truncates it so as to unqualify
the name.

<li>The name of a user-defined group of hosts.

<li>A day of the week (in the form <code>Monday Tuesday Wednesday..</code>).

<li>An hour of the day (in the form <code>Hr00, Hr01 ... Hr23</code>).

<li>Minutes in the hour (in the form <code>Min00, Min17 ... Min45</code>).

<li>A five minute interval in the hour (in the form <code>Min00_05, Min05_10 ... Min55_00</code>)

<li>A quart hour (in the form <code>Q1, Q2, Q3, Q4</code>)

<li>An abbreviated time with quarter hour specified (in the form <code>Hr00_Q1, Hr23_Q4</code> etc.)

<li>A day of the month (in the form <code>Day1 ... Day31</code>).

<li>A month (in the form <code>January, February, ... December</code>).

<li>A year (in the form <code>Yr1997, Yr2001</code>).

<li>An arbitrary user-defined string.  (see the reference manual).

<li>The ip-address octets of any active interface, in the form (<code>ipv4_192_0_0_1</code>,
<code>ipv4_192_0_0</code>,<code>ipv4_192_0</code>,<code>ipv4_192</code>).

</ul>

<p>A compound class is a sequence of simple classes connected by dots or
`pipe' symbols (vertical bars).  For example:

<pre>
myclass.sun4.Monday::

sun4|ultrix|osf::

</pre>

<p>A compound class evaluates to `true' if all of the individual classes
are separately true, thus in the above example the actions which follow
<code>compound_class::</code> are only carried out if the host concerned is in
<code>myclass</code>, is of type <code>sun4</code> and the day is Monday! 
In the second example, the host parsing the file must be either of
type <code>sun4</code> <em>or</em> <code>ultrix</code> <em>or</em> <code>osf</code>. 
In other words, compound classes support two operators: AND and OR,
written <code>.</code> and <code>|</code> respectively. Cfengine doesn't
care how many of these operators you use (since it skips over blank
class names), so you could write either

<pre>
solaris|irix::

</pre>

<p>or

<pre>
solaris||irix::

</pre>

<p>depending on your taste. On the other hand, the order in which cfengine
evaluates AND and OR operations <em>does</em> matter, and the rule
is that AND takes priority over OR, so that <code>.</code> binds classes
together tightly and all AND operations are evaluated before ORing
the final results together. This is the usual behaviour in programming
languages. You can use round parentheses in cfengine classes to
override these preferences.

<p>Cfengine allows you to define switch on and off dummy classes so that
you can use them to select certain subsets of action.  In particular,
note that by defining your own classes, using them to make compound
rules of this type, and then switching them on and off, you can also
switch on and off the corresponding actions in a controlled way.  The
command line options <code>-D</code> and <code>-N</code> can be used for this
purpose.  See also <code>addclasses</code> in the Reference manual.

<p>A logical NOT operator has been added to allow you to exclude
certain specific hosts in a more flexible way. The logical NOT
operator is (as in C and C++) <code>!</code>. For instance, the
following example would allow all hosts except for <code>myhost</code>:

<pre>   <var>action</var>:

    !myhost::

        <var>command</var>
</pre>

<p>and similarly, so allow all hosts in a user-defined group <code>mygroup</code>,
<em>except</em> for <code>myhost</code>, you would write

<pre>   <var>action</var>:

    mygroup.!myhost::

        <var>command</var>
</pre>

<p>which reads `mygroup AND NOT myhost'. The NOT operator can also be
combined with OR. For instance

<pre>
   <var>class1</var>|!<var>class2</var>
</pre>

<p>would select hosts which were either in class 1, or those
which were not in class 2.

<p>Finally, there is a number of reserved classes.  The following are hard
classes for various operating system architectures.  They do not need to
be defined because each host knows what operating system it is running. 
Thus the appropriate one of these will always be defined on each host. 
Similarly the day of the week is clearly not open to definition, unless
you are running cfengine from outer space.  The reserved classes are:

<pre>ultrix, sun4, sun3, hpux, hpux10, aix, solaris, osf, irix4, irix, irix64
   sco, freebsd, netbsd, openbsd, bsd4_3, newsos, solarisx86, aos,
          nextstep, bsdos, linux, debian, cray, unix_sv, GnU, NT
</pre>

<p>If these classes are not sufficient to distinguish the hosts on
your network, cfengine provides more specific classes which
contain the name and release of the operating system. To find out
what these look like for your systems you can run cfengine in
`parse-only-verbose' mode:

<pre>
  cfagent -p -v

</pre>

<p>and these will be displayed. For example, solaris 2.4 systems
generate the additional classes <code>sunos_5_4</code> and <code>sunos_sun4m</code>,
<code>sunos_sun4m_5_4</code>.

<p>Cfengine uses both the unqualified and fully host names as classes. Some
sites and operating systems use fully qualified names for their
hosts. i.e. <code>uname -n</code> returns to full domain qualified
hostname. This spoils the class matching algorithms for cfengine, so
cfengine automatically truncates names which contain a dot `.'  at the
first `.' it encounters. If your hostnames contain dots (which do not
refer to a domain name, then cfengine will be confused. The moral is:
don't have dots in your host names! <em>NOTE: in order to ensure that
the fully qualified name of the host becomes a class you must define the
domain variable.</em> The dots in this string will be replaced by underscores.

<p>In summary, the operator ordering in cfengine classes is as follows:

<dl>

<br><dt><code>()</code>
<dd>Parentheses override everything.

<br><dt><code>!</code>
<dd>The NOT operator binds tightest.

<br><dt><code>.</code>
<dd>The AND operator binds more tightly than OR.

<br><dt><code>|</code>
<dd>OR is the weakest operator.

</dl>

<p><hr>
Node:<a name="acl">acl</a>,
Next:<a rel=next href="#binservers">binservers</a>,
Previous:<a rel=previous href="#Cfengine%20classes">Cfengine classes</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>acl</h2>

<pre>
   acl:

      <var>class</var>::

         { <var>acl-alias</var>

         <var>action</var>
         }

</pre>

<p>Cfengine's <code>ACL</code> feature is a common interface for managing
filesystem access control lists (ACLs). An access control list is an
extended file permission. It allows you to open or close a file to a
named list of users (without having to create a group for those users);
similarly, it allows you to open or close a file for a list of groups. 
Several operating systems have access control lists, but each typically
has a different syntax and different user interface to this facility,
making it very awkward to use.  This part of a cfengine configuration
simplifies the management of ACLs by providing a more convenient user
interface for controlling them and--as far as possible--a common
syntax.

<p>An ACL may, by its very nature, contain a lot of information. Normally
you would set ACLs in a <code>files</code> command, See <a href="#files">files</a>, or a
<code>copy</code> command, See <a href="#copy">copy</a>. It would be too cumbersome to repeat
all of the information in every command in your configuration, so
cfengine simplifies this by first associating an alias together with a
complex list of ACL information. This alias is then used to represent
the whole bundle of ACL entries in a <code>files</code> or <code>copy</code>
command.  The form of an ACL is similar to the form of an
<code>editfiles</code> command.  It is a bundle of information concerning a
file's permissions.

<pre>
 { <var>acl-alias</var>

  method:<b>overwrite</b><var>/append</var>
  fstype:<var>posix/solaris/dfs/afs/hpux/nt</var>

  <var>acl_type</var>:<var>user/group</var>:<var>permissions</var>
  <var>acl_type</var>:<var>user/group</var>:<var>permissions</var>
  ...
 }

</pre>

<p>The name <var>acl-alias</var> can be any identifier containing alphanumeric
characters and underscores. This is what you will use to refer to the
ACL entries in practice. The method entry tells cfengine how to
interpret the entries: should a file's ACLs be overwritten or only
adjusted?  Since the filesystems from different developers all use
different models for ACLs, you must also tell cfengine what kind of
filesystem the file resides on. Currently only solaris and DCE/DFS ACLs
are implemented.

<p>NOTE: if you set both file permissions and ACLs the file permissions
override the ACLs.

<ul>
<li><a href="#ACEs">ACEs</a>: 
<li><a href="#Solaris%20ACLs">Solaris ACLs</a>: 
<li><a href="#DFS%20ACLs">DFS ACLs</a>: 
<li><a href="#NT%20ACLs">NT ACLs</a>: 
<li><a href="#ACL%20Example">ACL Example</a>: 
</ul>

<p><hr>
Node:<a name="ACEs">ACEs</a>,
Next:<a rel=next href="#Solaris%20ACLs">Solaris ACLs</a>,
Previous:<a rel=previous href="#acl">acl</a>,
Up:<a rel=up href="#acl">acl</a>
<br>

<h3>Access control entries</h3>

<p>An access control list is build of any number of individual access
control entries (ACEs). The ACEs has the following general syntax:

<pre>    <var>acl_type</var>:<var>user/group</var>:<var>permissions</var>
</pre>

<p>The user or group is sometimes referred to as a <em>key</em>.

<p>For an explanation of ACL types and their use, refer to your local
manual page.  However, note that for each type of filesystem, there are
certain entries which must exist in an ACL. If you are creating a new
ACL from scratch, you must specify these.  For example, in solaris ACLs
you must have entries for <code>user</code>, <code>group</code> and <code>other</code>. 
Under DFS you need what DFS calls a <code>user_obj</code>, <code>group_obj</code>
and an <code>other_obj</code>, and in some cases <code>mask_obj</code>. In cfengine
syntax these are called <code>user:*:</code>, <code>other:*:</code> and
<code>mask:*:</code>, as described below.  If you are appending to an existing
entry, you do not have to re-specify these unless you want to change
them.

<p>Cfengine can overwrite (replace) or append to one or more ACL
entries.

<dl>

<br><dt><code>overwrite</code>
<dd><code>method:overwrite</code> is the default. This sets the ACL according to
the specified entries which follow.  The existing ACL will be
overwritten completely.

<br><dt><code>append</code>
<dd><code>method:append</code> adds or modifies one or more specified ACL entries. 
If an entry already exists for the specified type and user/group, the
specified permission bits will be added to the old permissions. If there
is no ACL entry for the given type and user/group, a new entry will be
appended.

</dl>

<p>If the new ACL exactly matches the existing ACL, the ACL is not
replaced.

<p>The individual bits in an ACE may be either added subtracted or
set equal to a specified mask. The <code>+</code> symbol means add,
the <code>-</code> symbol subtract and <code>=</code> means set equal to. 
Here are some examples:
<pre>
  <var>acltype</var>:<var>id/*</var>:<var>mask</var>

  user:mark:+rx,-w
  user:ds:=r
  user:jacobs:noaccess
  user:forgiven:default

  user:*:rw
  group:*:r
  other:*:r

</pre>

<p>The keyword <code>noaccess</code> means set all access bits to zero for that
user, i.e. remove all permissions. The keyword <code>default</code> means
remove the named user from the access crontrol list altogether, so that
the default permissions apply. A star/asterisk in the centre field
indicates that the user or group ID is implicitly specified as of the
owner of the file, or that no ID is applicable at all (as is the case for `other').

<p><hr>
Node:<a name="Solaris%20ACLs">Solaris ACLs</a>,
Next:<a rel=next href="#DFS%20ACLs">DFS ACLs</a>,
Previous:<a rel=previous href="#ACEs">ACEs</a>,
Up:<a rel=up href="#acl">acl</a>
<br>

<h3>Solaris ACLs</h3>

<p>Under Solaris, the ACL type can be one of the following:

<pre>        user
        group
        mask
        other
        default_user
        default_group
        default_mask
        default_other
</pre>

<p>A user or group can be specified to the user, group, default_user and
default_group types. 
Solaris ACL permissions are the normal UNIX permissions bits <code>rwx</code>,
where:

<pre>    <var>
        <b>r</b> - Grants read privileges.
        <b>w</b> - Grants write privileges.
        <b>x</b> - Grants execute privileges.</var>
</pre>

<p><hr>
Node:<a name="DFS%20ACLs">DFS ACLs</a>,
Next:<a rel=next href="#NT%20ACLs">NT ACLs</a>,
Previous:<a rel=previous href="#Solaris%20ACLs">Solaris ACLs</a>,
Up:<a rel=up href="#acl">acl</a>
<br>

<h3>DFS ACLs</h3>

<p>In DCE, the ACL type can be one of the following:

<pre>        other
        mask
        any
        unauthenticated
        user
        group
        foreign_other
        foreign_user
        foreign_group
</pre>

<p>The <code>user</code>, <code>group</code>, <code>foreign_user</code> and <code>foreign_group</code>
 types require that you specify a user or group. The DCE documentation
refers to types <code>user_obj</code>, <code>group_obj</code> and so on. In the
cfengine implementation, the ugly <code>_obj</code> suffix has been dropped to
make these more in keeping with the POSIX names. <code>user_obj::</code>, is
equivalent to <code>user:*:</code> is cfengine. The star/asterisk implies that
the ACL applies to the owner of the file object.

<p>DFS permissions are comprised of the bits
<code>crwxid</code>, where:
<pre>        <b>c</b> - Grants control privileges, to modify an acl.
        <b>r</b> - Grants read  privileges.
        <b>w</b> - Grants write privileges.
        <b>x</b> - Grants execute privileges.
        <b>i</b> - Grants insert privileges.
        <b>d</b> - Grants delete privileges.
</pre>

<p>See the DCE/DFS documentation for more information about this.

<p>It is not possible to set ACLs in foreign cells currently using
cfengine, but you can still have all of your ACL definitions in the same
file. You must however arrange for the file to be executed on the server
for the cell concerned.  Note also that you must perform a DCE login
(normally as user <code>cell_admin</code>) in order to set ACLs on files
which are not owned by the owner of the cfengine-process.  This is
because you must have a valid security ticket.

<p><hr>
Node:<a name="NT%20ACLs">NT ACLs</a>,
Next:<a rel=next href="#ACL%20Example">ACL Example</a>,
Previous:<a rel=previous href="#DFS%20ACLs">DFS ACLs</a>,
Up:<a rel=up href="#acl">acl</a>
<br>

<h3>NT ACLs</h3>

<p>NT ACEs are written as follows:
<pre>       acl_type:user/group:permissions:accesstype
</pre>

<p>The actual change consists of the extra field containing the access
type. A star/asterisk in the field for <var>user/group</var> would
normally imply that the ACL applies to the owner of the file
object. However this functionality is as of today not yet implemented.

<p>In NT, the ACL type can be one of the following:
<pre>           user
           group
</pre>
Both types require that you specify the name of a user or a group.

<p>NT permissions are comprised of the bits <code>rwxdpo</code>, where:
<pre>    r - Read privileges
    w - Write privileges
    x - Execute privileges
    d - Delete privileges
    p - Privileges to change the permissions on the file
    o - Privileges to take ownership of the file
</pre>
In addition to any combination of these bits, the word <code>noaccess</code>
or <code>default</code> can be used as explained in the previous section. NT
comes with some standard, predefined permissions. The standards are only
a predefined combination of the different bits specified above and are
provided with cfengine as well. You can use the standards by setting the
permission to <code>read</code>, <code>change</code> or <code>all</code>. The bit
implementation of each standard is as on NT:
<pre>           read   - rx
           change - rwxd
           all    - rwxdpo
</pre>
where the bits follow the earlier definition. The keywords mentioned
above can only be used alone, and not in combination with <code>+</code>,
<code>-</code>, <code>=</code> and/or other permission bits.

<p>NT defines several different access types, of which only two are used in
connection with the ACL type that is implemented in cfengine for NT. The
access type can be one of the following:
<pre>           allowed
           denied
</pre>
Intuitively, <code>allowed</code> access grants the specified permissions to
the user, whilst <code>denied</code> denies the user the specified
permissions. If no access type is specified, the default is
<code>allowed</code>. This enables cfengine's behaviour as on UNIX systems
without any changes to the configuration file. If the permissions
<code>noaccess</code> or <code>default</code> is used, the access type will be
irrelevant.

<h2>ACL Example</h2>

<p>Here is an example of a configuration file for an NT ACL:

<pre>control:
        actionsequence = ( files )
        domain = ( iu.hioslo.no )

files:
        $(HOME)/tt    acl=acl_alias1    action=fixall

acl:
        { acl_alias1

        method:overwrite
        fstype:nt

        user:gustafb:rwx:allowed
        user:mark:all:allowed
        user:toreo:read:allowed
        user:torej:default:allowed
        user:ds2:+rwx:allowed

        group:dummy:all:denied
        group:iu:read:allowed
        group:root:all:allowed
        group:guest:dpo:denied
        }
</pre>

<p><hr>
Node:<a name="ACL%20Example">ACL Example</a>,
Previous:<a rel=previous href="#NT%20ACLs">NT ACLs</a>,
Up:<a rel=up href="#acl">acl</a>
<br>

<h3>ACL Example</h3>

<p>Here is an example of a configuration file for one Solaris ACL and one DCE/DFS ACL:

<pre>control:
        actionsequence = ( files )
        domain = ( iu.hioslo.no )

files:
        $(HOME)/tt    acl=acl_alias1    action=fixall
        /:/bigfile    acl=acl_alias2    action=fixall

acl:
        { acl_alias1

        method:overwrite
        fstype:posix

        user:*:rwx
        user:mark:=rwx
        user:sowille:=rx
        user:toreo:=rx
        user:torej:default
        user:ds2:+rwx
        group:*:rx
        group:iu:r
        group:root:x
        mask:*:rx
        other:*:rx

        default_user:*:=rw
        default_user:mark:+rwx
        default_user:ds:=rwx
        default_group::=r
        default_group:iu:+r
        default_mask::w
        default_other::rwx
        }

        { acl_alias2

        method:overwrite
        fstype:dfs

        user:*:rwxcid
        group:*:rxd
        other:*:wxir
        mask:*:rxw
        user:/.../iu.hioslo.no/cell_admin:rc
        group:/.../iu.hioslo.no/acct-admin:rwxcid
        user:/.../iu.hioslo.no/root:rx
        }
</pre>

<p><hr>
Node:<a name="binservers">binservers</a>,
Next:<a rel=next href="#broadcast">broadcast</a>,
Previous:<a rel=previous href="#acl">acl</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>binservers</h2>

<p>The <code>binservers</code> declaration need only be used if you are using
cfengine's model for mounting NFS filesystems.  This declaration informs
hosts of which other hosts on the network possess filesystems containing
software (binary files) which client hosts should mount.  This includes
resources like programs in <code>/usr/local</code> and so on.  A host may have
several binary servers, since there may be several machines to which
disks are physically attached.  In most cases, on a well organized
network, there will be only one <em>architecture server</em> per UNIX
platform type, for instance a SunOS server, an ULTRIX server and so on.

<p>Binary servers are defined as follows:

<pre>
binservers:

   physics.sun4::   sunserver sunserver2
   physics.linux::  linuxserver

</pre>

<p>The meaning of this declaration is the following.  All hosts of type
<code>sun4</code> which are members of the group <code>physics</code> should mount
any binaries declared in the <code>mountables</code> resource list which
belong to hosts <code>sunserver</code> or <code>sunserver2</code>.  Similarly all
<code>linux</code> machines should mount binary filesystems in the mountables
list from <code>linuxserver</code>.

<p>Cfengine knows the difference between binaries and home directories in
the <code>mountables</code> list, because home directories match the pattern
given by <code>homepattern</code>.  See <a href="#homepattern">homepattern</a>.  See <a href="#homeservers">homeservers</a>.

<p>Note that every host is a binary server for itself, so that the first
binary server (and that with highest priority) is always the current
host.  This ensures that local filesystems are always used in preference
to NFS mounted filesystems.  This is only relevant in connection with
the variable <code>$(binserver)</code>.

<p><hr>
Node:<a name="broadcast">broadcast</a>,
Next:<a rel=next href="#control">control</a>,
Previous:<a rel=previous href="#binservers">binservers</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>broadcast</h2>

<p>This information is used to configure the network interface for each host.

<p>Every local area network has a convention for determining which internet
address is used for broadcast requests.  Normally this is an address of
the form <code>aaa.bbb.ccc.255</code> or <code>aaa.bbb.ccc.0</code>.  The difference
between these two forms is whether all of the bits in the last number
are ones or zeroes respectively.  You must find out which convention is
used at your establishment and tell cfengine using a declaration of the
form:

<pre>broadcast:

  any::

     ones     # or zeros, or zeroes

</pre>

<p>In most cases you can use the generic class <code>any</code>, since all of the
hosts on the same subnet have to use the same convention.  If your
configuration file encompasses several different subnets with different
conventions then you will need to use a more specific.

<p>Cfengine computes the actual value of the broadcast address using the
value specified above and the netmask See <a href="#netmask">netmask</a>.

<p><hr>
Node:<a name="control">control</a>,
Next:<a rel=next href="#classes">classes</a>,
Previous:<a rel=previous href="#broadcast">broadcast</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>control</h2>

<p>The fundamental piece of any cfengine script or configuration file is
the control section.  If you omit this part of a cfengine script, it
will not do anything! The control section is used to define certain
variables, set default values and define the order in which the various
actions you have defined will be carried out.  Because cfengine is a
declarative or descriptive language, the order in which actions appear
in the file does not necessarily reflect the order in which they are
executed. The syntax of declarations here is:

<pre>  control:

     <var>classes</var>::

        <var>variable</var> = ( <var>list or value</var> )

</pre>

<p>The control section is a sequence of declarations which looks something
like the following example:

<pre>
control:

  site     = ( univ )
  domain   = ( univ.edu )
  sysadm   = ( admin@computing.univ.edu )
  netmask  = ( 255.255.252.0 )
  timezone = ( EDT )
  nfstype  = ( nfs )

  childlibpath = ( /usr/local:/mylibs )

  sensiblesize  = ( 1000 )
  sensiblecount = ( 2 )
  editfilesize  = ( 4000 )

  actionsequence =
     (
     links.some
     mountall
     links.others
     files
     )

  myvariable = ( something )
  mymacro    = ( somethingelse )

</pre>

<p>Parentheses are required when making a declaring information in cfengine.

<p>The meaning of each of these lines is described below.

<ul>
<li><a href="#access">access</a>: 
<li><a href="#actionsequence">actionsequence</a>: 
<li><a href="#addclasses">addclasses</a>: 
<li><a href="#addinstallable">addinstallable</a>: 
<li><a href="#BinaryPaddingChar">BinaryPaddingChar</a>: 
<li><a href="#ChecksumDatabase">ChecksumDatabase</a>: 
<li><a href="#ChecksumUpdates">ChecksumUpdates</a>: 
<li><a href="#childlibpath">childlibpath</a>: 
<li><a href="#copylinks">copylinks</a>: 
<li><a href="#defaultcopytype">defaultcopytype</a>: 
<li><a href="#deletenonuserfiles">deletenonuserfiles</a>: 
<li><a href="#deletenonownerfiles">deletenonownerfiles</a>: 
<li><a href="#deletenonusermail">deletenonusermail</a>: 
<li><a href="#deletenonownermail">deletenonownermail</a>: 
<li><a href="#domain">domain</a>: 
<li><a href="#dryrun">dryrun</a>: 
<li><a href="#editbinaryfilesize">editbinaryfilesize</a>: 
<li><a href="#editfilesize">editfilesize</a>: 
<li><a href="#emptyresolvconf">emptyresolvconf</a>: 
<li><a href="#exclamation">exclamation</a>: 
<li><a href="#excludecopy">excludecopy</a>: 
<li><a href="#excludelinks">excludelinks</a>: 
<li><a href="#ExpireAfter">ExpireAfter</a>: 
<li><a href="#homepattern">homepattern</a>: 
<li><a href="#IfElapsed">IfElapsed</a>: 
<li><a href="#Inform">Inform</a>: 
<li><a href="#interfacename">interfacename</a>: 
<li><a href="#fileextension">fileextension</a>: 
<li><a href="#linkcopies">linkcopies</a>: 
<li><a href="#LogDirectory">LogDirectory</a>: 
<li><a href="#LogTidyHomeFiles">LogTidyHomeFiles</a>: 
<li><a href="#moduledirectory">moduledirectory</a>: 
<li><a href="#mountpattern">mountpattern</a>: 
<li><a href="#netmask">netmask</a>: 
<li><a href="#nonalphanumfiles">nonalphanumfiles</a>: 
<li><a href="#nfstype">nfstype</a>: 
<li><a href="#repchar">repchar</a>: 
<li><a href="#repository">repository</a>: 
<li><a href="#schedule">schedule</a>: 
<li><a href="#secureinput">secureinput</a>: 
<li><a href="#sensiblecount">sensiblecount</a>: 
<li><a href="#sensiblesize">sensiblesize</a>: 
<li><a href="#showactions">showactions</a>: 
<li><a href="#site">site</a>: 
<li><a href="#SplayTime">SplayTime</a>: 
<li><a href="#split">split</a>: 
<li><a href="#spooldirectories">spooldirectories</a>: 
<li><a href="#suspiciousnames">suspiciousnames</a>: 
<li><a href="#sysadm">sysadm</a>: 
<li><a href="#Syslog">Syslog</a>: 
<li><a href="#timezone">timezone</a>: 
<li><a href="#TimeOut">TimeOut</a>: 
<li><a href="#Verbose">Verbose</a>: 
<li><a href="#Warnings">Warnings</a>: 
<li><a href="#warnnonuserfiles">warnnonuserfiles</a>: 
<li><a href="#warnnonownerfiles">warnnonownerfiles</a>: 
<li><a href="#warnnonusermail">warnnonusermail</a>: 
<li><a href="#warnnonownermail">warnnonownermail</a>: 
</ul>

<p><hr>
Node:<a name="access">access</a>,
Next:<a rel=next href="#actionsequence">actionsequence</a>,
Previous:<a rel=previous href="#control">control</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>access</h3>

<p>The <code>access</code> list is a list of users who are to be allowed to
execute a cfengine program.  If the list does not exist then all users
are allowed to run a program.

<pre>   access = ( <var>user1</var> <var>user2</var> ...  )
</pre>

<p>The list may consist of either numerical user identifiers or valid
usernames from the password database.  For example:

<pre>   access = ( mark aurora 22 456 )
</pre>

<p>would restrict a script to users mark, aurora and user id
22 and 456.

<p><hr>
Node:<a name="actionsequence">actionsequence</a>,
Next:<a rel=next href="#addclasses">addclasses</a>,
Previous:<a rel=previous href="#access">access</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>actionsequence</h3>

<p>The action sequence determines the order in which collective actions are
carried out.  Here is an example containing the full list of
possibilities:

<pre>   actionsequence =
      (
      mountall               # mount filesystems in fstab
      mountinfo              # scan mounted filesystems
      checktimezone          # check timezone
      netconfig              # check net interface config
      resolve                # check resolver setup
      unmount                # unmount any filesystems
      shellcommands          # execute shell commands
      editfiles              # edit files
      addmounts              # add new filesystems to system
      directories            # make any directories
      links                  # check and maintain links (single and child)
      mailcheck              # check mailserver
      mountall               # (again)
      required               # check required filesystems
      tidy                   # tidy files
      disable                # disable files
      files                  # check file permissions
      copy                   # make a copy/image of a master file
      processes              # signal / check processes
      module:name            # execute a user-defined module
      )

</pre>

<p>Here is a more complete description of the meaning of these
keywords.

<dl>

<br><dt><code>addmounts</code>
<dd>causes cfengine to compute which NFS filesystems are missing from the
current host and add them. This includes editing the filesystem table,
creating the mount-directory, if required.  This command relies on
information provided by <code>mountinfo</code>, so it should normally only be
called after <code>mountinfo</code>. If the filesystem already appears
to be in the filesystem table, a warning is issued.

<br><dt><code>checktimezone</code>
<dd>runs a check on the timezone defined for the shell running
cfengine.

<br><dt><code>directories</code>
<dd>executes all the commands defined under the <code>directories</code>
section of the program. It builds new directories.

<br><dt><code>disable</code>
<dd>executes all the commands defined under the <code>disable</code>
section of the program.

<br><dt><code>editfiles</code>
<dd>executes all the commands defined under the <code>editfiles</code>
section of the program.

<br><dt><code>files</code>
<dd>executes all the commands defined under the <code>files</code>
section of the program.

<br><dt><code>links</code>
<dd>executes all the commands defined under the <code>links</code>
section of the program.

<br><dt><code>mailcheck</code>
<dd>tests for the presence of the NFS-mounted mail spooling directory on the
current host. The name of the mail spool directory is defined in the
<code>mailserver</code> section of the cfengine program. If the current host
is the same as the mailserver (the host which has the physical spool
directory disk) nothing is done. Otherwise the filesystem table is
edited so as to include the mail directory.

<br><dt><code>module</code>
<dd>Normally cfengine's ability to detect the systems condition is limited
to what it is able to determine while excuting predefined
actions. Classes may be switched on as a result of actions cfengine
takes to correct a problem. To increase the flexibility of cfengine, a
mechanism has been introduced in version 1.5 which allows you to include
a module of your own making in order to define or undefine a number of classes. 
The syntax
<pre>  module:mytests.<var>class1</var>.<var>class2</var>.<var>class3</var>

  "module:mytests.<var>class1</var>.<var>class2</var>.<var>class3</var> arg1 arg2 .."
</pre>
declares a user defined module which can potentially set the classes
<var>class1</var> etc. Classes returned by the module must be declared so
that cfengine knows to pay attention to rules which use these classes
when parsing. Note might actually be preferable to define classes
returned by modules under <code>AddInstallables</code> which is equivalent. If
arguments are passed to the module, the whole string must be quoted like
a shellcommand.  See <a href="cfengine-Tutorial.html#Writing%20plugin%20modules">Writing plugin modules</a>.  Whether or not these
classes become set or not depends on the behaviour of your module. The
classes continue to apply for all actions which occur after the module's
execution. The module must be owned by the user executing cfengine or
root (for security reasons), it must be named
<code>module:<var>module-name</var></code> and must lie in a special directory,
See <a href="#moduledirectory">moduledirectory</a>.

<br><dt><code>mountall</code>
<dd>mounts all filesystems defined in the hosts filesystem table.  This
causes new NFS filesystems added by <code>addmounts</code> and
<code>mailcheck</code> to be actually mounted. This should probably be called
both before <code>mountinfo</code> and after <code>addmounts</code> etc.  A short
timeout is placed on this operation to avoid hanging RPC connections
when parsing NFS mounted file systems.

<br><dt><code>mountinfo</code>
<dd>builds internal information about which filesystems are presently
mounted on the current host.  Cfengine assumes that required-filesystems
which are not found need to be mounted. A short timeout is
placed on this operation to avoid hanging RPC connections
when parsing NFS mounted file systems. If this times out,
no further mount operations are considered reliable and are
summarily cancelled.

<br><dt><code>netconfig</code>
<dd>checks the netmask, hostname, IP address and broadcast address for the
current host. The correct values for the netmask and broadcast address
are set if there is an error. The defaultroute is matched against the
static routing table and added if no default route exists. This does not
apply to DHCP clients, which set a default route automatically.

<br><dt><code>required</code>
<dd>executes all the commands defined under the <code>required</code>
section of the program. It checks for the absence of
important NFS resources.

<br><dt><code>resolve</code>
<dd>checks and corrects the DNS domain name and the order
of nameservers in the file <code>/etc/resolv.conf</code>.

<br><dt><code>shellcommands</code>
<dd>executes all the commands defined under the <code>shellcommands</code>
section of the program.

<br><dt><code>tidy</code>
<dd>executes all the commands defined under the <code>tidy</code>
section of the program.

<br><dt><code>unmount</code>
<dd>executes all the commands defined under the <code>unmount</code>
section of the program. The filesystem table is edited
so as to remove the unwanted filesystems and the unmount
operation is executed.

<br><dt><code>processes</code>
<dd>executes commands defined under the <code>processes</code> section
of the program.

</dl>

<p>Under normal circumstances this coarse ordering is enough to suit most
purposes.  In some cases you might want to, say, only perform half the
link operations before mounting filesystems and then, say, perform the
remainder.  You can do this (and similar things) by using the idea of
defining and undefining classes. See <a href="cfengine-Tutorial.html#Defining%20classes">Defining classes</a>.

<p>The syntax

<pre>
actionsequence =
   (
   links.firstpass.include
   ...
   links.secondpass
   )
</pre>

<p>means that cfengine first executes <code>links</code> with the classes
<code>firstpass</code> and <code>include</code> <em>defined</em>.  Later it executes
<code>links</code> with <code>secondpass</code> defined.  You can use this method of
adding classes to distinguish more finely the flow of control in
programs.

<p>A note about style: if you define and undefine lots of classes to do
what you want to do, you might stop and ask yourself if your
<code>groups</code> are defined as well as they should be.  See <a href="#groups">groups</a>. 
Programming in cfengine is about doing a lot for only a little
writing.  If you find yourself writing a lot, you are probably not going
about things in the right way.

<p><hr>
Node:<a name="addclasses">addclasses</a>,
Next:<a rel=next href="#addinstallable">addinstallable</a>,
Previous:<a rel=previous href="#actionsequence">actionsequence</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>AddClasses</h3>

<pre>   AddClasses  = ( <var>list of identifiers</var> )
</pre>

<p>The <code>AddClasses</code> directive is used to define a list of class
attributes for the current host.  Normally only the hard classes defined
by the system are `true' for a given host.  It is convenient though to
be able to define classes of your own to label certain actions, mainly
so that they can later be excluded so as to cut short or filter out
certain actions.  This can be done in two ways.  See <a href="#actionsequence">actionsequence</a>.

<p>To define a list of classes for the current session, you write:

<pre>AddClasses = ( exclude shortversion )
</pre>

<p>This is equivalent to (though more permanent than) defining
classes on the command line with the <code>-D</code> option. 
You can now use these to qualify actions.  For example

<pre>
  any.exclude::
      ...
</pre>

<p>Under normal circumstances <code>exclude</code> is always true -- because you
have defined it to be so, but you can <em>undefine</em> it in two ways so
as to prevent the action from being carried out.  One way is to undefine
a class on the command line when you invoke cfengine:

<pre>host#  cfengine -N exclude
</pre>

<p>or

<pre>host#  cfengine -N exclude.shortversion

host#  cfengine -N a.b.c.d
</pre>

<p>These commands run cfengine with the named classes <em>undefined</em>. 
That means that actions labelled with these classes are excluded during
that run.

<p>Another way to restrict classes is to add a list of classes to be
undefined in the actionsequence.  See next section.

<p><hr>
Node:<a name="addinstallable">addinstallable</a>,
Next:<a rel=next href="#BinaryPaddingChar">BinaryPaddingChar</a>,
Previous:<a rel=previous href="#addclasses">addclasses</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>AddInstallable</h3>

<pre>   AddInstallable  = ( <var>list of identifiers</var> )
</pre>

<p>Some actions in your cfengine program will be labelled by classes which
only become defined at run time using a <code>define=</code> option. Cfengine
is not always able to see these classes until it meets them and tries to
save space by only loading actions for classes which is believes will
become defined at some point in the program. This can lead to some
actions being missed if the action is parsed before the place where the
class gets switched on, since cfengine is a one-pass interpreter,.  To
help cfengine determine classes which <em>might become defined</em> during
a run, you can declare them in this list. It does no harm to declare
classes here anyway. 
Here is an example where you need to declare a class because of the ordering
of the actions.

<pre>
control:

    AddInstallable  = ( myclass )

files:

   myclass::

     /tmp/test mode=644 action=fixall

copy:

     /tmp/foo dest=/tmp/test define=myclass

</pre>

<p>If we remove the declaration, then when cfengine meets the files
command, it skips it because it knows nothing about the class
<code>myclass</code>--when the copy command follows, it is too late.  Remember
that imported files are always parsed after the main program so definitions
made in imported files always come later than things in the main program.

<p><hr>
Node:<a name="BinaryPaddingChar">BinaryPaddingChar</a>,
Next:<a rel=next href="#ChecksumDatabase">ChecksumDatabase</a>,
Previous:<a rel=previous href="#addinstallable">addinstallable</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>BinaryPaddingChar</h3>

<pre>BinaryPaddingChar = ( \0 )
</pre>
This specifies the type of character used to pad strings of unequal
length in <code>editfiles</code> during binary editing.  The default value is
the space character, since this is normally used to edit filenames
or text messages within program code.

<p><hr>
Node:<a name="ChecksumDatabase">ChecksumDatabase</a>,
Next:<a rel=next href="#ChecksumUpdates">ChecksumUpdates</a>,
Previous:<a rel=previous href="#BinaryPaddingChar">BinaryPaddingChar</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ChecksumDatabase</h3>

<pre>ChecksumDatabase = ( /var/cfengine/cfdb )

</pre>

<p>If this filename is defined, cfengine will use it to store
message digests (i.e. cryptographic checksums) of files
for security purposes, See <a href="#files">files</a>, <code>checksum=</code>.

<p><hr>
Node:<a name="ChecksumUpdates">ChecksumUpdates</a>,
Next:<a rel=next href="#childlibpath">childlibpath</a>,
Previous:<a rel=previous href="#ChecksumDatabase">ChecksumDatabase</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ChecksumUpdates</h3>

<pre>ChecksumUpdates = ( on )

</pre>

<p>This variable defaults to `off'. If set to true, cfagent will
automatically update the checksum of a file, if it changes on the disk. 
This means that a security warning will be issued only once
about files which have changed, and the changed version will be re-registered
as the correct version. This option could be switched on after a
system upgrade, for instance, in order to update the database, and then
switched to `off' again to reduce the risk of missing a security
alert. Alternatively, if you are confident that the first message is
sufficient, it can be left as `on' so that only one message is
given.

<p><hr>
Node:<a name="childlibpath">childlibpath</a>,
Next:<a rel=next href="#copylinks">copylinks</a>,
Previous:<a rel=previous href="#ChecksumUpdates">ChecksumUpdates</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ChildLibPath</h3>

<p>Sets a value for LD_LIBRARY_PATH in child processes:
<pre>
 childlibpath = ( /usr/local/lib:/local/mysql/lib )

</pre>
Note that the variables LD_LIBRARY_PATH is special. This
library path is needed to run processes as children of cfengine. 
Often, if the agent is started from cron (which is started by init),
there is no suitable library path set, and shellcommands will
fail with strange errors about not being able to load shared
objects. Setting a library path here is a useful way of
correcting this problem.

<p><hr>
Node:<a name="copylinks">copylinks</a>,
Next:<a rel=next href="#defaultcopytype">defaultcopytype</a>,
Previous:<a rel=previous href="#childlibpath">childlibpath</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>CopyLinks</h3>

<p>This list is used to define a global list of names or patterns
which are to be copied rather than linked symbolically. For example

<pre>CopyLinks = ( *.config )
</pre>
The same facility can be specified for each individual
link operation using the <code>copy</code> option See <a href="#links">links</a>. 
Copying is performed using a file age comparison.

<p>Note that all entries defined under a specified class
are valid only as long as that class is defined. For instance
<pre>  <var>class</var>::

      CopyLinks = ( <var>pattern</var> )
</pre>

<p>would define a pattern which was only valid when
<var>class</var> is defined.

<p><hr>
Node:<a name="defaultcopytype">defaultcopytype</a>,
Next:<a rel=next href="#deletenonuserfiles">deletenonuserfiles</a>,
Previous:<a rel=previous href="#copylinks">copylinks</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DefaultCopyType</h3>

<p>This parameter determines the default form of copying for all copy operations
parsed after this variable. The legal values are
<code>ctime</code> (intial default), <code>mtime</code>, <code>checksum</code> and <code>binary</code>. 
e.g.

<pre>
 DefaultCopyType = ( mtime )

</pre>

<p><hr>
Node:<a name="deletenonuserfiles">deletenonuserfiles</a>,
Next:<a rel=next href="#deletenonownerfiles">deletenonownerfiles</a>,
Previous:<a rel=previous href="#defaultcopytype">defaultcopytype</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DeleteNonUserFiles</h3>

<p>If this parameter is set to true, cfengine will delete files
which do not have a name belonging to a known user id.

<pre>DeleteNonUserFiles = ( true )

SpoolDirectories = ( /var/spool/cron/crontabs )
</pre>

<p>This is an generalization of DeleteNonUserMail and makes it redundant. 
it is formally executed as a part of the "tidy" action.

<p><hr>
Node:<a name="deletenonownerfiles">deletenonownerfiles</a>,
Next:<a rel=next href="#deletenonusermail">deletenonusermail</a>,
Previous:<a rel=previous href="#deletenonuserfiles">deletenonuserfiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DeleteNonOwnerFiles</h3>

<p>If this parameter is set to true, cfengine will delete files on mailservers
whose names do not correspond to a known user name, but might be owned by a
known user.

<pre>DeleteNonOwnerFiles = ( true )

SpoolDirectories = ( /var/spool/cron/crontabs )
</pre>

<p>This is an generalization of DeleteNonOwnerMail and makes it redundant.

<p><hr>
Node:<a name="deletenonusermail">deletenonusermail</a>,
Next:<a rel=next href="#deletenonownermail">deletenonownermail</a>,
Previous:<a rel=previous href="#deletenonownerfiles">deletenonownerfiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DeleteNonUserMail</h3>

<p>If this parameter is set to true, cfengine will delete mail files on mailservers
which do not have a name belonging to a known user id. This does not
include lock files.

<p><hr>
Node:<a name="deletenonownermail">deletenonownermail</a>,
Next:<a rel=next href="#domain">domain</a>,
Previous:<a rel=previous href="#deletenonusermail">deletenonusermail</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DeleteNonOwnerMail</h3>

<p>If this parameter is set to true, cfengine will delete files on mailservers
whose names do not correspond to a known user name, but might be owned by a
known user.

<p><hr>
Node:<a name="domain">domain</a>,
Next:<a rel=next href="#dryrun">dryrun</a>,
Previous:<a rel=previous href="#deletenonownermail">deletenonownermail</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>domain</h3>

<pre>  domain = ( <var>domain name</var> )
</pre>

<p>This variable defines the domainname for your site.  You must define it
here, because your system might not know its domainname when you run
cfengine for the first time.  The domainname can be used as a cfengine
variable subsequently by referring to $(domain).  The domainname
variable is used by the action <code>resolve</code>. The domain is also used
implicitly by other matching routines. You should define the domain as
early as possible in your configuration file so as to avoid problems,
especially if you have the strange practice of naming hosts with their
fully qualified host names since groups which use fully qualified names
can fail to be defined if cfengine is not able to figure out the domain name.

<p><hr>
Node:<a name="dryrun">dryrun</a>,
Next:<a rel=next href="#editbinaryfilesize">editbinaryfilesize</a>,
Previous:<a rel=previous href="#domain">domain</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>DryRun</h3>

<pre>
  DryRun = ( <var>on/</var><b>off</b> )

</pre>

<p>This variable has the same effect as the command line options
<kbd>--dry-run</kbd> or <kbd>-n</kbd>. It tells cfengine to only report
what it should do without actually doing it.
<pre>
 <var>classes</var>::

   DryRun = ( on )

</pre>

<p><hr>
Node:<a name="editbinaryfilesize">editbinaryfilesize</a>,
Next:<a rel=next href="#editfilesize">editfilesize</a>,
Previous:<a rel=previous href="#dryrun">dryrun</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>editbinaryfilesize</h3>

<pre>   EditBinaryFileSize  = ( <var>size</var> )
</pre>

<p>Cfengine will refuse to edit a file which is larger than the value of
<code>editbinaryfilesize</code> in bytes.  This is to prevent possible
accidents from occurring.  The default value for this variable is 10000000
bytes.  If you don't like this feature, simply set the value to be a
very large number or to zero.  If the value is zero, cfengine will
ignore it.

<p><hr>
Node:<a name="editfilesize">editfilesize</a>,
Next:<a rel=next href="#emptyresolvconf">emptyresolvconf</a>,
Previous:<a rel=previous href="#editbinaryfilesize">editbinaryfilesize</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>editfilesize</h3>

<pre>   EditfileSize  = ( <var>size</var> )
</pre>

<p>This variable is used by cfengine every time it becomes necessary to
edit a file.  Since file editing applies only to text files, the files
are probably going to be relatively small in most cases.  Asking to edit
a very large (perhaps binary) file could therefore be the result of an
error.

<p>A check is therefore made as a security feature.  Cfengine will refuse
to edit a file which is larger than the value of <code>editfilesize</code> in
bytes.  This is to prevent possible accidents from occurring.  The
default value for this variable is 10000 bytes.  If you don't like this
feature, simply set the value to be a very large number or to zero. 
If the value is zero, cfengine will ignore it.

<p><hr>
Node:<a name="emptyresolvconf">emptyresolvconf</a>,
Next:<a rel=next href="#exclamation">exclamation</a>,
Previous:<a rel=previous href="#editfilesize">editfilesize</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>EmptyResolvConf</h3>

<pre>   EmptyResolvConf  = ( true )
</pre>

<p>Normally cfengine does not tidy up old entries in the <code>/etc/resolv.conf</code>
file. This option causes cfengine to remove old nameserver entries.

<p><hr>
Node:<a name="exclamation">exclamation</a>,
Next:<a rel=next href="#excludecopy">excludecopy</a>,
Previous:<a rel=previous href="#emptyresolvconf">emptyresolvconf</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Exclamation</h3>

<p>This variable defaults to "on". If set to "off", no exclaimation
marks are printed during security alerts, e.g. for checksum violations.

<pre>   Exclamation  = ( off )
</pre>

<p><hr>
Node:<a name="excludecopy">excludecopy</a>,
Next:<a rel=next href="#excludelinks">excludelinks</a>,
Previous:<a rel=previous href="#exclamation">exclamation</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ExcludeCopy</h3>

<p>This list is used to define a global list of names or patterns
which are to be excluded from copy operations. For example

<pre> ExcludeCopy = ( *~ *% core )
</pre>
The same facility can be specified for each individual
link operation using the <code>exclude</code> option See <a href="#copy">copy</a>.

<p>Note that all entries defined under a specified class
are valid only as long as that class is defined. For instance
<pre>  <var>class</var>::

      ExcludeCopy = ( <var>pattern</var> )
</pre>

<p>would define a pattern which was only valid when
<var>class</var> is defined.

<p><hr>
Node:<a name="excludelinks">excludelinks</a>,
Next:<a rel=next href="#ExpireAfter">ExpireAfter</a>,
Previous:<a rel=previous href="#excludecopy">excludecopy</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ExcludeLinks</h3>

<p>This list is used to define a global list of names or patterns
which are to be excluded from linking operations. For example

<pre> ExcludeLinks = ( *~ *% core )
</pre>
The same facility can be specified for each individual
link operation using the <code>exclude</code> option See <a href="#links">links</a>.

<p>Note that all entries defined under a specified class
are valid only as long as that class is defined. For instance
<pre>  <var>class</var>::

      ExcludeLinks = ( <var>pattern</var> )
</pre>

<p>would define a pattern which was only valid when
<var>class</var> is defined.

<p><hr>
Node:<a name="ExpireAfter">ExpireAfter</a>,
Next:<a rel=next href="#homepattern">homepattern</a>,
Previous:<a rel=previous href="#excludelinks">excludelinks</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ExpireAfter</h3>

<p>This parameter controls the global value of the ExpireAfter parameter. 
See <a href="cfengine-Tutorial.html#Spamming%20and%20security">Spamming and security</a>. This parameter controls the maximum time in
minutes which a cfengine action is allowed to live. After this time
cfengine will try to kill the cfengine which seems to have hung and
attempt to restart the action.

<pre>
 ExpireAfter = ( <var>time-in-minutes</var> )

</pre>

<p>This parameter may also be set per action in the action
sequence by appending a pseudo-class called <code>ExpireAfter<var>time</var></code>. 
For instance,

<pre>
 actionsequence = ( copy.ExpireAfter15 )

</pre>

<p>sets the expiry time parameter to 15 minutes for this copy command.

<p><hr>
Node:<a name="homepattern">homepattern</a>,
Next:<a rel=next href="#IfElapsed">IfElapsed</a>,
Previous:<a rel=previous href="#ExpireAfter">ExpireAfter</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>HomePattern</h3>

<pre>   HomePattern  = ( <var>list of patterns</var> )
</pre>

<p>The <code>homepattern</code> variable is used by the cfengine model for
mounting nfs filesystems.  See <a href="cfengine-Tutorial.html#NFS%20resources">NFS resources</a>.  It is also used in the evaluation of the
pseudo variable <code>home</code>, See <a href="#files">files</a>, <a href="#tidy">tidy</a>.

<p><code>homepattern</code> is in fact a list and is used like a wildcard or
<em>pattern</em> to determine which filesystems in the list of mountables
are home directories.  See <a href="#mountables">mountables</a>.  This relies on your sticking
to a rigid naming convention as described in the first reference above.

<p>For example, you might wish to mount (or locate directly if you are not
using a separate partition for home directories) your home directories
under <code>mountpattern</code> in directories <code>u1</code>, <code>u2</code> and so on. 
In this case you would define <code>homepattern</code> to match these numbers:

<pre>homepattern = ( u? )
</pre>

<p>Cfengine now regards any directory matching
<code>$(mountpattern)/u?</code> as being a user login directory.

<p>Suppose you want to create mount home directories under
<code>$(mountpattern)/home</code> and make subdirectories for staff and
students.  Then you would be tempted to write:

<pre> HomePattern = ( home/staff home/students )
</pre>

<p>Unfortunately this is not presently possible. (This is, in principle,
a bug which should be fixed in the future.) What you can do instead is
to achieve the same this as follows:

<pre> MountPattern = ( /$(site)/$(host) /$(site)/$(host)/home )
 HomePattern = ( staff students )
</pre>

<p><hr>
Node:<a name="IfElapsed">IfElapsed</a>,
Next:<a rel=next href="#Inform">Inform</a>,
Previous:<a rel=previous href="#homepattern">homepattern</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>IfElapsed</h3>

<p>This parameter controls the global value of the IfElapsed
parameter, See <a href="cfengine-Tutorial.html#Spamming%20and%20security">Spamming and security</a>. This parameter
controls the minimum time which must have elapsed for
an action in the action sequence before which it will be
executed again.

<pre>
 IfElapsed = ( <var>time-in-minutes</var> )

</pre>

<p>This parameter may also be set per action in the action
sequence by appending a pseudo-class called <code>IfElapsed<var>time</var></code>. 
For instance,

<pre>
 ActionSequence = ( copy.IfElapsed15 )

</pre>

<p>sets the elapsed time parameter to 15 minutes for this copy command.

<p><hr>
Node:<a name="Inform">Inform</a>,
Next:<a rel=next href="#interfacename">interfacename</a>,
Previous:<a rel=previous href="#IfElapsed">IfElapsed</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Inform</h3>

<pre>
  Inform = ( <var>on/</var><b>off</b> )

</pre>

<p>This variable switches on the output level whereby cfengine
reports changes it makes during a run. Normally only
urgent messages or clear errors are printed. Setting
<code>Inform</code> to <code>on</code> makes cfengine report on
all actions not explicitly cancelled with a `silent' option. 
To set this output level one writes:

<pre>
 <var>classes</var>::

   Inform = ( on )

</pre>

<p><hr>
Node:<a name="interfacename">interfacename</a>,
Next:<a rel=next href="#fileextension">fileextension</a>,
Previous:<a rel=previous href="#Inform">Inform</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>InterfaceName</h3>

<p>If you have an operating system which is installed on some
non-standard hardware, you might have to specifically set the
name of the network interface. For example:

<pre>
  control:

    nextstep.some::

       InterfaceName = ( en0 )

    nextstep.others::

       InterfaceName = ( ec0 )

</pre>

<p>It is only necessary to set the interface name in this fashion
if you have an operating system which is running on special
hardware. Most users will not need this. 
The choice set here overrides the system defaults and the
choices made in the <code>cfrc</code> file, See <a href="#cfrc%20resource%20file">cfrc resource file</a>.

<p><hr>
Node:<a name="fileextension">fileextension</a>,
Next:<a rel=next href="#linkcopies">linkcopies</a>,
Previous:<a rel=previous href="#interfacename">interfacename</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>FileExtensions</h3>

<p>This list may be used to define a number of extensions
which are regarded as being plain files by the system. 
As part of the general security checking cfengine will
warn about any directories which have names using
these extensions. They may be used to conceal directories.

<pre>
  FileExtensions = ( c o gif jpg html )

</pre>

<p><hr>
Node:<a name="linkcopies">linkcopies</a>,
Next:<a rel=next href="#LogDirectory">LogDirectory</a>,
Previous:<a rel=previous href="#fileextension">fileextension</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>LinkCopies</h3>

<p>This list is used to define a global list of names or patterns
which are to be linked symbolically rather than copied. For example

<pre>excludelinks = ( *.gif *.jpg )
</pre>
The same facility can be specified for each individual
link operation using the <code>symlink</code> option See <a href="#copy">copy</a>.

<p>Note that all entries defined under a specified class
are valid only as long as that class is defined. For instance
<pre>  <var>class</var>::

      LinkCopies = ( <var>pattern</var> )
</pre>

<p>would define a pattern which was only valid when
<var>class</var> is defined.

<p><hr>
Node:<a name="LogDirectory">LogDirectory</a>,
Next:<a rel=next href="#LogTidyHomeFiles">LogTidyHomeFiles</a>,
Previous:<a rel=previous href="#linkcopies">linkcopies</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>LogDirectory</h3>

<p>Specify an alternative directory for keeping cfengine's
log data. This defaults to <code>/var/run/cfengine</code> or
<code>/var/cfengine</code>.

<pre>
  LogDirectory = ( /var/cfengine )

</pre>

<p><hr>
Node:<a name="LogTidyHomeFiles">LogTidyHomeFiles</a>,
Next:<a rel=next href="#moduledirectory">moduledirectory</a>,
Previous:<a rel=previous href="#LogDirectory">LogDirectory</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>LogTidyHomeFiles</h3>

<pre>
  LogTidyHomeFiles = ( off )

</pre>

<p>If set to "off", no log is made of user files, in their
home directories, of the files which are tidied by cfengine.

<p><hr>
Node:<a name="moduledirectory">moduledirectory</a>,
Next:<a rel=next href="#mountpattern">mountpattern</a>,
Previous:<a rel=previous href="#LogTidyHomeFiles">LogTidyHomeFiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>moduledirectory</h3>

<pre>   moduledirectory  = ( <var>directory for plugin modules</var> )
</pre>

<p>This is the directory where cfengine will look for plug-in modules
for the actionsequence, See <a href="#actionsequence">actionsequence</a>. Plugin modules
may be used to activate classes using special algorithms. 
See <a href="cfengine-Tutorial.html#Writing%20plugin%20modules">Writing plugin modules</a>.

<p><hr>
Node:<a name="mountpattern">mountpattern</a>,
Next:<a rel=next href="#netmask">netmask</a>,
Previous:<a rel=previous href="#moduledirectory">moduledirectory</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>mountpattern</h3>

<pre>   mountpattern  = ( <var>mount-point</var> )
</pre>

<p>The <code>mountpattern</code> list is used by the cfengine model for mounting
nfs filesystems.  See <a href="cfengine-Tutorial.html#NFS%20resources">NFS resources</a>.  It is also used in the evaluation of the
pseudo variable <code>home</code>, See <a href="#files">files</a>, <a href="#tidy">tidy</a>.

<p>It is used together with the value of <code>homepattern</code> to locate and
identify what filesystems are local to a given host and which are
mounted over the network.  For this list to make sense you need to
stick to a rigid convention for mounting your filesystems under a single
naming scheme as described in the section mentioned above.  If you
follow the recommended naming scheme then you will want to set the value
of mountpattern to

<pre>mountpattern = ( /$(site)/$(host) )
</pre>

<p>which implies that cfengine will look for local disk partitions under a
unique directory given by the name of the host and site.  Any
filesystems which are physically located on the current host lie in this
directory.  All mounted filesystems should lie elsewhere. If you
insist on keeping mounted file systems in more than one location, you
can make a list like this:

<pre>mountpattern = ( /$(site)/users /$(site)/projects )
</pre>

<p><hr>
Node:<a name="netmask">netmask</a>,
Next:<a rel=next href="#nonalphanumfiles">nonalphanumfiles</a>,
Previous:<a rel=previous href="#mountpattern">mountpattern</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>netmask</h3>

<pre>   netmask = ( <var>aaa.bbb.ccc.ddd</var> )
</pre>

<p>The netmask variable defines the partitioning of the subnet addresses on
your network.  Its value is defined by your network administrator.  On
most systems it is likely to be <code>255.255.255.0</code>.  This is used to
configure the network interface in <code>netconfig</code>. 
See <a href="#actionsequence">actionsequence</a>.

<p>Every host on the internet has its own unique address.  The addresses
are assigned hierarchically.  Each network gets a <em>domain name</em> and
can attach something like 65,000 hosts to that network.  Since this is
usually too many to handle in one go, every such network may be divided
up into subnets.  The administrator of the network can decide how the
division into subnets is made.  The decision is a trade-off between
having many subnets with few hosts, or many hosts on few subnets.  This
choice is made by setting the value of a variable called <code>netmask</code>. 
The netmask looks like an internet address.  It takes the form:

<pre>
   aaa.bbb.ccc.mmm

</pre>

<p>The first two numbers <code>aaa.bbb</code> are the address of the domain.  The
remainder <code>ccc.mmm</code> specifies both the subnet and the hostname. 
The value of <code>netmask</code> tells all hosts on the network: how many of
the bits in the second half label different subnets and how many label
different hosts on each of the subnets?

<p>The most common value for the netmask is <code>255.255.255.0</code>.  It is
most helpful to think of the netmask in terms of bits.  Each base-10
number between 0-255 represents 8 bits which are either set or not set. 
Every bit which is set is a network address and every bit which is zero
is part of a host address.  The first two parts of the address
<code>255.255</code> always takes these values.  If the third number is
<code>255</code>, it means that the domain is divided up into 256 sub networks
and then the remaining bits which are zero can be used to give 255
different host addresses on each of the subnets.

<p>If the value had been <code>255.255.255.254</code>, the network would be
divided up into 2^15 subnets, since fifteen of the sixteen bits
are one.  The remaining bit leaves enough room for two addresses 0 and
1.  One of those is reserved for <em>broadcasts</em> to all hosts, the
other can be an actual host -- there would only be room for one host
per subnet.  This is a stupid example of course, the main point with the
subnet mask is that it can be used to trade subnets for hosts per
subnet.  A value of <code>255.255.254.0</code> would allow 128 different
subnets with 2*256-1 = 511 hosts on each.

<p>We needn't be concerned with the details of the netmask here.  Suffice
it to say that its value is determined for your entire domain by the
network administrator and each host has to be told what the value is.

<p>Each host must also know what convention is used for the <em>broadcast
address</em>.  This is an address which hosts can send to if they wish to
send a message to every other host on their subnet simultaneously.  It is
used a lot by services like NIS to ask if any hosts are willing to
perform a particular service.  There are two main conventions for the
broadcast address: address zero (all host bits are zero) and the highest
address on the subnet (all host bits are ones).  The convention can be
different on every subnet and it is decided by the network
administrator.  When you write a cfengine program you just specify the
convention used on your subnet and cfengine works out the value of the
broadcast address from the netmask and the host address
See <a href="#broadcast">broadcast</a>.  Cfengine works out the value of the broadcast address
using the value of the netmask.

<p><hr>
Node:<a name="nonalphanumfiles">nonalphanumfiles</a>,
Next:<a rel=next href="#nfstype">nfstype</a>,
Previous:<a rel=previous href="#netmask">netmask</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>NonAlphaNumFiles</h3>

<p>If enabled, this option causes cfengine to detect and
disable files which have purely non-alphanumeric
filenames, i.e. files which might be accidental or
deliberately concealed. The files are then marked
with a suffix <code>.cf-nonalpha</code> and are rendered
visible.

<pre>
  NonAlphaNumFiles = ( on )

</pre>

<p>These files can then be tidied by searching for
the suffix. Note that alphanumeric means
ascii codes less than 32 and greater than 126.

<p><hr>
Node:<a name="nfstype">nfstype</a>,
Next:<a rel=next href="#repchar">repchar</a>,
Previous:<a rel=previous href="#nonalphanumfiles">nonalphanumfiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>nfstype</h3>

<pre>   nfstype = ( <var>nfs-type</var> )
</pre>

<p>This variable is included only for future expansion.  If you do not
define this variable, its value defaults to "nfs".

<p>At present cfengine operates only with NFS (the network file system). 
When cfengine looks for network file systems to mount, it adds lines in
the filesystem table (<code>/etc/fstab</code>,<code>/etc/checklist</code> etc.)  to
try to mount filesystems of type "nfs".  In principle you might want
to use a completely different system for mounting filesystems over the
network, in which case the `mount type' would not be "nfs" but
something else.

<p>At the time of writing certain institutions are replacing NFS with AFS
(the Andrew filesystem) and DFS (from the distributed computing
environment).  The use of these filesystems really excludes the need to
use the mount protocol at all.  In other words if you are using AFS or
DFS, you don't need to use cfengine's mounting commands at all.

<p><hr>
Node:<a name="repchar">repchar</a>,
Next:<a rel=next href="#repository">repository</a>,
Previous:<a rel=previous href="#nfstype">nfstype</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>RepChar</h3>

<pre>   RepChar  = ( <var>character</var> )
</pre>

<p>The value of this variable determines the characters which is used by
cfengine in creating the unique filenames in the file
repository. Normally, its value is set to <code>_</code> and each <code>/</code> in
the path name of the file is changed to <code>_</code> and stored in the
repository. If you prefer a different character, define it here. Note
that the character can be quoted with either single or double quotes in
order to encompass spaces etc.

<p><hr>
Node:<a name="repository">repository</a>,
Next:<a rel=next href="#schedule">schedule</a>,
Previous:<a rel=previous href="#repchar">repchar</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Repository</h3>

<pre>   Repository  = ( <var>directory</var> )
</pre>

<p>Defines a special directory where all backup and junk
files are collected. Files are assigned a unique filename
which identifies the path from which they originate. 
This affects files saved using <code>disable</code>, <code>copy</code>,
<code>links</code> and <code>editfiles</code> See <a href="cfengine-Tutorial.html#Disabling%20and%20the%20file%20repository">Disabling and the file repository</a>.

<p><hr>
Node:<a name="schedule">schedule</a>,
Next:<a rel=next href="#secureinput">secureinput</a>,
Previous:<a rel=previous href="#repository">repository</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Schedule</h3>

<pre>   schedule  = (  Min00_05 Min30_35 <var>time class</var> )
</pre>

<p>When <code>cfexecd</code> is used in daemon mode, it defaults to running
once an hour, on the hour, i.e..
<pre>   schedule  = (  Min00_05 )
</pre>
This can be extended to make the agent run more often. The time
specifiers are cfengine classes, and are written as intervals of time
rather the precise times.  Cfengine's time resolution is purposely
limited to five minutes because the auto-correlation time of user
resources is generally greater than this. Thus, it is assumed that
precision timing is not required and the start time of cfengine, when
scheduled in daemon mode, is not better than a few minutes.  The daemon
does not require precision, but offers many other strategic
features for load balancing and security.

<p>Other time classes can be used in the schedule list, but note
that cfexecd will not run the agent more than once every five minutes. 
This is treated as a fundamental granularity.

<p><hr>
Node:<a name="secureinput">secureinput</a>,
Next:<a rel=next href="#sensiblecount">sensiblecount</a>,
Previous:<a rel=previous href="#schedule">schedule</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>SecureInput</h3>

<pre>   SecureInput = ( on )
</pre>

<p>If this is set cfengine will not import
files which are not owned by the uid running the program, or
   which are writable by groups or others.

<p><hr>
Node:<a name="sensiblecount">sensiblecount</a>,
Next:<a rel=next href="#sensiblesize">sensiblesize</a>,
Previous:<a rel=previous href="#secureinput">secureinput</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>SensibleCount</h3>

<pre>   SensibleCount  = ( <var>count</var> )
</pre>

<p>This variable is used by the action <code>required</code>.  It defines for
cfengine what you consider to be the minimum number of files in a
`required' directory.  If you declare a directory as being required,
cfengine will check to see if it exists.  Then, if the directory
contains fewer than the value of <code>sensiblecount</code> files, a warning
is issued.  The default value for this variable is 2.

<p><hr>
Node:<a name="sensiblesize">sensiblesize</a>,
Next:<a rel=next href="#showactions">showactions</a>,
Previous:<a rel=previous href="#sensiblecount">sensiblecount</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>SensibleSize</h3>

<pre>   SensibleSize  = ( <var>size</var> )
</pre>

<p>This variable is used by the action <code>required</code>.  It defines for
cfengine what you consider to be the minimum size for a `required' file. 
If you declare a file as being required, cfengine will check to see if
the file exists.  Of course, the file may exist but be empty, so the
size of the file is also checked against this constant.  If the file is
smaller than the value of <code>sensiblesize</code> a warning is issued.  The
default value for this variable is 1000 bytes.

<p><hr>
Node:<a name="showactions">showactions</a>,
Next:<a rel=next href="#site">site</a>,
Previous:<a rel=previous href="#sensiblesize">sensiblesize</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>ShowActions</h3>

<pre>   ShowActions  = ( <var>on</var> )
</pre>

<p>This causes cfengine to produce detailed output of what action is
being carried out as part of the prefix information during output. 
This is intended only for third party tools which collect and parse
the cfengine output. It will be of little interest to humans.

<p><hr>
Node:<a name="site">site</a>,
Next:<a rel=next href="#SplayTime">SplayTime</a>,
Previous:<a rel=previous href="#showactions">showactions</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>site/faculty</h3>

<pre>  site    = ( <var>sitename</var> )
  faculty = ( <var>facultyname</var> )
</pre>

<p>This variable defines a convenient name for your site configuration.  It
is useful for making generic rules later on, because it means for
instance that you can define the name of a directory to be

<pre>/$(site)/$(host)/local
</pre>

<p>without having to redefine the rule for a specific site.  This is a
handy trick for making generic rules in your files which can be imported
into a configuration for any site.

<p><code>faculty</code> is a synonym for <code>site</code>.  The two names
may be used interchangeably.

<p><hr>
Node:<a name="SplayTime">SplayTime</a>,
Next:<a rel=next href="#split">split</a>,
Previous:<a rel=previous href="#site">site</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>SplayTime</h3>

<pre>  SplayTime = ( <var>time-in-minutes</var> )
</pre>

<p>This variable is used to set the maximum time over
which cfengine will share its load on a server,
See <a href="cfengine-Tutorial.html#Splaying%20host%20times">Splaying host times</a>.

<p><hr>
Node:<a name="split">split</a>,
Next:<a rel=next href="#spooldirectories">spooldirectories</a>,
Previous:<a rel=previous href="#SplayTime">SplayTime</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Split</h3>

<pre>   Split  = ( <var>character</var> )
</pre>

<p>The value of this variable is used to define the list separator in
variables which are expected to be treated as lists. The default value
of this variable is the colon <code>:</code>.  Cfengine treats variables
containing this character as lists to be broken up and iterated over in
the following cases:

<ul>

<li>in the `to' field of a multiple link action,

<li>in the `from' field of a copy action,

<li>in the directory field of a tidy action,

<li>in the directory field of the files action,

<li>in the ignore action.

</ul>

<p>This typically allows communication with PATH-like
environment variables in the shell.

<p><hr>
Node:<a name="spooldirectories">spooldirectories</a>,
Next:<a rel=next href="#suspiciousnames">suspiciousnames</a>,
Previous:<a rel=previous href="#split">split</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>SpoolDirectories</h3>

<p>A list of additional spool directories for cfengine to police. In these
directories, filenames should correspond to existing users of the
system.  When users lost their accounts, this list plus the mail spool
directory will be checked for files owned by deprecated users. 
See also: <code>DeleteNonOwnerFiles</code>, <code>DeleteNonUserFiles</code>.

<pre>  SpoolDirectories = ( /var/spool/cron/crontabs /var/spool/cron/atjobs )
</pre>

<p><hr>
Node:<a name="suspiciousnames">suspiciousnames</a>,
Next:<a rel=next href="#sysadm">sysadm</a>,
Previous:<a rel=previous href="#spooldirectories">spooldirectories</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>suspiciousnames</h3>

<pre>  SuspiciousNames = ( .mo lrk3 )
</pre>

<p>Filenames in this list are treated as suspicious and generate a warning
as cfengine scans directories. This might be used to detect hacked systems
or concealed programs. Checks are only made in directories which cfengine
scans in connection with a command such as files, tidy or copy.

<p><hr>
Node:<a name="sysadm">sysadm</a>,
Next:<a rel=next href="#Syslog">Syslog</a>,
Previous:<a rel=previous href="#suspiciousnames">suspiciousnames</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>sysadm</h3>

<pre>   sysadm = ( <var>mail address</var> )
</pre>

<p>The mail address of your system administrator should be placed here. 
This is used in two instances.  If cfengine is invoked with the option
<code>-a</code>, then it simply prints out this value.  This is a handy
feature for making scripts.

<p>The administrators mail address is also written into the personal log
files which cfengine creates for each user after tidying files, so you
should make this an address which users can mail if they have troubles.

<p><hr>
Node:<a name="Syslog">Syslog</a>,
Next:<a rel=next href="#timezone">timezone</a>,
Previous:<a rel=previous href="#sysadm">sysadm</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Syslog</h3>

<pre>
  Syslog = ( <var>on/</var><b>off</b> )

</pre>

<p>This variable activates syslog logging of cfengine output at
the `inform' level.

<p>To set this output level one writes:

<pre>
 <var>classes</var>::

   Syslog = ( on )

</pre>

<p><hr>
Node:<a name="timezone">timezone</a>,
Next:<a rel=next href="#TimeOut">TimeOut</a>,
Previous:<a rel=previous href="#Syslog">Syslog</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>timezone</h3>

<pre>   timezone = ( <var>3-character timezone</var> )
</pre>

<p>The timezone variable is a list of character strings which define your local
timezone.  Normally you will only need a single timezone, but sometimes
there are several aliases for a given timezone e.g. MET and CET are synonymous. 
Currently only the first three characters of this string are
checked against the timezone which cfengine manages to glean from the
system.  If a mismatch is detected a warning message is printed. 
cfengine does not attempt to configure the timezone.  This feature works
only as a reminder, since the timezone should really be set once and for
all at the time the system is installed.  On some systems you can set
the timezone by editing a file, a procedure which you can automate with
cfengine See <a href="#editfiles">editfiles</a>.

<p>The value of the <code>timezone</code> can be accessed by variable substitution
in the usual way. It expands to the first item in your list.

<pre>shellcommands:

       "echo ${timezone} | mail ${sysadm}"

</pre>

<p><hr>
Node:<a name="TimeOut">TimeOut</a>,
Next:<a rel=next href="#Verbose">Verbose</a>,
Previous:<a rel=previous href="#timezone">timezone</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>TimeOut</h3>

<pre>
  TimeOut = ( 10 )

</pre>

<p>The default timeout for network connections is 10 seconds. This
is too short on some routed networks. It is not permitted to set
this variable smaller than 3 seconds or larger than 60 seconds.

<p><hr>
Node:<a name="Verbose">Verbose</a>,
Next:<a rel=next href="#Warnings">Warnings</a>,
Previous:<a rel=previous href="#TimeOut">TimeOut</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Verbose</h3>

<pre>
  Verbose = ( <var>on/</var><b>off</b> )

</pre>

<p>This variable switches on the output level whereby cfengine
reports everything it does during a run in great detail. Normally only
urgent messages or clear errors are printed, See <a href="#Inform">Inform</a>. 
This option is almost equivalent to using the <kbd>--verbose</kbd> of <kbd>-v</kbd>
command-line options. The only difference is that system environment reporting
information, which is printed prior to parsing, is not shown. 
To set this output level on selected hosts one writes:

<pre>
 <var>classes</var>::

   Verbose = ( on )

</pre>

<p>For related more limited output, See <a href="#Inform">Inform</a>.

<p><hr>
Node:<a name="Warnings">Warnings</a>,
Next:<a rel=next href="#warnnonuserfiles">warnnonuserfiles</a>,
Previous:<a rel=previous href="#Verbose">Verbose</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>Warnings</h3>

<pre>
  Warnings = ( <var>on/</var><b>off</b> )

</pre>

<p>This variable switches on the parser-output level whereby cfengine
reports non-fatal warnings.  This is equivalent to setting the command
line switch <kbd>--no-warn</kbd>, or <kbd>-w</kbd>.  To set this output level on
selected hosts one writes:

<pre>
 <var>classes</var>::

   Warnings = ( on )

</pre>

<p><hr>
Node:<a name="warnnonuserfiles">warnnonuserfiles</a>,
Next:<a rel=next href="#warnnonownerfiles">warnnonownerfiles</a>,
Previous:<a rel=previous href="#Warnings">Warnings</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>WarnNonUserFiles</h3>

<p>If this parameter is set to true, cfengine will warn about files in
spool directories which do not have a name belonging to a known user id.

<p>See also <code>DeleteNonUserFiles</code>.

<p><hr>
Node:<a name="warnnonownerfiles">warnnonownerfiles</a>,
Next:<a rel=next href="#warnnonusermail">warnnonusermail</a>,
Previous:<a rel=previous href="#warnnonuserfiles">warnnonuserfiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>WarnNonOwnerFiles</h3>

<p>If this parameter is set to true, cfengine will warn about files on
mailservers whose names do not correspond to a known user name, but
might be owned by a known user.

<pre>
SpoolDirectories = ( /var/spool/cron/crontabs )

WarnNonOwnerFiles = ( true )

</pre>

<p>See also <code>DeleteNonOwnerFiles</code>. This generalizes and succeeds <code>DeleteNonOwnerMail</code>.

<p><hr>
Node:<a name="warnnonusermail">warnnonusermail</a>,
Next:<a rel=next href="#warnnonownermail">warnnonownermail</a>,
Previous:<a rel=previous href="#warnnonownerfiles">warnnonownerfiles</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>WarnNonUserMail</h3>

<p>If this parameter is set to true, cfengine will warn about mail files on
mailservers which do not have a name belonging to a known user id. This
does not include lock files.

<p><hr>
Node:<a name="warnnonownermail">warnnonownermail</a>,
Previous:<a rel=previous href="#warnnonusermail">warnnonusermail</a>,
Up:<a rel=up href="#control">control</a>
<br>

<h3>WarnNonOwnerMail</h3>

<p>If this parameter is set to true, cfengine will warn about files on
mailservers whose names do not correspond to a known user name, but
might be owned by a known user.

<p><hr>
Node:<a name="classes">classes</a>,
Next:<a rel=next href="#copy">copy</a>,
Previous:<a rel=previous href="#control">control</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>classes</h2>

<p>The <code>classes</code> keyword is an alias for <code>groups</code> as of
version 1.4.0 of cfengine.

<p><hr>
Node:<a name="copy">copy</a>,
Next:<a rel=next href="#defaultroute">defaultroute</a>,
Previous:<a rel=previous href="#classes">classes</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>copy</h2>

<p>Cfengine copies files between locally mounted filesystems and via the
network from registered servers.  The copy algorithm avoids
race-conditions which can occur due to network and system latencies by
copying first to a file called <code><var>file</var>.cfnew</code> on the local
filesystem, and then renaming this quickly into place.  The aim of this
roundabout procedure is to avoid situations where the direct rewriting
of a file is interrupted midway, leaving a partially written file to be
read by other processes.  Cfengine attempts to preserve hard links to
non-directory file-objects, but see the caution below.

<p><em>Caution should be exercised in copying files which change rapidly in size. 
This can lead to file corruption, if the size changes during copying. Cfengine
attempts to prevent this during remote copies.</em>

<p>The syntax summary is:

<pre>
copy:

   <var>class</var>::

      <var>master-file</var>
                        dest=<var>destination-file</var>
                        mode=<var>mode</var>
                        owner=<var>owner</var>
                        group=<var>group</var>
                        action=<var>silent/fix</var>
                        backup=<b>true</b><var>/false</var>
                        repository=<var>backup directory</var>
                        stealth=<var>true/on/<b>false/off</b></var>
                        timestamps=<b>preserve/keep</b>
                        symlink=<var>pattern</var>
                        include=<var>pattern</var>
                        exclude=<var>pattern</var>
                        ignore=<var>pattern</var>
                        filter=<var>filteralias</var>
                        recurse=<var>number/inf/</var><var>0</var>
                        type=<b>ctime</b><var>/mtime/checksum/sum/byte/binary</var>
                        linktype=<b>absolute/symbolic</b><var>/relative/hard/none/copy</var>
                        typecheck=<b>true/on</b>/<var>false/off</var>
                        define=<var>class-list</var>(,:.)
                        elsedefine=<var>class-list</var>(,:.)

                        force=<var>true/on</var>/<b>false/off</b>
                        forcedirs=<var>true/on</var>/<b>false/off</b>
                        forceipv4=<var>true/on</var>/<b>false/off</b>
                        size=<var>size limits</var>
                        server=<var>server-host</var>

                        trustkey=<var>true</var>/<b>false</b>
                        secure=[deprecated]
                        encrypt=<var>true</var>/<b>false</b>
                        verify=<var>true</var>/<b>false</b>
                        oldserver=<var>true</var>/<b>false</b>

                        purge=<var>true/</var><b>false</b>

                        syslog=<var>true/on</var>/<var>false/off</var>
                        inform=<var>true/on</var>/<var>false/off</var>

</pre>

<dl>

<br><dt><code>dest</code>
<dd>The destination file is the only obligatory item. This must be the name
of an object which matches the type of the master object i.e. if the
master is a plain file, the destination must also be the explicit name
of a plain file. An implicit `copy file to directory' syntax is not
allowed.  Symbolic links are copied as symbolic links, plain files are
copied as plain files and special files are copied as special files. If
the master and image are directories then all of the child files
<em>which are not directories</em> are copied from source to destination.

<br><dt><code>mode, owner, group</code>
<dd>The file mode, owner
and group of the images are specified as in the <code>files</code> function
See <a href="#files">files</a>.

<br><dt><code>action</code>
<dd>The action may take the values <code>warn</code> or
<code>silent</code>. The default action is <code>fix</code>, i.e.  copy files. If <code>warn</code>
is specified, only a warning is issued about files which require
updating. If <code>silent</code> is given, then cfengine will copy the files
but not report the fact.

<br><dt><code>force</code>
<dd>If set to `true', this option causes cfengine to copy files regardless
of whether it is up to date.

<br><dt><code>forceipv4</code>
<dd>If you are working on an ipv6 enabled pair of hosts, cfengine will
normally select ipv6 for communication between them. If you wish
to force the use of ipv4 for some reason, set this option to true.

<br><dt><code>forcedirs</code>
<dd>If set to `true', this option causes files or links which block the
creation of directories, during recursive copying, to be moved
aside forcably. A single non-supressable warning is given when this
occurs; the file is moved to filename<code>.cf-moved</code>.

<br><dt><code>backup</code>
<dd>If the <code>backup</code> option is set to "false", cfengine
will not make a backup copy of the file before copying.

<br><dt><code>repository</code>
<dd>This allows a local override of the <code>Repository</code> variable, on an item
by item basis. If set to "off" or "none" it cancels the value of a global repository.

<p>Copy makes a literal image of the master file at the destination,
checking whether the master is newer than the image. If the image needs
updating it is copied. Existing files are saved by appending
<code>.cfsaved</code> to the filename.

<br><dt><code>stealth</code>
<dd>If set to `on' causes cfengine to preserve atime and mtime
on source files during <em>local</em>
file copies. File times cannot be preserved on
remote copies. This option should normally only be used
together with a checksum copy, since preserving atime and mtime
implies changing ctime which will force continual copying. 
This is a weakness in the Unix file system. Ctime cannot be
preserved. Before version 1.5.0, there was a typo which
made this option active on many file copies.

<br><dt><code>timestamps</code>
<dd>If this is set to `preserve' or `keep', the times of the source
files are kept by the destination files during copying. This is
like the `p' option of the <code>tar</code> command.

<br><dt><code>recurse</code>
<dd>Specifies the depth of recursion when copying whole file-trees
recursively. The value may be a number or the keyword <code>inf</code>. 
Cfengine crosses device boundaries or mounted filesystems when
descending recursively through file trees. To prevent
this it is simplest to specify a maximum level of recursion.

<br><dt><code>symlink</code>
<dd>This option may be repeated a number of times to specify the
names of files, or wildcards which match files which are to
be symbolically linked instead of copied. A global list of
patterns can also be defined in the control section of the program
See <a href="#linkcopies">linkcopies</a>.

<br><dt><code>ignore</code>
<dd>This works like the global ignore directive but here you may
provide a private list of ignorable directories and files. 
Unlike include, exclude this affects the way cfengine parses
directory trees.

<br><dt><code>include</code>
<dd>This option may be repeated a number of times to specify the names of
files, or wildcards which match files which are to be included in a copy
operation. Specifying one of these automatically excludes everything
else except further include patterns.  A global list of patterns can
also be defined in the control section of the program.

<br><dt><code>exclude</code>
<dd>This option may be repeated a number of times to specify the
names of files, or wildcards which match files which are to
be excluded from a copy operation. A global list of
patterns can also be defined in the control section of the program
`excludes' override `includes'. 
See <a href="#excludelinks">excludelinks</a>.

<br><dt><code>type</code>
<dd>Normally cfengine uses the ctime date-stamps on files to determine
whether a file needs to be copied: a file is only copied if the master
is newer than the copy or if the copy doesn't exist. If the type is set
to <code>checksum</code> or <code>sum</code>, then a secure MD5 checksum is used to
determine whether the source and destination files are identical. If
<code>byte</code> or <code>binary</code> is specified, a byte by byte comparison is
initiated.  An <code>mtime</code> comparison does not take into account
changes of file permissions, only modifications to the contents of the
files.

<br><dt><code>server</code>
<dd>If you want to copy a file remotely from a server, you specify the
name of the server here. This must be the name of a host which is
running the <code>cfservd</code> daemon, and you must make sure that you
have defined the variable <code>domain</code> in the control section
of the <code>cfagent.conf</code> file. If you don't define a domain
you will probably receive an error of the form `cfengine: Hey! cannot
stat file'.

<br><dt><code>oldserver</code>
<dd>If this is true, cfengine uses the old protocol specification for
temporary compatibility with early version 2 alphas.

<br><dt><code>trustkey</code>
<dd>This option defaults to 'no' or 'false'. If set to true, cfagent will
accept a public key from a server whose public key is presently unknown
to the agent, on trust. This option should be used to bootstrap public
key transfer between hosts. Once a public key has been accepted, it will
not be replaced automatically. Dated public keys must be removed
by hand.

<br><dt><code>encrypt</code>
<dd>Has an effect only when used in conjuction with copy from a remote file
server.  This causes cfengine to use encryption and one-time keys on
transferred data.  (This requires RSA keys to be installed on both client
and server hosts, and provides strong authentication and encryption,
using random session keys.) The preferred algorithm is Blowfish, with a
128 bit key. Generally speaking the only case in which this function
makes sense is in transferring shadow password files.  Encrypting the
transfer of system binaries makes little sense. Note: the
encryption keys required to get files from cfservd are those for the
user under which cfservd is running (normally root).

<br><dt><code>verify</code>
<dd>If verify is true, cfagent attempts to verify the integrity of a remote
file transfer before the new file is installed. This takes time, since
an MD5 computation and transaction must take place.

<br><dt><code>size</code>
<dd>With this option you can specify that a file is only to be copied if the
source file meets a size critereon. This could be used to avoid
installing a corrupted file (the copying of an empty password file, for
instance). Sizes are in bytes by default, but may also be quoted in
kilobytes or megabytes using the notation:
<pre>
<var>number</var>bytes
<var>number</var>kbytes
<var>number</var>mbytes

</pre>

<p>Only the first characters of these strings are significant, so they may
be written however is convenient: e.g. <kbd>14kB</kbd>, <kbd>14k</kbd>,
<kbd>14kilobytes</kbd> etc. 
 Examples are:

<pre>
   size=&lt;400  # copy if file size is &lt; 400 bytes
   size=400   # copy if file size is equal to 400 bytes
   size=&gt;400  # copy if file size &gt; 400 bytes

</pre>

<br><dt><code>linktype</code>
<dd>This option determines the type of link used to make links. This only
applies if the file is linked rather than copied because it matches
a pattern set by <code>symlink</code>. The default type is a direct symbolic
link. The values <code>relative</code> or <code>absolute</code> may be used, but
hard links may not be created in place of copied files, since hard links
must normally reside on the same filesystem as their files, and it
is assumed that most links will be between filesystems. If this value
is set to <code>copy</code> or <code>none</code>, symbolic links will be replaced
by actual copies of the files they point to. Note that for directories,
this option is ignored.

<br><dt><code>typecheck</code>
<dd>Controls whether cfengine allows files of one type to overwrite files of
another type, i.e. switches on/off errors if source and existing
destination files do not match in type, e.g. if a file would overwrite a
directory or link. The default is on for safety reasons.

<br><dt><code>define</code>
<dd>This option is followed by a list of classes which are to be `switched on'
if and only if the named file was copied.  In multiple (recursive) copy
operations the classes become defined if any of the files in the file
tree were copied. This feature is useful for switching on other actions
which are to be performed after the installation of key files (e.g. 
package installation scripts etc).

<br><dt><code>purge</code>
<dd>If this option is set to true, cfengine will remove files in the
destination directory which are not also in the source directory.  This
allows exact images of filesystems to be mantained. Note that if the
copy command has includes or excludes or ignored files, cfengine will
purge only those files on the client machine which are also on the
server. This means that some files (such as system specific work files)
can be excluded from copies without them being destroyed. 
Note that purging is disallowed if contant with a remote server fails. 
This means that local files will not be destroyed by a denial of service
attack. <em>You should not use this option to synchronize NFS mounted
file systems. If the NFS server goes down, cfengine cannot then tell the
difference between a valid empty directory and a missing NFS file system. 
If you use purge, use a remote copy also.</em>

</dl>

<p>Example:

<pre>
copy:

      /local/etc/aliases dest=/etc/aliases m=644 o=root g=other
      /local/backup-etc  dest=/etc

   solaris::

      /local/etc/nsswitch.conf dest=/etc/nsswitch.conf

</pre>

<p>In the first example, a global aliases file is copied from the master
site file <code>/local/etc/aliases</code> to <code>/etc/aliases</code>, setting the
owner and protection as specified. The file gets installed if
<code>/etc/aliases</code> doesn't exist and updated if <code>/local/etc/aliases</code>
is newer than <code>/etc/aliases</code>. In the second example, <code>backup-etc</code>
is a directory containing master configuration files (for instance, <code>services</code>,
<code>aliases</code>, <code>passwd</code>...). Each of the files in <code>backup-etc</code>
is installed or updated under <code>/etc</code>. Finally, a global
<code>nsswitch.conf</code> file is kept up to date for solaris systems.

<p>The <code>home</code> directive can be used as a destination, in which
case cfengine will copy files to every user on the system. This is
handy for distributing setup files and keeping them updated:

<pre>
copy:

   /local/masterfiles/.cshrc  dest=home/.cshrc mode=0600

</pre>

<p>You can force the copying of files, regardless of the date stamps
by setting the option <code>force=true</code> or <code>force=on</code>. The default
is <code>force=false</code> or <code>force=off</code>.

<ul>
<li><a href="#hard%20links%20in%20copy">hard links in copy</a>: 
<li><a href="#Too%20many%20open%20files">Too many open files</a>: 
</ul>

<p><hr>
Node:<a name="hard%20links%20in%20copy">hard links in copy</a>,
Next:<a rel=next href="#Too%20many%20open%20files">Too many open files</a>,
Previous:<a rel=previous href="#copy">copy</a>,
Up:<a rel=up href="#copy">copy</a>
<br>

<h3>Hard links in copying</h3>

<p>Hard links are not like symbolic links, they are not merely pointers to
other files, but alternative names for the same file. The name of every
file is a hard link, the first so to speak. You can add additional names
which <em>really are</em> the file, they are not just pointers. For the
technically minded, they are not separate inodes, they are additional
directory references to the same inode.  When you perform a copy
operation on multiple files, cfengine attempts to preserve hard links
but this is a difficult task.

<p>Because a hard link just looks like an ordinary file (it cannot be
distingiushed from the original, the way a symbolic link can)
there is a danger that any copy operation will copy two hard links to
the same file as two separate copies of the same file. The difference
is that changes a hard-linked file propagate to the links, whereas
two copies of a file are completely independent thereafter. 
In order to faithfully reproduce all hardlinks to all files, cfengine
needs to examine every file on the same filesystem and check whether
they have the same inode-number. This would be an enourmous overhead, so it
is not done. Instead what happens is that cfengine keeps track of only
the files which it is asked to examine, for each atomic copy-command,
and makes a note of any repeated inodes within this restricted set. 
It does not try to go off, wandering around file systems looking to
other files which might be hardlinks.

<p>To summarize, cfengine preserves hardlinks during copying, only
within the scope of the present search. No backups are made of
hard links, only of the first link or name of the file is backed
up. This is a necessary precaution to avoid dangling references
in the inode table. As a general rule, hard links are to be avoided
because they are difficult to keep track of.

<p><hr>
Node:<a name="Too%20many%20open%20files">Too many open files</a>,
Previous:<a rel=previous href="#hard%20links%20in%20copy">hard links in copy</a>,
Up:<a rel=up href="#copy">copy</a>
<br>

<h3>Too many open files</h3>

<p>In long recursive copies, where you descend into many levels of diretories,
you can quickly run out of file descriptors. The number of file descriptors
is a resource which you can often set in the shell. It is a good idea
to set this limit to a large number on a host which will be copying
a lot of files. For instance, in the C shell you would write,

<pre>
limit descriptors 1024

</pre>

<p>Most systems should have adequate defaults for this parameter, but
on some systems it appears to be set to a low value such as 64, which is
not sufficient for large recursive tree searches.

<p><hr>
Node:<a name="defaultroute">defaultroute</a>,
Next:<a rel=next href="#disks">disks</a>,
Previous:<a rel=previous href="#copy">copy</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>defaultroute</h2>

<p>Dynamical routing is not configurable in cfengine, but for machines with
static routing tables it is useful to check that a default route is
configured to point to the nearest gateway or router.  The syntax for
this statement is simply:

<pre>
defaultroute:

   <var>class</var>::

      my_gateway

</pre>

<p>For example:

<pre>
defaultroute:

  most::

     129.240.22.1


  rest::

     small_gw

</pre>

<p>Gateways and routers usually have internet address <code>aaa.bbb.ccc.1</code>
-- i.e.  the first address on the subnet.  You may use the numerical
form or a hostname for the gateway.

<p><hr>
Node:<a name="disks">disks</a>,
Next:<a rel=next href="#directories">directories</a>,
Previous:<a rel=previous href="#defaultroute">defaultroute</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>disks</h2>

<p>This is a synonyn for <code>required</code>, See <a href="#required">required</a>. 
This action tests for the existence of a file or filesystem.  It should
be called after all NFS filesystems have been mounted.  You may use the
special variable <code>$(binserver)</code> here.

<pre>
  disks:

    /<var>filesystem</var> freespace=<var>size-limit</var> define=<var>class-list</var>(,:.)

     inform=<var>true</var> log=<var>true</var>

</pre>

<p>Files or filesystems which you consider to be essential to the operation
of the system can be declared as `required'.  Cfengine will warn
if such files are not found, or if they look funny.

<p>Suppose you mount your filesystem <code>/usr/local</code> via NFS from some
binary server.  You might want to check that this filesystem is not
empty! This might occur if the filesystem was actually <em>not</em>
mounted as expected, but failed for some reason.  It is therefore not
enough to check whether the directory <code>/usr/local</code> exists, one must
also check whether it contains anything sensible.

<p>Cfengine uses two variables: <code>sensiblesize</code> and
<code>sensiblecount</code> to figure out whether a file or filesystem is
sensible or not.  You can change the default values of these variables
(which are 1000 and 2 respectively) in the <code>control</code> section. 
See <a href="#control">control</a>.

<p>If a file is smaller than <code>sensiblesize</code> or does not exist, it
fails the `required' test.  If a directory does not exist, or contains
fewer than <code>sensiblecount</code> files, then it also fails the test and a
warning is issued.

<pre>
disks:

   any::

      /$(site)/$(binserver)/local

</pre>

<p>If you set the <code>freespace</code> variable to a value and set <code>inform=true</code>,
cfagent issues warnings when free disk space falls below this threshold. 
Any define-classes also become defined in this instance. 
(the default units are kilobytes,
but you may specify bytes or megabytes), e.g.

<p><hr>
Node:<a name="directories">directories</a>,
Next:<a rel=next href="#disable">disable</a>,
Previous:<a rel=previous href="#disks">disks</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>directories</h2>

<p>Directories declarations consist of a number of directories to be
created.  Directories and files may also be checked and created using
the <code>touch</code> option in the <code>files</code> actions.  See <a href="#files">files</a>.

<p>The form of a declaration is:

<pre>
  directories:

     <var>classes</var>::

         /<var>directory</var>
                         mode=<var>mode</var>
                         owner=<var>uid</var>
                         group=<var>gid</var>
                         define=<var>classlist</var>
                         syslog=<var>true/on</var>/<var>false/off</var>
                         inform=<var>true/on</var>/<var>false/off</var>

</pre>

<p>For example

<pre>
directories:

  <var>class</var>::

     /usr/local/bin  mode=755 owner=root group=wheel

</pre>

<p>The form of the command is similar to that of <code>files</code> but this
command is only used to create new directories.  Valid options are
<code>mode</code>, <code>owner</code>, <code>group</code> and are described under
<code>files</code> See <a href="#files">files</a>. This interface is only for convenience. 
It is strictly a part of the `files' functionality and is performed
together with other `files' actions at run time.

<p>The creation of a path will fail if one of the links in the path is a
plain file or device node.  A list of classes may optionally be defined
here if a directory is created.

<p><hr>
Node:<a name="disable">disable</a>,
Next:<a rel=next href="#editfiles">editfiles</a>,
Previous:<a rel=previous href="#directories">directories</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>disable</h2>

<p>Disabling a file means renaming it so that it becomes harmless.  This
feature is useful if you want to prevent certain dangerous files from
being around, but you don't want to delete them-- a deleted file cannot
be examined later.  The syntax is

<pre>
 disable:

   <var>class</var>::

      /<var>filename</var>
                      type=<var>plain/file/link/links</var>
                      rotate=<var>empty/truncate/numerical-value</var>
                      size=<var>numerical-value</var>
                      define=<var>classlist</var>
                      syslog=<var>true/on</var>/<b>false/off</b>
                      inform=<var>true/on</var>/<b>false/off</b>
                      repository=<var>destination directory</var>
                      action=<b>disable</b>/<var>warn</var>

</pre>

<p>Cfengine renames a given file by appending the name of the file with the
suffix <code>.cfdisabled</code>.  A typical example of a file you would
probably want to disable would be the <code>/etc/hosts.equiv</code> file which
is often found with the <code>+</code> symbol written in it, opening the
system concerned to the entire NIS universe without password protection! 
Here is an example:

<pre>
disable:

      /etc/hosts.equiv
      /etc/nologin
      /usr/lib/sendmail.fc

   sun4::

      /var/spool/cron/at.allow

</pre>

<p>Hint: The last example disables a file which restricts access to the
<code>at</code> utility.  Such a command could be followed by a file action,
See <a href="#files">files</a>,

<pre>files:

   some::

      /var/spool/cron/at.allow =0644 N [root] [wheel] touch

</pre>

<p>which would create an empty security file <code>at.allow</code>. 
See also your system manual pages for the <code>at</code> command if you don't
understand why this could be useful.

<p>Disabling a link deletes the link. If you wish you may use the
optional syntax

<pre>
disable:

    /directory/name type=file

</pre>

<p>to specify that a file object should only be disabled if it is a plain
file. The optional element <code>type=</code> can take the values
<code>plain</code>, <code>file</code>, <code>link</code> or <code>links</code>. If one of
these is specified, cfengine checks the type and only disables
the object if there is a match. This allows you to disable a file
and replace it by a link to another file for instance.

<p>NOTE that if you regularly disable a file which then gets recreated by
some process, the disabled file <code><var>filename</var>.cfdisabled</code> will
be overwritten each time cfengine disables the file and therefore the
contents of the original are lost each time. The <code>rotate</code> facility
was created for just this contingency.

<p>The disable feature can be used to control the size of system log files,
such as <code>/var/adm/messages</code> using a further option <code>rotate</code>. 
If the value rotate is set to 4, say,

<pre>
 disable:

    <var>filename</var>  rotate=4

</pre>

<p>then cfengine renames
the file concerned by appending `.1' to it and a new, empty file is
created in its place with the same owner and permissions. The next time
disable is executed `.1' is renamed to `.2' and the file
is renamed `.1' and a new empty file is created with the same
permissions. Cfengine continues to rotate the files like this
keeping a maximum of four files. This is similar to the behaviour
of syslog.

<p>If you simply want to empty the contents of a log file, without
retaining a copy then you can use <code>rotate=empty</code> or
<code>rotate=truncate</code>. For instance,
to keep control of your World Wide Web server logs:

<pre>disable:

   Sunday|Wednesday::

       /usr/local/httpd/logs/access_log  rotate=empty
</pre>

<p>This keeps a running log which is emptied each Sunday and Wednesday.

<p>The <code>size=</code> option in disable allows you to carry out a disable
operation only if the size of the file is less than, equal to or greater
than some specified size. Sizes are in bytes by default, but
may also be quoted in kilobytes or megabytes using the notation:
<pre>
<var>number</var>bytes
<var>number</var>kbytes
<var>number</var>mbytes

</pre>

<p>Only the first characters of these strings are significant, so they may
be written however is convenient: e.g. <kbd>14kB</kbd>, <kbd>14k</kbd>,
<kbd>14kilobytes</kbd> etc. 
 Examples are:

<pre>
   size=&lt;400  # disable if file size is &lt; 400 bytes
   size=400   # disable if file size is equal to 400 bytes
   size=&gt;400  # disable if file size &gt; 400 bytes

</pre>

<p>This options works with <code>rotate</code> or normal disabling; it is just
an extra condition which must be satisfied.

<p>If a disable command results in action being taken by cfengine, an optional
list of classes becomes can be switched on with the aid of a statement
<code>define=<var>classlist</var></code> in order to trigger knock-on actions.

<p>The <code>repository</code> declaration allows a local override of the
<code>Repository</code> variable, on an item by item basis. If set to "off" or
"none" it cancels the value of a global repository and leaves the disabled
file in the same directory.

<p><hr>
Node:<a name="editfiles">editfiles</a>,
Next:<a rel=next href="#files">files</a>,
Previous:<a rel=previous href="#disable">disable</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>editfiles</h2>

<p>Performs ascii (line-based) editing on text-files or limited binary
editing of files. 
If editing a file which has hard links to it, be aware that
editing the file will destroy the hard link references. This is also the
case with shell commands. You should avoid hard links whenever possible. 
The form of an editing command is
<code>editfiles</code> can also search directories recursively through directories
and edit all files matching a pattern, using <code>Include</code>, <code>Exclude</code>, and
<code>Ignore</code> (see Recursive File Sweeps in the tutorial).

<pre>
editfiles:

   <var>class</var>::

      { <var>file-to-be-edited</var>

      <var>action</var> "<var>quoted-string...</var>"
      }

      { <var>directory-to-be-edited</var>

      Recurse "inf"
      Filter  "filteralias"
      Include ".cshrc"
      Ignore  "bin"
      Ignore  ".netscape"
      <var>action</var> "<var>quoted-string...</var>"
      }

</pre>

<p>Here are some examples:

<pre>editfiles:

   sun4::

      { /etc/netmasks

      DeleteLinesContaining "255.255.254.0"
      AppendIfNoSuchLine "128.39  255.255.255.0"
      }

   PrintServers::
      { /etc/hosts.lpd

      AppendIfNoSuchLine "tor"
      AppendIfNoSuchLine "odin"
      AppendIfNoSuchLine "borg"
      }

</pre>

<p>The first of these affects the file <code>/etc/netmasks</code> on all SunOS 4
systems, deleting any lines containing the string "255.255.254.0" and
Appending a single line to the file containing "128.39 255.255.255.0"
if none exists already.  The second affects only hosts in the class
`PrintServers' and adds the names of three hosts: tor, odin and borg to
the file <code>/etc/hosts.lpd</code> which specifies that they are allowed to
connect to the printer services on any host in the class `PrintServers'.

<p>Note that single or double quotes may be used to enclose strings
in cfengine. If you use single quotes, your strings may contain
double quotes and vice-versa. Otherwise a double quoted string
may not currently contain double quotes and likewise for
single quoted strings.

<p>As of version 1.3.0, you can use the <code>home</code> directive in
edit filenames, enabling you to edit files for every user
on the system, provided they exist. For example, to edit
every user's login files, you would write

<pre>
  { home/.cshrc

   AppendIfNoSuchLine "setenv PRINTER default-printer"
   AppendIfNoSuchLine "set path = ( $path /new/directory )"
  }

</pre>

<p>If a user does not possess the named file, cfengine just skips
that user. A new file is not created.

<p>The meanings of the file-editing actions should be self-explanatory. 
Commands containing the word 'comment' are used to `comment out' certain
lines in a file rather than deleting them.  <code>Hash</code> implies a shell
comment of the type

<pre># comment
</pre>

<p><code>Slash</code> implies a comment of the C++ type:

<pre>// comment
</pre>

<p><code>Percent</code> implies a comment of the type:

<pre>% comment
</pre>

<p>More general comment types may be defined using the
<code>SetCommentStart</code>, <code>SetCommentEnd</code> and
<code>CommentLinesMatching</code>, <code>CommentLinesStarting</code>
functions.

<p>A special group of editing commands is based on the GNU Regular
Expression package. These use GNU regular expressions to search line by
line through text and perform various editing functions.  Some of these
commands are based on the concept of a file pointer. The pointer starts
at line one of the file and can be reset by 'locating' a certain line,
or by using the reset-pointer commands. The current position of the
pointer is used by commands such as <code>InsertLine</code> to allow a
flexible way of editing the middle of files.

<p>A simple decision mechanism is incorporated to allow certain editing
actions to be excluded. For instance, to insert a number of lines
in a file once only, you could write:

<pre>
   { <var>file</var>

    LocateLineMatching "<var>insert point...</var>"
    IncrementPointer   "1"

    BeginGroupIfNoMatch "# cfengine - 2/Jan/95"
      IncremenetPointer "-1"
      InsertLine "# cfengine - 2/Jan/95"
      InsertLine "/local/bin/start-xdm"

    EndGroup
   }

</pre>

<p>Since the first inserted line matches the predicate on subsequent calls,
the grouped lines will only be carried out once.

<p>The full list of editing actions is given below in alphabetical order. 
Note that some commands refer to regular expressions and some refer to
'literal strings' (i.e. any string which is not a regular
expression). Variable substitution is performed on all strings.  Be
aware that symbols such as <code>.</code>, <code>*</code> and so on are
meta-characters in regular expressions and a backslash must be used to
make them literal.  The regular expression matching functions are
POSIX extended regular expressions. 
See <a href="cfengine-Tutorial.html#Regular%20expressions">Regular expressions</a>.

<dl>

<br><dt><code>AbortAtLineMatching <var>quoted-regex</var></code>
<dd>This command sets the value of a regular expression. In all editing
operations (except <code>FixEndOfLine</code> and <code>GotoLastLine</code>) which involve multiple
replacements and searches, this expression marks a boundary
beyond which cfengine will cease to look any further. In other
words, if cfengine encounters a line matching this regular
expression, it aborts the current action. BE CAREFUL with this
feature: once set, the string remains set for the remainder of
the current file. It might therefore interact in unsuspected ways
with other search parameters. Editing actions are always aborted
as soon as the abort expression is matched. 
Use <code>UnsetAbort</code> to unset the feature.

<br><dt><code>Append <var>quoted-string</var></code>
<dd>Add a line containing the quoted string to the end of the file. 
This should be used in conjunction with the
decision structures <code>BeginGroupIfNoLineMatching</code> and
<code>BreakIfLineMatches</code>.

<br><dt><code>AppendIfNoSuchLine <var>quoted-string</var></code>
<dd>Add a line containing the quoted string to the end of the file
if the file doesn't contain the exact line already.

<br><dt><code>AppendIfNoLineMatching  <var>quoted-regex</var></code>
<dd>A new version of the older <code>AppendIfNoSuchLine</code>
which uses a regular expression instead of a literal
string. The line which gets appended must be set
previously using <code>SetLine</code>.

<br><dt><code>AppendToLineIfNotContains <var>quoted-string</var></code>
<dd>This commands looks for an exact match of the quoted string
in the current line. If the quoted string is not contained
in the line, it is appended. This may be used for adding
entries to a list.

<br><dt><code>AutoCreate</code>
<dd>If this command is listed anywhere in the file action list, cfengine
will create the named file if it doesn't exist. Normally cfengine issues
an error if the named file does not exist, but if this is set,
notification of the file's absence is only in verbose output. New files
are created with mode 644 (see also Umask), read access for everyone and write access for
the cfengine user (normally root). Note that if you set this,
BeginGroupIfFileIsNewer will always be true.

<br><dt><code>AutomountDirectResources <var>quoted-string</var></code>
<dd>This command is designed to assist with automounter configuration for
users wishing to use the automounter for NFS filesystems, but still use
the cfengine mount model. 
Applied to the current file, it is equivalent to saying: for each of the
mountable resources in the list See <a href="#mountables">mountables</a>, append if not found a
line for a direct automount map command, to the current file.  The
string which follows can be used to specify any special mount options
e.g. <code>"-nosuid"</code> for non setuid mounting (of all the
mountables). Note that this is added to the current file and not to a
file named <code>/etc/auto_direct</code>.

<br><dt><code>Backup <var>quoted-string</var></code>
<dd>Set to true or false, on or off to set inform level for this file. 
Default is on.

<br><dt><code>BeginGroupIfDefined <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted class is defined.

<br><dt><code>BeginGroupIfNotDefined <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted class is not defined.

<br><dt><code>BeginGroupIfFileExists <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted filename exists (can be statted). 
Files which are not readable by the running process are
for all intents and purposes non-existent.

<br><dt><code>BeginGroupIfFileIsNewer <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted filename is newer than the file being
edited.

<br><dt><code>BeginGroupIfNoLineContaining <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted string does not appear in
any line in the file.

<br><dt><code>BeginGroupIfNoLineMatching <var>quoted-regex</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted regular expression
does not match any line in the file.

<br><dt><code>BeginGroupIfNoMatch <var>quoted-regex</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted regular expression does
not match the current line.

<br><dt><code>BeginGroupIfNoSuchLine <var>quoted-string</var></code>
<dd>The lines following, up to the first <code>EndGroup</code>
are executed if the quoted literal string
does not match any line in the file.

<br><dt><code>BreakIfLineMatches  <var>quoted-regex</var></code>
<dd>Terminates further editing of the current
file if the current line matches the quoted
regular expression.

<br><dt><code>CatchAbort</code>
<dd>Edit actions which abort on failure (such as <code>LocateLineMatching</code>)
will jump to the first instance of this marker instead of completely
aborting an edit if this keyword occurs in an editing script. 
You can catch the exceptions thrown by the following commands:
<code>CommentNLines</code>,<code>CommentToLineMatching</code>,<code>DeleteNLines</code>,<code>DeleteToLineMatching</code>,
<code>HashCommentToLineMatching</code>,<code>IncrementPointer</code>,
<code>LocateLineMatching</code>,<code>PercentCommentToLineMatching</code>,
<code>RunScriptIf(No)LineMatching</code>,<code>UnCommentNLines</code>.

<br><dt><code>CommentLinesMatching  <var>quoted-regex</var></code>
<dd>Use the current value of the comment delimiters
set using <code>SetCommentStart</code> and <code>SetCommentEnd</code> to comment
out lines matching the given regular expression in quotes.

<br><dt><code>CommentLinesStarting  <var>quoted-string</var></code>
<dd>Use the current value of the comment delimiters
set using <code>SetCommentStart</code> and <code>SetCommentEnd</code> to comment
out lines starting with the quoted literal string.

<br><dt><code>CommentNLines <var>quoted-string</var></code>
<dd>Comments up to N lines from the current file, starting from the
location of the current line pointer. If the end of the file is reached
and less than N lines are deleted, a warning is issued, but
editing continues. The current value of the comment delimiters is
used to determine the method of commenting, (see <code>SetCommentStart</code>). 
After the operation the pointer points to the line after the
commented lines.

<br><dt><code>CommentToLineMatching  <var>quoted-regex</var></code>
<dd>Use the current value of the comment delimiters set using
<code>SetCommentStart</code> and <code>SetCommentEnd</code> to comment out lines
from the current position in a file to a line matching the given regular
expression in quotes.

<br><dt><code>DefineClasses "<var>class1</var>:<var>class2</var>:..."</code>
<dd>Activate the following colon, comma or dot-separated list of classes if
and only if the file is edited.

<br><dt><code>DeleteLinesAfterThisMatching <var>quoted-regex</var></code>
<dd>
<br><dt><code>DeleteLinesContaining <var>quoted-string</var></code>
<dd>Delete all lines containing the exact string quoted.

<br><dt><code>DeleteLinesMatching <var>quoted-regex</var></code>
<dd>Delete all lines matching the quoted regular expression.

<br><dt><code>DeleteLinesStarting <var>quoted-string</var></code>
<dd>Delete all lines beginning with the exact string quoted.

<br><dt><code>DeleteNLines <var>quoted-string</var></code>
<dd>Deletes up to N lines from the current file, starting from the
location of the current line pointer. If the end of the file is reached
and less than N lines are deleted, a warning is issued, but
editing continues.

<br><dt><code>DeleteToLineMatching <var>quoted-regex</var></code>
<dd>Delete lines from the current position, up to
but not including a line matching the regular expression
in the quoted string. If no line matches the
given expression, a warning is only printed in
verbose mode, but all edits are immediately
abandoned.

<br><dt><code>EditMode "Binary"</code>
<dd>If set to binary, the file will be edited as if it were a non-ASCII file. 
See discussion below.
<pre>   EditMode "Binary"
</pre>

<br><dt><code>EmptyEntireFilePlease</code>
<dd>Deletes all lines from the current file.

<br><dt><code>ElseDefineClasses</code>
<dd>See <code>DefineClasses</code>

<br><dt><code>EndGroup</code>
<dd>Terminates a begin-end conditional structure.

<br><dt><code>EndLoop</code>
<dd>Terminates a loop. See <code>ForEachLineIn</code>

<br><dt><code>Filter <var>filteralias</var></code>
<dd>Name a fiter for pruning file searches.

<br><dt><code>FixEndOfLine</code>
<dd>The quoted string which follows may be either <code>dos</code>
or <code>Unix</code> to fix the end of line character conventions
to match these systems. This command should be executed
last of all, since cfengine appends new lines with the conventions
of the system on which is was complied during edit operations.

<br><dt><code>ForEachLineIn <var>quoted-filename</var></code>
<dd>This marks the beginning of a for-loop which reads successive
lines from a named file. The result is like using <code>SetLine</code>
for each line in the file. Nested loops are not permitted.

<br><dt><code>GotoLastLine</code>
<dd>Moves the file pointer to the last line in
the current file.

<br><dt><code>HashCommentLinesContaining <var>quoted-string</var></code>
<dd>Add a <code>#</code> to the start of any line containing the quoted string.

<br><dt><code>HashCommentLinesMatching <var>quoted-regex</var></code>
<dd>Add a <code>#</code> to the start of any line exactly matching the quoted regular expression.

<br><dt><code>HashCommentLinesStarting <var>quoted-string</var></code>
<dd>Add a <code>#</code> to the start of any line starting with the quoted string.

<br><dt><code>IncrementPointer <var>quoted-number</var></code>
<dd>Increments the value (in lines) of the file pointer
by the number of lines specified in the quoted
string (as a denary number). e.g. <code>"4"</code>. 
Negative values are equivalent to decrementing the
pointer. If a request is made to increment/decrement
outside of the file boundaries the pointer `bumps'
into the boundary and remains there, i.e. either at
start of file or end of file.

<br><dt><code>Inform <var>quoted-string</var></code>
<dd>Set to true or false, on or off to set inform level for this file. 
Default is off.

<br><dt><code>InsertFile <var>quoted-string</var></code>
<dd>Inserts the named file after the current line position
in the file. This should be used in conjunction
with a begin-end construction in order to avoid
including the file every time cfengine is run. 
If the file does not exist, or cannot be opened,
there is only a warning issued in verbose mode. 
Note if the file is empty, or if the current line
pointer is not set, the file is inserted at the start
of the file.

<br><dt><code>InsertLine <var>quoted-string</var></code>
<dd>Inserts the quoted string as a line at the current
position in the file. After the insert, the file
pointer is incremented by one so that subsequent
inserted lines are placed after the first. 
This should probably be used in conjunction with the
conditional begin-end tests to avoid lines being
inserted on every run.

<br><dt><code>LocateLineMatching <var>quoted-regex</var></code>
<dd>Moves the current-position pointer to the start
of the line matching the quoted regular expression. 
If there is no match, a warning is only issued in
verbose mode, but all editing is immediately
aborted. See also <code>WarnIfNoLineMatching</code>
so that you can get an explicit warning, even
out of verbose mode.

<br><dt><code>PercentCommentLinesContaining <var>quoted-string</var></code>
<dd>Add a <code>%</code> to the start of any line containing the quoted string.

<br><dt><code>PercentCommentLinesMatching <var>quoted-regex</var></code>
<dd>Add a <code>%</code> to the start of any line exactly matching the quoted regular.

<br><dt><code>PercentCommentLinesStarting <var>quoted-string</var></code>
<dd>Add a <code>%</code> to the start of any line starting with the quoted string.

<br><dt><code>Prepend <var>quoted-string</var></code>
<dd>Add a line containing the quoted string to the start of the file. 
This should be used in conjunction with the
decision structures <code>BeginGroupIfNoLineMatching</code> and
<code>BreakIfLineMatches</code>.

<br><dt><code>PrependIfNoLineMatching <var>quoted-regex</var></code>
<dd>A new version of the older <code>PrependIfNoSuchLine</code>
with uses a regular expression instead of a literal string. 
The string prepended is the one set using <code>SetLine</code>.

<br><dt><code>PrependIfNoSuchLine <var>quoted-string</var></code>
<dd>Add a line containing the quoted string to the start of the file
if the file doesn't contain the exact line already.

<br><dt><code>Recurse <var>digit/inf</var></code>
<dd>For recursive descents when editing whole file trees.

<br><dt><code>ReplaceLineWith <var>quoted-string</var></code>
<dd>Replace the line at the current position with the
text in the quoted string. The file pointer remains
pointing to this line after the change.

<br><dt><code>ReplaceAll <var>quoted-regex</var> With <var>quoted-string</var></code>
<dd>Replace all instances of strings matching the regular expression in the
first quotes with the exact string in the second set of quotes,
throughout the current file. Note that cfengine matches on a left to
right basis, with the first match taking precedence, so if your regular
expression matches text ambiguously it is the first occurrence which is
replaced. For example, if you replace <code>cf.*</code> with <code>CFENGINE</code>
and cfengine encounters a line <code>hello cfengine cfengine</code>, then this
will be replaced with <code>hello CFENGINE</code> even though two possible
strings match the regular expression. On the other hand if the
expression is not ambiguous, say replacing <code>cfengine</code> with
<code>CFENGINE</code>, then the result would be <code>hello CFENGINE CFENGINE</code>.

<br><dt><code>ReplaceLinesMatchingField <var>quoted-number</var></code>
<dd>This command replaces any lines in the current file with the current line
set by <code>SetLine</code> or <code>ForEachLineIn</code>, if the lines
are split into fields (e.g. the password file) separated by the
<code>SplitOn</code> character (':' by default), and the corresponding
fields match.

<p>The idea behind this command was to be able to override global
passwords (from a file which gets distributed) by new passwords
in a local file. Rather than maintaining the files separately,
this simply overrides the entries with the new ones.

<br><dt><code>Repository <var>quoted string</var></code>
<dd>This allows a local override of the <code>Repository</code> variable, on an item
by item basis. If set to "off" or "none" it cancels the value of a global repository.

<br><dt><code>ResetSearch <var>quoted-string</var></code>
<dd>Sets the current-position pointer to the line number
in the quoted string. <code>EOF</code> indicates the end of
the file.

<br><dt><code>RunScript <var>quoted-string</var></code>
<dd>Executes the named script command. Before executing the script any edits
are saved to disk. After the script has executed,
cfengine reloads the file for any further editing
operations. The script (which may be any executable
program) is appended with two arguments: the name of the
file which is being edited and the system hard class
(e.g. sun4, ultrix etc.) of the system executing
the script.

<p>CAUTION: cfengine knows nothing about
the success or failure of anything that is done during the
execution of user scripts. This feature is to be
used at the users own peril!

<br><dt><code>RunScriptIfLineMatching <var>quoted-string</var></code>
<dd>Executes the script named with the <code>SetScript</code>
command only if the current file contains a line matching
the quoted regular expression.

<p>CAUTION: cfengine knows nothing about
the success or failure of anything that is done during the
execution of user scripts. This feature is to be
used at the users own peril!

<br><dt><code>RunScriptIfNoLineMatching <var>quoted-regex</var></code>
<dd>Executes the script named with the <code>SetScript</code>
command if the current file contains no line matching
the quoted regular expression.

<p>CAUTION: cfengine knows nothing about
the success or failure of anything that is done during the
execution of user scripts. This feature is to be
used at the users own peril!

<br><dt><code>SetCommentStart <var>quoted-string</var></code>
<dd>Specify which string should be used for starting
a comment using the commands <code>CommentLineMatching</code>
and <code>CommentLineStarting</code>. The default is the hash
symbol <code>#</code> followed by a single space.

<br><dt><code>SetCommentEnd  <var>quoted-string</var></code>
<dd>Specify which string should be used for ending
a comment using the commands <code>CommentLineMatching</code>
and <code>CommentLineStarting</code>. The default is the empty
string. For example, you could make C style comments
by setting CommentStart to <code>/*</code> and comment
end to <code>*/</code>.

<br><dt><code>SetLine <var>quoted-string</var></code>
<dd>
Sets a current line value which can be appended using
<code>AppendIfNoLineMatching</code> using a regular expression.

<br><dt><code>SetScript <var>quoted-string</var></code>
<dd>Sets the name of a user-supplied script
for editing the current file.

<br><dt><code>SlashCommentLinesContaining <var>quoted-string</var></code>
<dd>Add a <code>//</code> to the start of any line containing the quoted string.

<br><dt><code>SlashCommentLinesMatching <var>quoted-regex</var></code>
<dd>Add a <code>//</code> to the start of any line exactly matching the quoted regular expression.

<br><dt><code>SlashCommentLinesStarting <var>quoted-string</var></code>
<dd>Add a <code>//</code> to the start of any line starting with the quoted string.

<br><dt><code>SplitOn <var>quoted-string</var></code>
<dd>This defines a single character which is to be interpreted as a
field separator for editing files with columns. The default value
for this is <code>:</code>, as is used in the password and group files. 
It is used in conjunction with <code>ReplaceLinesMatchingField</code>.

<br><dt><code>Syslog <var>quoted-string</var></code>
<dd>Set to true or false, on or off to set inform level for this file. 
Default is off.

<br><dt><code>Umask <var>quote mode</var></code>
<dd>Set local umask for file creation and script execution.

<br><dt><code>UnCommentLinesContaining  <var>quoted-string</var></code>
<dd>Uncomment all lines in file containing the quoted string as a
substring. The comment delimiters are assumed to be those
set using SetCommentStart and SetCommentEnd.

<br><dt><code>UnCommentLinesMatching  <var>quoted-regex</var></code>
<dd>Uncomment all lines in file matching the quoted regular expression.  The
comment delimiters are assumed to be those set using SetCommentStart and
SetCommentEnd.

<br><dt><code>UnCommentNLines <var>quoted-string</var></code>
<dd>Uncomments N lines starting from the current position, using
the currently defined method for commenting. Note that the
comment start and end symbols are removed independently, i.e. 
they are not matched, so that a comment may be spread over
several lines. e.g. If using C style <code>/*</code> and <code>*/</code>
comments, the command <code>UnCommentNLines "3"</code> would
uncomment
<pre> /* 1 */
 /* 2 */
 /* 3 */
</pre>

<p>and also
<pre> /* 1
    2
    3 */
</pre>

<br><dt><code>UnsetAbort  <var>quoted-string</var></code>
<dd>Switches off the feature <code>AbortAtLineMatching</code>.

<br><dt><code>UseShell "false"</code>
<dd>Normally cfengine uses a shell based exec function to run
scripts during editing. This involves the inheritance of
environment variables and path, which carries with it an
inherent security risk. Setting this value to false
causes execution to execute without an encapsulating shell.

<br><dt><code>WarnIfLineContaining <var>quoted-string</var></code>
<dd>Issue a warning if the quoted string is found as a
substring of one or more lines in the file.

<br><dt><code>WarnIfLineMatching <var>quoted-regex</var></code>
<dd>Issue a warning if the quoted regular expression
matches one or more lines in the file.

<br><dt><code>WarnIfLineStarting <var>quoted-string</var></code>
<dd>Issue a warning if the quoted string matches the start
of one or more lines in the file.

<br><dt><code>WarnIfNoLineContaining <var>quoted-string</var></code>
<dd>Issue a warning if the quoted string is not contained
in one or more lines in the file.

<br><dt><code>WarnIfNoLineMatching <var>reg-ex</var></code>
<dd>Issue a warning if the quoted regular expression does not match
one or more lines in the file.

<br><dt><code>WarnIfNoLineStarting <var>quoted-string</var></code>
<dd>Issue a warning if the quoted string is not found
at the start of one or more lines in the file.

<br><dt><code>WarnIfNoSuchLine <var>quoted-regex</var></code>
<dd>Issue a warning if the quoted regular expression does not
match one or more lines in the file.

</dl>

<p>A limited number of operations can also be performed on purely binary files, e.g. 
compiled programs, in order to search for strings or viral code, or to modify
strings within a program. Binary mode is a mutually exclusive, separate mode to normal
editing. The limit on the size of binary files is set by <code>editbinaryfilesize</code>
in <code>control</code>.
<dl>

<br><dt><code>ReplaceAll <var>regex</var> With <var>literal</var></code>
<dd>
Replaces occurrences of the matched regular expression with\
the provided literal text, only if the length of the literal substitute
is less than or equal to the length of the located string. If the
replacement string is shorter, it is padded with ascii spaces (character 32) by default. 
The padding character can be changed by setting <code>BinaryPaddingChar</code> in <code>control</code>. 
Padding with a null byte would lead to corruption of text within a program.

<br><dt><code>WarnIfContainsString <var>regex/literal</var></code>
<dd>Yields a warning if the literal string or regular expression matches. 
Cfengine first attempts a literal match and then a regular expression
match.

<br><dt><code>WarnIfContainsFile <var>filename</var></code>
<dd>Yields a warning if the contents of the named file exactly match
part of the file which is being edited. This can be used to search for
binary data which cannot be typed directly into the cfengine program,
e.g. virus signatures.

</dl>

<p>It is suggested that you use these editing functions with
caution. Although all possible safeguards have been incorporated into
them, it is still possible through carelessness to do damage to
important files on your system. Always test editing programs carefully
before committing them to your global site configuration.

<p><hr>
Node:<a name="files">files</a>,
Next:<a rel=next href="#filters">filters</a>,
Previous:<a rel=previous href="#editfiles">editfiles</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>files</h2>

<p>The <code>files</code> facility allows you to touch (create), check for the
existence, owner and permissions of files, change the permissions and
test for setuid root programs.

<ul>
<li><a href="#Syntax">Syntax</a>: 
<li><a href="#Recursion">Recursion</a>: 
<li><a href="#Directory%20permissions">Directory permissions</a>: 
<li><a href="#home%20directive">home directive</a>: 
<li><a href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>: 
<li><a href="#Files%20linkchildren">Files linkchildren</a>: 
<li><a href="#touch">touch</a>: 
<li><a href="#create">create</a>: 
</ul>

<p><hr>
Node:<a name="Syntax">Syntax</a>,
Next:<a rel=next href="#Recursion">Recursion</a>,
Previous:<a rel=previous href="#files">files</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>Syntax</h3>

<p>A files-statement can have several options.  We can begin by examining
the form of the statement in pseudo-code:

<pre>  files:

     <var>classes</var>::

        /<var>file-object</var>
                          mode=<var>mode</var>
                          owner=<var>uid-list</var>
                          group=<var>gid-list</var>
                          action=<var>fixall/other-options</var>/<b>warnall</b>
                          links=<b>false/stop</b><var>/traverse/follow/tidy</var>

                          ignore=<var>pattern</var>
                          include=<var>pattern</var>
                          exclude=<var>pattern</var>
                          filter=<var>filter alias</var>

                          define=<var>classlist</var>
                          elsedefine=<var>classlist</var>

                          checksum=<var>md5</var>
                          flags=<var>BSD flags</var>
                          syslog=<var>true/on</var>/<var>false/off</var>
                          inform=<var>true/on</var>/<var>false/off</var>

</pre>

<p>An example would be the following:

<pre>   any::

      /var/spool/printQ  mode=0775  r=0 o=daemon g=daemon  act=fixdirs

</pre>

<p>The meaning of these item is sketched out below and becomes clearer on
looking at a number of examples.  Note that, each of the options below
can be written in either upper or lower case and abbreviated by any
unique abbreviation. 
A file object is interpreted as a directory if you write it in the
following form: <code>/directory-path/.</code>. i.e. a trailing dot signifies
a directory. This then becomes the same as the <code>directory</code> command.

<dl>

<br><dt><code><var>/directory</var></code>
<dd>This is the only obligatory part of a file action.  This is a directory
at which a file search should begin.  This may be a single file or a
directory.  The recursion specifier may be used to force cfengine to
descend into subdirectories in a controlled fashion, starting from this
point, checking files there also.  The wildcard <code>home</code> may also be
used.  See <a href="#home%20directive">home directive</a>.

<br><dt><code>mode=<var>modestring</var></code>
<dd>Specifies what the allowed permissions for files are.  If cfengine finds
that a file's mode is incorrect, the value of the <code>action</code>
option determines what will be done about it.  The modestring should
consist of either a three digit octal numbers with <code>+</code>, <code>-</code> or
<code>=</code> symbols, or a text string like that used by the command
<code>chmod</code>.  For instance: <code>mode=u=rwx,og+rx</code> would mean set the
read/write and execute flags for the user (file owner) and add the
read/execute flags for others and group bits.  An example of the
numerical form might be <code>-002</code> which would mean that the
read-for-others flag should either not be set or should be unset,
depending on the action you choose.  <code>+2000</code> would mean that the
setuid flag should be present or set, depending on the action. 
<code>+2000,-002</code> would be a combination of these.  The <code>=</code> sign
sets to an absolute value, so <code>=755</code> would set the file mode to
mode 755.

<br><dt><code>flags=<var>BSD flags</var></code>
<dd>The free BSD Unices have additional filesystem flags which can be seton
files.  Refer to the BSD <code>chflags</code> documentation for this.  For
example,
<pre>
   /tmp/flags.01  mode=0600 owner=0 group=0
                  flags=uappnd,uchg,uunlnk,nodump,opaque,sappnd,schg,sunlnk
                  action=touch

</pre>

<br><dt><code>recurse=<var>number/inf</var></code>
<dd>This specifier tells cfengine whether or not to recurse into
subdirectories.  If the value is zero, only the named file or directory
is affected.  If the value is 1, it will open at most one level of
subdirectory and affect the files within this scope.  If the value is
<code>inf</code> then cfengine opens all subdirectories and files beginning
from the specified filename.See <a href="#Recursion">Recursion</a>.

<br><dt><code>owner=<var>owner list</var></code>
<dd>This is a list of allowed owners, or uids by number, separated by
commas.  For example <code>root,2,3,sysadm</code>.  In cases where you ask
cfengine to fix the ownership automatically, the owner will be set to
the first owner in the list if and only if it is not one of the named
uids in the list.

<br><dt><code>group=<var>group list</var></code>
<dd>This is a list of allowed groups, or gids by number, separated by
commas.  For example <code>wheel,2,3,sysadm</code>.  In cases where you ask
cfengine to fix the ownership automatically, the group will be set to
the first group in the list if and only if it is not one of the named
gids in the list.

<br><dt><code>action=<var>action</var></code>
<dd>The action is one of the following keywords.
<pre>warnall warndirs warnplain
 fixall fixdirs fixplain
touch linkchildren create compress alert
</pre>

<p>The upper line results only in warnings being issued.  The actions
beginning `fix' prompt cfengine to fix encountered problems without
bothering the user.  No message is issued unless in verbose mode.  The
special features on the third line will be explained separately.  Alert
is like <code>-print</code> in the find command, it triggers on the existence
of files which have not been ignored, excluded or filtered. This should
normally be used together <code>filter</code>, in order to locate files of particular types.

<br><dt><code>include=<var>wildcard/pattern</var></code>
<dd>You can include this option several times to specify specific patterns
which are to be included in the search. Once you specify one
pattern you exclude all files not matching at least one of the
patterns. The case be useful for restricting a search, or for
modifying the permissions of only certain files.

<br><dt><code>exclude=<var>wildcard/pattern</var></code>
<dd>You can include this option several times to specify specific patterns
which are to be excluded from the search. This overrides any patterns
given in the <code>include=</code> list.

<br><dt><code>ignore</code>
<dd>This works like the global ignore directive but here you may
provide a private list of ignorable directories and files. 
Unlike include, exclude this affects the way cfengine parses
directory trees.

<br><dt><code>links=<var>stop/traverse/tidy</var></code>
<dd>Normally cfengine does not descend into subdirectories which are pointed
to by symbolic links.  If you wish to force it to do so (without using
the <code>-l</code> command line option) you may give this option the value
<code>true</code>, or <code>traverse</code>, or <code>follow</code>.  To specify no
recursion you set the value <code>false</code> or <code>stop</code>. 
Note that the value set here in the cfengine program <em>always
overrides</em> the value set by the <code>-l</code> command line option, so you
can protect certain actions from this command line option by specifying
a negative value here.  If you specify no value here, the behaviour is
determined by what you specify on the command line.

<p>The value <code>links=tidy</code> has the same effect as the <code>-L</code> command
line option except that here it may be specified per item rather than
globally.  Setting this value causes links which point to non-existent
files to be deleted.

<p>If the warn directive is used (for directories, plain files or both)
then only a warning message is issued if the file being tested does not
match the specification given.  If the fix directives are used then
cfengine does not issue a warning, it simply fixes the value silently. 
Non-existent files are created by the <code>touch</code> command.  A
directory may be touched (created) by writing the filename
<code>/a/b/c/.</code> with a dot as the last character.  (This may also be
achieved with the <code>directories</code> directive, See <a href="#directories">directories</a>.)

<br><dt><code>define=<var>classlist</var></code>
<dd>If a file operation results in action being taken to fix a file,
the colon, comma or dot separated list of classes becomes defined. 
Warnings do not activate the classes.

<br><dt><code>checksum=<var>md5/sha</var></code>
<dd>If set this option causes cfengine to add a checksum for the named file
to a database. Changes in the value of this checksum are then warned as
a security issue. This should normally only be used to monitor binary
files which one would not expect to change often. Note also that the use
of this option can mean a significant performance penalty. The variable
<code>ChecksumDatabase</code> should be set in <code>control:</code> to the filename
of a database file which is used to cache checksum values. Note that it
is also possible to use a database file for cfservd's remote copying by
checksum.  If you use the same file for both purposes you risk losing
warnings.  Security warning messages are issued only once and the value
in the database is then changed to the new value of the file
automatically i.e. the behaviour is similar to that of setuid root
program detection, See <a href="#ChecksumDatabase">ChecksumDatabase</a>.

</dl>

<p>The default values are <code>mode=+000</code>, <code>recurse=0</code>,
<code>action=warnall</code> and any owner or group is acceptable.  The default
for <code>links</code> is to not traverse links unless the <code>-l</code> option is
set on the command line.

<p><hr>
Node:<a name="Recursion">Recursion</a>,
Next:<a rel=next href="#Directory%20permissions">Directory permissions</a>,
Previous:<a rel=previous href="#Syntax">Syntax</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>Recursion</h3>

<p>The recursion specifier tells cfengine what to do, starting from
<code>/directory name</code>.  A value of <code>r=0</code> means `no recursion' and
any checking is limited only to the named file or directory.  A value of
<code>r=inf</code> implies unlimited recursion.  Cfengine then descends into
all subdirectories checking or setting the permissions of files until it
`bottoms out' at a plain file.  A value such as <code>R=4</code> means descend
recursively into subdirectories, but no more than four levels.  This is
a useful safety net in preventing unforeseen accidents.  A recursive
search also bottoms out on device boundaries and symbolic links
(provided the <kbd>-l</kbd> option is not used).

<p><hr>
Node:<a name="Directory%20permissions">Directory permissions</a>,
Next:<a rel=next href="#home%20directive">home directive</a>,
Previous:<a rel=previous href="#Recursion">Recursion</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>Directory permissions</h3>

<p>When you specify the permissions for a whole file tree, using the
recursion specifier it is awkward to have to remember that directories
must be executable.  cfengine will do this for you automatically.  If
you specify that a file tree is to have a read flag set, cfengine will
ensure that the corresponding execute flag is also set for directories
which live in the tree.  So the command

<pre>files:

  myclass::

      /dir  mode=a+rw r=inf fixall

</pre>

<p>would set all plain files to mode 644 and all directories to 755, that
is read/write for everyone on plain files and read/write/execute for
everyone on directories.

<p><hr>
Node:<a name="home%20directive">home directive</a>,
Next:<a rel=next href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>,
Previous:<a rel=previous href="#Directory%20permissions">Directory permissions</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3><code>home</code> directive</h3>

<p>If you want to check the files of all the users who have their login
areas on the current host, you can use a wildcard directive <code>home</code>
instead of a directory name.  In this case the file action iterates over
all home directories physically on the current host.  The home
directories are, of course, located by searching for files which match

<pre>$(mountpattern)/$(homepattern)
</pre>

<p>i.e.  the values which are specified in the <code>control</code> part of the
program.  For example the following line is a very useful service to
ignorant users.

<pre>files:

  any::

    home mode=o-w r=inf act=fixall

</pre>

<p>It ensures automatically that no user has files which can be written to
by other arbitrary users.

<p>As a corollary to this, you may write something like
<pre>
  any::

     home/www mode=a+r fixall

</pre>

<p>to specify a special subdirectory of every users' home directory.  This
statement would check that all of the files in users' world wide web
directories were readable for everyone.

<p><hr>
Node:<a name="Owner%20and%20group%20wildcards">Owner and group wildcards</a>,
Next:<a rel=next href="#Files%20linkchildren">Files linkchildren</a>,
Previous:<a rel=previous href="#home%20directive">home directive</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>Owner and group wildcards</h3>

<p>If you do not want to explicitly state the owner or group of a file you
may simply omit the group or owner options.

<pre>
  /<var>file-object</var> m=0664 r=inf

</pre>
This example generate a warning if any files under the named directory
do not have permission read/write for all users.

<p><hr>
Node:<a name="Files%20linkchildren">Files linkchildren</a>,
Next:<a rel=next href="#touch">touch</a>,
Previous:<a rel=previous href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>Files linkchildren</h3>

<p>The <code>linkchildren</code> facility is almost identical to that already
described under <code>links</code>.  See <a href="#Link%20Children">Link Children</a>.  The only
difference here is that the ownership and permissions on the links are
set all in one operation.  For example:

<pre><var>myclass</var>::

   /local/lib/emacs m=0770 o=me g=mygroup act=linkchildren

</pre>

<p><hr>
Node:<a name="touch">touch</a>,
Next:<a rel=next href="#create">create</a>,
Previous:<a rel=previous href="#Files%20linkchildren">Files linkchildren</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>touch</h3>

<p>The <code>touch</code> facility creates a new file with the
specified permissions and ownership, or corrects the
permissions and ownership of an existing file, in addition
to updating the time stamps.

<pre><var>myclass</var>::

   /<var>newfile</var> mode=0644 action=touch

</pre>

<p><hr>
Node:<a name="create">create</a>,
Previous:<a rel=previous href="#touch">touch</a>,
Up:<a rel=up href="#files">files</a>
<br>

<h3>create</h3>

<p>This is like <code>touch</code> except that an existing
file's time stamps, permissions and ownership will not be modified
if the file already exists. If the file does not exist, the
attributes are set to the values specified, or to the default
values of <code>0644</code>.

<p><hr>
Node:<a name="filters">filters</a>,
Next:<a rel=next href="#groups">groups</a>,
Previous:<a rel=previous href="#files">files</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>filters</h2>

<p>A filter is a way of selecting or pruning during a search over
files or processes. Since filter rules could apply to several objects, cfengine
allows you to define filter conditions as separate objects to be
applied in different contexts.

<p>Filter objects can be used in <code>copy</code>, <code>editfiles</code>,
<code>files</code>, <code>tidy</code> and <code>processes</code>. In most cases one
writes
<pre>.. filter=&lt;i&gt;filteralias&lt;/i&gt;
</pre>
in the appropriate command. The exception is <code>editfiles</code>, where the syntax
is
<pre>{
..
Filter "filteralias"
..
}
</pre>
Example:

<pre>
files:

 /tmp filter=testfilteralias action=alert r=inf

</pre>

<p>Filters are defined in a separate section. Filters for files
and processes are defined together. They differ only in the
criteria they contain. Here is are examples of file filters:
<pre>Filters:

  { filteralias1

  Owner:     "mark|cell|motd"
  Group:     "ecg|mark"
  Mode:      "700"

  FromCtime: "date(2000,1,1,0,0,0)"    # absolute date
  ToCtime:   "now"

  FromMtime: "tminus(1,0,0,2,30,0)"    # relative "ago" from now
  ToMtime:   "inf"                     # end of time

  FromAtime: "date(1997,2,22,0,0,0)"
  ToAtime:   "inf"

  FromSize:  "10000"                   # File size interval
  ToSize:    "10mb"

  ExecRegex: "/usr/bin/file(.*ascii.*)"# Result from "files" command

  Type:      "dir|link"                # reg|link|dir|socket|fifo|door|char|block

  NameRegex: ".*.asc"                  # regex matching file name

  IsSymLinkTo: "/dev/null"             # True if file is a link to object name regex

  Result:    "Type"                    # Result which shouldbe returned

  }

 #########################################

  { testfilteralias2

  ExecProgram: "/bin/ls $(this)"       # True if the program returns true. $(this) is the current object
  }

 #########################################

  { testfilteralias3

  Owner: "mark"
  }
</pre>

<p>Filters are evaluated like classes. In fact, the filtering works by evaluating
the class attributes for each file.

<p>File filters:

<dl>
<dt><code>Owner:</code>
<dd> and Group can use numerical id's or
names, or <code>"none"</code> for users or groups which are undefined in
the system passwd/group file.

<br><dt><code></code>
<dd>Mode: applies only to file objects. It shares syntax with
the <code>mode=</code> strings in the files command. This test returns
true if the bits which are specified as `should be set' are indeed
set, and those which are specified as `should not be set' are not set.

<br><dt><code>Atime:,Ctime:,Mtime:</code>
<dd>apply only to file objects. 
These specify ranges From and To. If the file's time stamps
lie in the specified range, this returns true. Times are
specfied by a six component vector
<pre>(year,month,day,hour,minutes,seconds)
</pre>
This may be evaluated as two functions: date() or tminus()
which give absolute times and times relative to the current time respectively. 
In addition, the words now and inf may be used. 
e.g.

<pre>  FromCtime: "date(2000,1,1,0,0,0)"   # absolute date
  ToCtime:   "now"

  FromMtime: "tminus(1,0,0,2,30,0)"     # relative "ago" from now
  ToMtime:   "inf"                     # end of time
</pre>

<br><dt><code>Type:</code>
<dd>applies only to file objects may be a list of file types
which are to be matched. The list should be separated by the OR symbol
`|', since these types are mutually exclusive. The possible values are
currently
<pre>reg|link|dir|socket|fifo|door|char|block
</pre>
<br><dt><code>ExecRegex:</code>
<dd>matches the test string against the output of the specified command. 
<br><dt><code>NameRegex:</code>
<dd>matches the name of the file with a regular expression. 
<br><dt><code>IsSymLinkTo:</code>
<dd>applies only when the file object $(this) is a symbolic link. It is true
if the regular expression matches the contents of the link. 
<br><dt><code>ExecProgram:</code>
<dd>matches if the command returns successfully (with return code 0). 
Note that this feature introduces an implicit dependency on the command being
called. This might be exploitable as a security weakness by advanced intruders. 
<br><dt><code>Result:</code>
<dd>specifies the way in which the above elements are combined
into a single filter. 
</dl>

<p>Process filters:

<dl>
<dt><code>Owner</code>
<dd> process owner UID (quoted regex)
<br><dt><code>PID:</code>
<dd> process ID (quoted regex)
<br><dt><code>PPID:</code>
<dd> parent process ID (quoted regex)
<br><dt><code>PGID:</code>
<dd> process group ID (quoted regex)
<br><dt><code>RSize:</code>
<dd> resident size (quoted regex)
<br><dt><code>VSize:</code>
<dd> virtual memory size (quoted regex)
<br><dt><code>Status:</code>
<dd> status (quoted regex)
<br><dt><code>Command:</code>
<dd> CMD or COMMAND fields (quoted regex)
<br><dt><code>(From/To)TTime:</code>
<dd> Total elasped time in TIME field (accumulated time)
<br><dt><code>(From/To)STime:</code>
<dd>Starting time for process in STIME or START field (accumulated time)
<br><dt><code>TTY:</code>
<dd>terminal type, or none (quoted regex)
<br><dt><code>Priority:</code>
<dd>PRI or NI field (quoted regex)
<br><dt><code>Threads:</code>
<dd>NLWP field for SVR4 (quoted regex)
<br><dt><code>Result:</code>
<dd>logical combination of above returned by filter (quoted regex)
</dl>
Examples: processes started between 18th Nov 2000 and now.
<pre>  { filteralias

  FromSTime: "date(2000,11,18,0,0,0)"
  ToSTime:   "now"
  }
</pre>
All processes which have accumulated between 1 and 20 hours of CPU time.
<pre>  { filteralias

  FromTTime:  "accumulated(0,0,0,1,0,0)"
  ToTTime:    "accumulated(0,0,0,20,0,0)"
  }
</pre>

<ul>
<li><a href="#Complete%20filter%20examples">Complete filter examples</a>: 
</ul>

<p><hr>
Node:<a name="Complete%20filter%20examples">Complete filter examples</a>,
Previous:<a rel=previous href="#filters">filters</a>,
Up:<a rel=up href="#filters">filters</a>
<br>

<h3>Complete filter examples</h3>

<p>Here is an example filter to search for all files which are either directories or links,
or any kind of file owned by mark, in group cfengine.
<pre>
control:

 actionsequence = ( files )

files:

 /tmp       filter=testfilteralias action=alert r=inf
 /cfengine  filter=testfilteralias action=fixall r=inf mode=644

filters:

  { testfilteralias

  Owner:     "mark"
  Group:     "cfengine"
  Type:      "dir|link"

  Result:    "Type|(Owner.Group)"  # Both owner AND group required correct
  }

</pre>
Find all ELF executables using data from the Unix <code>file</code> command. 
Caution, this takes a long time if used indescriminately.
<pre>
control:

 actionsequence = ( files )

files:

 /tmp       filter=testfilteralias action=alert r=inf
 /cfengine  filter=testfilteralias action=fixall r=inf mode=644

filters:

  { testfilteralias

  ExecRegex: "/bin/file (.*ELF.*)"

  Result: "ExecRegex"
  }
</pre>
Here is an example which warns of any process coupled to a terminal
started in November:

<pre>control:

 actionsequence = ( processes )

filters:

  { filteralias
  FromSTime: "date(2000,11,0,0,0,0)"
  ToSTime:   "date(2000,11,30,0,0,0)"
  TTY: ".*pt.*"
  Result: "TTY.STime"
  }

processes:

 "." filter=filteralias action=warn

</pre>

<p><hr>
Node:<a name="groups">groups</a>,
Next:<a rel=next href="#homeservers">homeservers</a>,
Previous:<a rel=previous href="#filters">filters</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>groups/classes</h2>

<p>The <code>groups</code> action (equivalently referred to as <code>classes</code> as
of version 1.4.0) is used to define classes which stand for groups of
hosts.  If you use the NIS (network information service) facility for
defining <em>netgroups</em> then this idea will already be familiar to you
and you can probably use your already-defined netgroups in cfengine.

<p>To define a group, you simply make a list and assign it a name.  Here is
an example of the syntax:

<pre>
groups:

   science = ( saga tor odin )

   packages = ( saga )

   AllHomeServers   = ( saga )
   AllBinaryServers = ( saga )

   OIH_servers = ( saga )
   OIH_clients = ( tor odin )

   notthis = ( !this )

</pre>

<p>To include a list of hosts from a NIS netgroup, you use the <code>+</code> symbol, or
the <code>+@</code> construction.  For example:

<pre>
groups:

   science = ( +science-allhosts )

   physics = ( +physics-allhosts )

   physics_theory = ( +@physics-theory-sun4 dirac feynman schwinger )

</pre>

<p>Using an enormous netgroup does not use up any space.  A group
declaration results in the storage of only the class name regardless of
how many hosts are in the list.  The rule is that the left hand side of
the assignment becomes defined (true) if the list on the right hand side
includes the host which is parsing the file -- i.e.  <code>$(host)</code>.

<p>In some cases your netgroups will not correspond exactly to the list you
want, but it might be more convenient to use a netgroup <em>except</em>
for certain hosts.  You can `undefine' or remove hosts from the netgroup
list by using the minus `-' symbol.  For example:

<pre>
group = ( +mynetgroup -specialhost -otherhost )

</pre>

<p>which means, of course, all hosts in netgroup <code>mynetgroup</code> except
for <code>specialhost</code> and <code>otherhost</code>.  Finally, you may also
subtract two netgroups in the following manner.

<pre>group = ( +bignetgroup -smallnetgroup )
</pre>

<p>The `minus' command effectively eliminates its members from
<code>bignetgroup</code> if they exist within that group.  If none of the
hosts in <code>smallnetgroup</code> exist in <code>bignetgroup</code> then the
command has no effect.

<p>Groups may now contain previously defined cfengine groups too. This
allows one class to inherit the attributes of another class, for instance:

<pre>
  AllSun4Hosts   = ( sonny sunny solar stella )
  AllUltrixHosts = ( ully olly wally golly )

  AllBSD = ( AllSun4Hosts AllUltrixHosts )

</pre>

<p>The classes on the right hand side are effectively ORed together into
the left hand side.  This enables complex classes to be constructed from
several other basic classes, e.g.

<pre>
  SpecialTimes = ( Hr00 Monday Day1 )

</pre>

<p>which evaluates to true every day when it between 00:00 hours and 00:59,
all day Monday and all day on the first day of every month.

<p>Finally, you can define groups (strictly classes) by the result of a shell
command. A shell command or program is deemed to be `true' if it
exits with a status of zero, i.e. it calls <code>exit(0)</code>. Any other
value is taken to be false. You can include shell commands as the members
of groups in order to define classes based on the outcomes of your
own scripts by enclosing the script in single or double quotes:

<pre>
   have_cc = ( '/bin/test -f /usr/ucb/cc' )

</pre>

<p>The class <code>have_cc</code> will then be defined if the shell command returns
true. Of course, you can put any script or program in the single quotes as
long as they adhere to the convention that zero exit status means true. 
If you have several members which are shell commands, then the effect is
to make the class the logical OR of the scripts' results.

<p>As of version 1.4.0, you may use the synonym <code>classes</code> for <code>groups</code>.

<p><hr>
Node:<a name="homeservers">homeservers</a>,
Next:<a rel=next href="#ignore">ignore</a>,
Previous:<a rel=previous href="#groups">groups</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>homeservers</h2>

<p>The <code>homeservers</code> declaration need only be used if you are using
cfengine's model for mounting NFS filesystems.  This declaration informs
hosts of which other hosts on the network possess filesystems containing
home directories (login areas) which client hosts should mount.

<p>A sample homeserver declaration looks like this:

<pre>
homeservers:

   Physics::  einstein
   Math::     riemann euler

</pre>

<p>The meaning of this declaration is the following.  Any host which finds
itself to be a member of the classes on the left hand side of the
assignment need to mount all home directory resources from the hosts on
the right hand side of the assignment.  The pattern variable
<code>homepattern</code> is used to determine which resources are home
directories in the list of <code>mountables</code>.  See <a href="#mountables">mountables</a>.

<p>Let us consider an example in which <code>homepattern</code> is set to the
wildcard value <code>home?</code> and the mountables list is given by

<pre>mountables:

   einstein:/mysite/einstein/home1
   einstein:/mysite/einstein/home2
   riemann:/mysite/riemann/local
   euler:/mysite/euler/home1

</pre>

<p>Any host in the group <code>Physics</code> would now want to mount all home
directories from the host <code>einstein</code>.  There are two of these. 
Both the filesystems listed for <code>einstein</code> match the
<code>homepattern</code> variable since they end in <code>home?</code>.  cfengine
would therefore take this to mean that all hosts in <code>Physics</code>
should mount both of these filesystems.

<p>Hosts in <code>Math</code>, on the other hand, should mount only
homedirectories from the hosts <code>riemann</code> and <code>euler</code>.  There
is only a single filesystem on <code>riemann</code> and it does not match
<code>homepattern</code>, so it is not mounted.  On <code>euler</code> there is a
match, so this filesystem will be added to the appropriate hosts.

<p><em>Cfengine picks out home directory resources from the
<code>mountables</code> list by trying to match the <code>homepattern</code>
variable, starting from the end of the directory name.  You do not
therefore have to use the designation <code>/site/host/home?</code>  but this
is a simple choice and is highly recommended.</em>

<p><hr>
Node:<a name="ignore">ignore</a>,
Next:<a rel=next href="#import">import</a>,
Previous:<a rel=previous href="#homeservers">homeservers</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>ignore</h2>

<p>When you specify a recursive search as part of a <code>files</code>,
<code>tidy</code> or <code>copy</code> action, you would sometimes like to exclude
certain directories from the list of sub directories.  In most cases you
will want to do this on a per-command basis (see the pages for these
actions separately), but you can also make a global ignore list.  This
can be accomplished by adding the directory to the ignore-list.  The syntax
is

<pre>
  ignore:

     <var>wildcards/directories/filenames</var>

</pre>

<p>For example:

<pre>
ignore:

   any::

      #
      # Prevent tidying .X11 directories in /tmp where
      # window managers write semaphores
      #

      .X11

      #
      # Don't tidy emacs locks
      #

      !*
      /local/lib/gnu/emacs/lock/
      /local/tmp
      /local/bin/top
      /local/lib/tex/fonts
      /local/etc
      /local/www
      /local/mutils/etc/finger.log


</pre>

<p>None of the above directories will be checked or entered during
recursive descents unless a specific command is initiated to search
those directories with their names as the top of the search tree.

<p>A handy tip if you are tidying <code>/tmp</code> recursively is to include the
directory <code>.X11</code> here.  This directory is used by the X-windows
system and deleting it while a window manager has an open session can
cause the user some trouble.

<p>Ignore refers to all recursive searches in tidy, files, copy and links.

<p><hr>
Node:<a name="import">import</a>,
Next:<a rel=next href="#interfaces">interfaces</a>,
Previous:<a rel=previous href="#ignore">ignore</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>import</h2>

<p>To break up a large configuration file into smaller files you can use
the include directive.  This conditionally reads in files if the class
on the left hand side of the assignment matches the host parsing the
file.  This enables also a variety of cfengine configuration scripts to
read in a standard set of default settings.  The syntax of the statement
is:

<pre>
import:

   any::

      cf.global_classes


   linux::

      cf.linux_classes


</pre>

<p>Note that, if you define variables in an imported file they will not be
defined for operations in their parent files. This because cfengine reads in all the
import files after the main file has been parsed--not at the place where you
call import in your script. This means that variables or macros defined in
imported files are only defined after the main program. Variables from earlier
files are inherited by later includes, but not <em>vice-versa</em>.

<p><hr>
Node:<a name="interfaces">interfaces</a>,
Next:<a rel=next href="#links">links</a>,
Previous:<a rel=previous href="#import">import</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>interfaces</h2>

<pre>
 interfaces:

   <var>classes</var>::

     <var>interfacename</var> netmask=<var>netmask</var> broadcast=<var>broadcast</var>

</pre>

<p>If you have more than one network interface, or you do not wish to use the
default interface name, this section may be used to define further
interfaces to be checked. This feature can replace the older method
of setting netmask and broadcast address in <code>control:</code>. If the <code>netmask</code>
variable is not set, cfengine ignores the default interface configuration. 
Example:

<pre>
  interfaces:

    "le1" netmask=255.255.255.0 broadcast=ones
    "le2" netmask=255.255.255.0 broadcast=ones

</pre>

<p><hr>
Node:<a name="links">links</a>,
Next:<a rel=next href="#mailserver">mailserver</a>,
Previous:<a rel=previous href="#interfaces">interfaces</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>links</h2>

<p>The symbolic links function is one of the greatest plusses in cfengine
as a system administration tool.  It allows you to do two things: check
single links for correctness and consistency (or make them if they do
not exist), and check or make links to every file in a designated
directory.  This latter feature is called multiple linking or linking
children.  The <code>linkchildren</code> feature is also available from the
<code>files</code> action  See <a href="#files">files</a>. The syntax of a link item is:

<pre>
  <var>from-link</var> -&gt;[!] <var>to-object</var>
 <var>or</var>
  <var>from-link</var> +&gt;[!] <var>to-object</var>

            type=<b>symbolic/absolute/abs</b>/<var>hard/relative/rel</var>
            copy=<var>pattern</var>
            recurse=<var>number/inf/</var><b>0</b>
            copytype=<var>checksum/</var><b>ctime</b>
            include=<var>pattern</var>
            exclude=<var>pattern</var>
            ignore=<var>pattern</var>
            action=<var>silent</var>
            deadlinks=<b>kill</b>/<var>force</var>
            define=<var>classlist</var>
            nofile=<b>kill</b>/<var>force</var>
            syslog=<var>true/on</var>/<var>false/off</var>
            inform=<var>true/on</var>/<var>false/off</var>

</pre>

<p><em>The special variable <code>$(binserver)</code> can be used in <code>links</code>.</em>

<ul>
<li><a href="#Single%20links">Single links</a>: 
<li><a href="#Multiple%20Links">Multiple Links</a>: 
<li><a href="#Link%20Children">Link Children</a>: 
<li><a href="#Relative%20and%20absolute%20links">Relative and absolute links</a>: 
<li><a href="#Hard%20links">Hard links</a>: 
</ul>

<p><hr>
Node:<a name="Single%20links">Single links</a>,
Next:<a rel=next href="#Multiple%20Links">Multiple Links</a>,
Previous:<a rel=previous href="#links">links</a>,
Up:<a rel=up href="#links">links</a>
<br>

<h3>Single links</h3>

<p>To define a single link, you create an entry of the following
form:

<pre>
links:

  <var>class</var>::

     <var>linkname</var> -&gt; <var>object_to_link_to</var>
     <var>linkname</var> -&gt; ./<var>relative_link</var>
     <var>linkname</var> -&gt; ../<var>relative_link</var>

</pre>

<p>If links exists and point to their intended destinations then no
action is taken.  If a link exists but points incorrectly then a
warning is issued, unless the pling operator <code>!</code> is given, in
which case the correct value is forced. 
If the link exists and points to a file which does
not exist a warning is issued unless the command line option <code>-L</code>
is used, in which case the link is deleted.

<p>Here is an example of some valid link statements.

<pre>
links:

  Physics.sun4::

   /usr/local       -&gt; /$(site)/$(host)/local
   /home            -&gt; /$(site)/$(host)/u1
   /etc/sendmail.cf -&gt; /usr/local/mail/etc/global-sendmail.cf

   /usr/lib/sendmail -&gt;! /local/lib/sendmail

</pre>

<p>cfengine makes any directories which are required leading up to the link
name on the left hand side of the arrow automatically. In the last
example the `pling' forces cfengine to make the link even if a file for
link exists previously. Plain files are saved by appending
<code>.cfsaved</code> to the filename, or by moving to a repository, whereas
old links are removed.  The same effect can be enforced globally using
the <code>-E</code> option, but only if the program is run interactively. (In
this case a prompt is issued to make sure that you wish to use such a
big hammer on your system!)

<p>The link operation accepts a number of parameters

<dl>

<br><dt><code>type=<var>hard/relative/absolute</var></code>
<dd>If the link type is hard, a hard link is created See <a href="#Hard%20links">Hard links</a>. 
Symbolic links may specify two special types. If <code>relative</code>
is selected, and the `to' object is an absolute path name,
the link name will be rewritten as a pathname relative
to the source file, using <code>.</code> and <code>..</code> to move relative
to the current directory. For instance, a link from <code>/usr/local/file</code>
to <code>/usr/file</code> would be linked as <code>./../file</code>. 
If the `to' object is already relative,
this has no effect.

<p>If <code>absolute</code> is specified, cfengine
will try to resolve the true path location of the `to' object,
expanding any symbolic links or dots in the path name, up to
a maximum of four levels of symbolic links.

<br><dt><code>copy=<var>pattern</var></code>
<dd>This option can be repeated any number of times to build up a list of
filenames or wildcards which are to be copied rather than linked
symbolically. The copy is made on an age-comparison basis. A global
variable may also be set to invoke this feature See <a href="#copylinks">copylinks</a>. 
Directories cannot be copied in this way.

<br><dt><code>copytype=<var>checksum/ctime</var></code>
<dd>This specifies the basis for deciding whether to update a file
which is to be copied instead of linked See <a href="#copy">copy</a>.

<br><dt><code>nofile=<b>kill</b>/<var>force</var></code>
<dd>This decides what happens to links which point to non-existent
files. The default action is to remove such links, or refuse to
create them. By setting the <var>force</var> option you can force
cfengine to make symbolic links to files which do not exist. 
This is useful for setting up links to filesystems which
are not permanently mounted.

<br><dt><code>exclude=<var>pattern</var></code>
<dd>This option can be repeated any number of times to build up a list of
filenames or wildcards which are to be excluded from the linking
process. A global variable may also be set to invoke this feature
See <a href="#excludelinks">excludelinks</a>.

<br><dt><code>ignore</code>
<dd>This works like the global ignore directive but here you may
provide a private list of ignorable directories and files. 
Unlike include, exclude this affects the way cfengine parses
directory trees.

<br><dt><code>recurse=<var>number/</var>inf</code>
<dd>This option can only be used with multiple link operations See <a href="#Multiple%20Links">Multiple Links</a>. 
If this option is specified, cfengine links only non-directory
objects. Directories are instead created and links within those
directories are also created. The value of this option specifies the
maximum number of levels to which cfengine should recursively descend a
link tree. <code>inf</code> means infinite recursion. Cfengine also ignores
files and directories in the ignore list See <a href="#ignore">ignore</a>.

<br><dt><code>define=<var>classlist</var></code>
<dd>If a link is created or replaced, the colon, comma or dot separated
list of classes becomes defined.

</dl>

<p>The final feature of the links facility is connected to the use of the
cfengine model for mounting NFS filesystems.  In particular it concerns
the variable <code>$(binserver)</code>.  The easiest way to understand this
feature is to illustrate a couple of examples.  Consider the following:

<pre>links:

   any::

      /local -&gt; /${site}/${binserver}/local

</pre>

<p>The result of this command is quite different depending on which host is
executing it.  The variable <code>$(site)</code> clearly has a fixed value,
but the variable <code>$(binserver)</code> might expand to any valid binary
server for the host executing the program.  See <a href="#binservers">binservers</a>.  The
procedure cfengine adopts is to go through its list of mountables,
keeping only those mountable resources which belong to defined binary
servers for the current host.  It then attempts to match a filesystem by
substituting <code>$(binserver)</code> with each of its valid binservers in
turn and it matches the first one binary server which yields an existing
file.

<p>Note that every host is a binary server for itself, so that the value of
<code>$(binserver)</code> which has absolute priority is alway the same as the
value of <code>$(host)</code>.  This ensures that the link will always be made
to a local filesystem if the rules of the model are upheld.

<p><hr>
Node:<a name="Multiple%20Links">Multiple Links</a>,
Next:<a rel=next href="#Link%20Children">Link Children</a>,
Previous:<a rel=previous href="#Single%20links">Single links</a>,
Up:<a rel=up href="#links">links</a>
<br>

<h3>Multiple Links</h3>

<p>With the link symbol <code>+&gt;</code>, you opt to link all of the files in a
directory to corresponding files in another directory.  This procedure is
sometimes useful for installing software.  In the example

<pre>
links:

  myclass::

     /usr/local/bin +&gt;  /usr/local/lib/perl/bin
     /opt           +&gt;! /local

</pre>

<p>every file in the directory <code>/usr/local/lib/perl/bin</code> is linked
symbolically to a corresponding file in <code>/usr/local/bin</code>. The
`pling' character forces cfengine to replace old links or plain files
already existing. Old links are removed, whereas old files are saved
by appending <code>.cfsaved</code> to the filename See <a href="#repository">repository</a>.

<p>Each time cfengine runs it goes through all of the files in the
directory concerned and checks the appropriate link accordingly.  If new
files appear, new links will be added.  If a file disappears but the
link to it remains, a warning will be issued, unless the <code>-L</code>
command line option is used, in which case the link is deleted.

<p><hr>
Node:<a name="Link%20Children">Link Children</a>,
Next:<a rel=next href="#Relative%20and%20absolute%20links">Relative and absolute links</a>,
Previous:<a rel=previous href="#Multiple%20Links">Multiple Links</a>,
Up:<a rel=up href="#links">links</a>
<br>

<h3>Link Children</h3>

<p>The linkchildren directive is a closely related to the cfengine model
for NFS filesystems.  It is a way of making links which embodies a
rudimentary kind of `intelligence'.

<p>Consider the following:

<pre>links:

   any::

      /usr/local/lib/emacs +&gt; linkchildren

</pre>

<p>The word <code>linkchildren</code> automatically tells cfengine that it should
look for an appropriate file to link to on a binary server for the
current host.  The exact meaning of the above statement is as follows. 
cfengine begins searching though the list of mountable resources,
discarding any filesystems which do not belong to valid binary servers. 
It looks for a filesystem ending in `emacs' (the last link of the left
hand side).  If all is well, these file systems are already mounted and
they can be searched.  If no resource is found ending in `emacs', we go
to the next link <code>lib</code> and look for a filesystem ending in `lib'. 
If this is not found we go to <code>local</code> and so on.  When a match is
made, cfengine then tries to locate the file by checking whether it
exists relative to the matched filesystem.  For example, suppose `local'
matched with <code>host:/site/host/local</code>.  It would then try to locate
<code>host:/site/host/local/lib/emacs</code> and link all of the children
therein to the local file directory <code>/usr/local/lib/emacs</code>.

<p>Here is another example which makes reference to the cfengine model for
mounting NFS filesystems.  Suppose you have a host with some spare disk
space.  You want to mount <code>/usr/local</code> from the binary architecture
server, but you also want to use the disk you have locally.  The
following lines

<pre>links:

   electron::

      /$(site)/electron/local +&gt; linkchildren

   any::

      /usr/local              -&gt; /$(site)/$(binserver)/local

</pre>

<p>have the effect of creating a directory <code>/$(site)/electron/local</code>
and filling it with links to all of the files and directories on the
binary server's mounted filesystem.  It results in an exact copy (by
linkage) on the local disk, but does not use up your local disk space. 
The space you have remaining could, for example, be used for software
with a special license for that host.  The second link links
<code>/usr/local</code> to the `nearest' binary server.  But the nearest
binary server is always <code>$(host)</code> which means this evaluates to a
file which now exists because of the first command, so on the host
`electron' the directory <code>/usr/local</code> ends up being a link to
<code>/$(site)/electron/local</code> which is full of links to the binary
server.

<p>If you've caught your breath after that mouthful you probably have mixed
feelings about creating a bunch of links in this way.  What happens if
the files they point to are removed? Then you are left with a lot of
useless links.  Actually this is no problem for cfengine, since you can
ask cfengine to simply remove links which point to non-existent files
See <a href="#files">files</a>.  Nevertheless, this feature clearly requires some caution
and is mainly a spice for advanced users of the cfengine model.

<p><hr>
Node:<a name="Relative%20and%20absolute%20links">Relative and absolute links</a>,
Next:<a rel=next href="#Hard%20links">Hard links</a>,
Previous:<a rel=previous href="#Link%20Children">Link Children</a>,
Up:<a rel=up href="#links">links</a>
<br>

<h3>Relative and absolute links</h3>

<p>When specifying symbolic linking, you can ask cfengine
to change the link type to be either relative to the
source or to be an absolute path. What this means is the
following. Consider the following link:
<pre>
   /var/tmp/cfengine -&gt; /local/cfengine

</pre>

<p>If we add the option <code>type=relative</code>, then instead
of creating a link which points to <code>/local/cfengine</code>,
the link is created pointing to the location

<pre>  ./../../local/cfengine
</pre>

<p>In other words, the link is relative to the calling
directory <code>/var/tmp</code>.

<p>If a link is specified as being absolute with the option
<code>type=absolute</code>, then cfengine attempts to resolve
to value of the link so as to be the true path of the
target. If the target name contains a symbolic link, then
this is expanded as far as possible to give the true
path to the file. For example, if <code>/local</code> is
really a link to <code>/site/myhost/local</code> then the link
would point to <code>/site/myhost/local/cfengine</code>.

<p><hr>
Node:<a name="Hard%20links">Hard links</a>,
Previous:<a rel=previous href="#Relative%20and%20absolute%20links">Relative and absolute links</a>,
Up:<a rel=up href="#links">links</a>
<br>

<h3>Hard Links</h3>

<p>Cfengine will also allow you to create hard links to regular files.  A
hard link is in every way identical to the original file, it merely has
a different name (technically, it is a duplicate inode). To create a
hard link you use the link-option <code>type=hard</code>. For example:

<pre>
links:

   /<var>directory</var>/<var>newname</var> -&gt; /<var>directory</var>/<var>othername</var> type=hard

</pre>

<p>Cfengine will not create hard links to directories or other special files. 
This is always a slightly dubious practice and is best avoided anyway. 
POSIX says that the hard link can be on a different device to the file
it points to, but both BSD and System 5 restrict hard links to be on
the same device as their predecessors. Cfengine has no policy on this,
but--in the theoretical case in which the hard link and the predecessor
were on different file systems--it becomes near impossible to determine
with certainly between a hard link and a very similar regular file, and thus
cfengine issues a warning in verbose mode about this eventuality. 
Provided both link and predecessor are on the same filesystem cfengine
determines the status of hard links by comparing the device and inode
numbers of the file pointed to.

<p><hr>
Node:<a name="mailserver">mailserver</a>,
Next:<a rel=next href="#miscmounts">miscmounts</a>,
Previous:<a rel=previous href="#links">links</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>mailserver</h2>

<p>The <code>mailserver</code> declaration need only be used if you are using
cfengine's model for mounting NFS filesystems.  This declaration informs
hosts of which NFS filesystem contains mail for its users.  All hosts
apart from the mail-host itself must then mount the mail spool directory
across the network.  The declaration looks like this:

<pre>
mailserver:

   <var>class</var>::      mailhost:/var/spool/mail

</pre>

<p>The result of the <code>mailcheck</code> command in the action-sequence is now
to mount the filesystem <code>/var/spool/mail</code> on the host
<code>mailhost</code>.  This action is carried out on any machine which does
not already have that filesystem mounted.

<p>The mail spool directory is mounted, by default, onto the official mail
spool directory for the system which is parsing the program.  In other
words, on an HPUX system, the spool directory is mounted on
<code>/usr/mail</code> by default, whereas on a Sun system it would be mounted
on <code>/var/spool/mail</code>.  The default location can be changed by using
the resource file.  See <a href="#cfrc%20resource%20file">cfrc resource file</a>.

<p><hr>
Node:<a name="miscmounts">miscmounts</a>,
Next:<a rel=next href="#mountables">mountables</a>,
Previous:<a rel=previous href="#mailserver">mailserver</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>miscmounts</h2>

<p>If you do not use the cfengine model for statically mounting NFS
filesystems (or if there are filesystems which do not naturally fall
into the bounds of that model) then you can still statically mount
miscellaneous filesystems using a statement of the form:

<pre>
miscmounts:

   <var>class</var>::

      <var>infohost</var>:<var>source-directory</var> <var>destination</var> <var>mode</var>

      <var>infohost</var>:<var>source-directory</var> <var>destination</var> mode=<var>mode</var>

</pre>

<p>For example
<pre>
   physics::

    # old syntax

      libraryserver:/$(site)/libraryserver/data1
                          /$(site)/libraryserver/data1 ro

    # consistent syntax

      libraryserver:/$(site)/libraryserver/data2
                          /$(site)/libraryserver/data2 mode=ro

      host:/foo /foo mode=rw,bg,hard,intr

</pre>

<p>This statement would mount the directory
<code>/$(site)/libraryserver/data</code> physically attached to host
libraryserver onto a directory of the same name on all hosts in the
group <code>physics</code>.  The modes <code>ro</code> and <code>rw</code> signify
read-only and read-write respectively. 
If no mode is given, read-write is assumed.

<p><hr>
Node:<a name="mountables">mountables</a>,
Next:<a rel=next href="#processes">processes</a>,
Previous:<a rel=previous href="#miscmounts">miscmounts</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>mountables</h2>

<p>The <code>mountables</code> declaration need only be used if you are using
cfengine's model for mounting NFS filesystems.  This declaration informs
hosts of what filesystem resources are available for mounting.  This
list is used in conjunction with <code>binservers</code> and
<code>homeservers</code> to determine which filesystems a given host should
mount, according to the cfengine model.

<p>The syntax of the list is:

<pre>
mountables:

   <var>class</var>::

   server:/site/server/u1
   server:/site/server/local
   linuxhost:/site/linuxhost/local
   linuxhost:/site/linuxhost/u1


</pre>

<p>Notice that binary and home-directory filesystems are mixed freely here. 
Cfengine determines which of the entries are homedirectories using the
<code>homepattern</code> variable.

<p>Every time you add a disk or a mountable partition to your network, you
should add the partition to the list of mountables.

<p><em>NOTE: This list is read in order, top down.  Cfengine looks for
the first filesystem matching a given binary server when expanding the
variable <code>$(binserver)</code>, so sometimes the ordering of filesystems
matters.</em>

<p>This list can be accessed in editfiles, to allow straightforward
configuration of the automounter, using the command <code>AutomountDirectResources</code>.

<p><hr>
Node:<a name="processes">processes</a>,
Next:<a rel=next href="#required">required</a>,
Previous:<a rel=previous href="#mountables">mountables</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>processes</h2>

<p>Using the processes facility, you can test for the existence of
processes, signal (kill) processes and optionally restart them
again. Cfengine opens a pipe from the system ps command and searches
through the output from this command using regular expressions to match
the lines of output from <code>ps</code>.  The regular expression does not
have to be an exact match, only a substring of the process line.  The
form of a process command is

<pre>processes:

    <var>"quoted regular expression"</var>

                        restart <var>"shell command"</var>
                        useshell=<b>true</b>/<var>false/dumb</var>
                        owner=<var>restart-uid</var>
                        group=<var>restart-gid</var>
                        chroot=<var>directory</var>
                        chdir=<var>directory</var>
                        umask=<var>mask</var>

                        signal=<var>signal name</var>
                        matches=<var>number</var>
                        define=<var>classlist</var>
                        action=<b>signal</b><var>/do/warn/bymatch</var>
                        include=<var>literal</var>
                        exclude=<var>literal</var>
                        syslog=<var>true/on</var>/<var>false/off</var>
                        inform=<var>true/on</var>/<var>false/off</var>

    SetOptionString <var>"quoted option string"</var>

</pre>

<p>By default, the options sent to ps are "-aux" for BSD systems and "-ef"
for system 5.  You can use the <code>SetOptionString</code> command to redefine
the option string. Cfengine assumes only that the first identifiable number
on each line is the process identifier for the processes, so you must not
choose options for ps which change this basic requirement (this is not a
problem in practice). Cfengine reads the output of the ps-command normally only
once, and searches through it in memory. The process table is only
re-consulted if <code>SetOptionString</code> is called. The options have the
following meanings:

<dl>

<br><dt><code>signal=<var>signal name</var></code>
<dd>This option defines the name of a signal which is to be sent to all processes
matching the quoted regular expression. If this option is omitted, no signal
is sent. The signal names have the usual
meanings. The full list, with largely standardized meanings, is

<pre>   hup       1   hang-up
   int       2   interrupt
   quit      3   quit
   ill       4   illegal instruction
   trap      5   trace trap
   iot       6   iot instruction
   emt       7   emt instruction
   fpe       8   floating point exception
   kill      9   kill signal
   bus      10   bus error
   segv     11   segmentation fault
   sys      12   bad argument to system call
   pipe     13   write to non existent pipe
   alrm     14   alarm clock
   term     15   software termination signal
   urg      16   urgent condition on I/O channel
   stop     17   stop signal (not from tty)
   tstp     18   stop from tty
   cont     19   continue
   chld     20   to parent on child exit/stop
   gttin    21   to readers pgrp upon background tty read
   gttou    22   like TTIN for output if (tp-&gt;t_local&amp;LTOSTOP)
   io       23   input/output possible signal
   xcpu     24   exceeded CPU time limit
   xfsz     25   exceeded file size limit
   vtalrm   26   virtual time alarm
   prof     27   profiling time alarm
   winch    28   window changed
   lost     29   resource lost (eg, record-lock lost)
   usr1     30   user defined signal 1
   usr2     31   user defined signal 2

</pre>

<p>Note that cfengine will not attempt to signal or restart processes 0 to 3
on any system since such an attempt could bring down the system. The only
exception is that the hangup (hup) signal may be sent to process 1
(init) which normally forces init to reread its terminal configuration
files.

<br><dt><code>restart <var>"shell command"</var></code>
<dd>
Note the syntax: there is no equals sign here.  If the keyword `restart'
appears, then the next quoted string is interpreted as a shell command
which is to be executed after any signals have been sent.  This command
is only issued if the number of processes matching the specified regular
expression is zero, or if the signal sent was signal 9 (sigkill) or 15
(sigterm) , i.e.  the normal termination signals.  This could be used to
restart a daemon for instance. Cfengine executes this command and
<em>waits</em> for its completion so you should normally only use this
feature to execute non-blocking commands, such as daemons which
dissociate themselves from the I/O stream and place themselves in the
background. Some unices leave a hanging pipe on restart (they never
manage to detect the end of file condition). This occurs on POSIX.1 and
SVR4 popen calls which use wait4. For some reason they fail to find and
end-of-file for an exiting child process and go into a deadlock trying
to read from an already dead process. This leaves a zombie behind (the
parent daemon process which forked and was supposed to exit) though the
child continues.  A way around this is to use a wrapper script which
prints the line "cfengine-die" to STDOUT after restarting the
process. This causes cfengine to close the pipe forcibly and continue. 
Cfengine places a timeout on the restart process and attempts to
clean up zombies, but you should be aware of this possibility.

<br><dt><code>owner=,group=</code>
<dd>Sets the process uid and gid (setuid,gid) for processes which are
restarted. This applies only to cfengine run by root.

<br><dt><code>chroot</code>
<dd>Changes the process root directory of the restarted process, creating
a `sandbox' which the process cannot escape from. Best used together with
a change of owner, since a root process can break out of such a confinement
in principle.

<br><dt><code>chdir</code>
<dd>Change the current working directory of the restarted process.

<br><dt><code>useshell=<var>true/false/dumb</var></code>
<dd>When restarting processes, cfengine normally uses a shell to
interpret and execute the restart command. This has inherent
security problems associated with it. If you set this option to
false, cfengine executes restart commands without using a shell. 
This is recommended, but it does mean that you cannot use any
shell operators or features in the restart command-line.

<p>Some programs (like cron) do not handle I/O properly when they fork
their daemon parts, this causes a zombie process and normally
hangs cfengine. By choosing the value `dumb' for this, cfengine
ignores all output from a program and does not use a startup shell. 
This prevents programs like cron from hanging cfengine.

<br><dt><code>matches=<var>number</var></code>
<dd>This option may be used to set a maximum, minimum or exact number of
matches. If cfengine doesn't find a number of matches to the regular
expression which is in accordance with this value it signals a warning. 
The <code>&lt;</code>, <code>&gt;</code> symbols are used  to specify upper and lower
limits. For example,

<pre>  matches=&lt;6  # warn number of matches is greater than or equal to 6
  matches=1   # warn if not exactly 1 matching process
  matches=&gt;2  # warn if there are less than or equal to 2 matching processes
</pre>

<br><dt><code>include=<var>literal</var></code>
<dd>Items listed as includes provide an extra level of selection after the
regular expression matches have been expanded. If you include one
include option, then only lines containing one or more of the literal
strings or wildcards will be matched.

<br><dt><code>exclude=<var>literal</var></code>
<dd>Process lines containing literal strings or wildcards in exclude
statements are not matched. Excludes are processed after regular
expression matching and after includes.

<br><dt><code>define=<var>classlist</var></code>
<dd>The colon, command or dot separated list of classes becomes activated if the
number of regular expression matches is non zero.

<br><dt><code>action=<var>signal/do/warn</var></code>
<dd>The default value of this option is to silently send a signal
(if one was defined using the <code>signal</code> option) to matching
processes. This is equivalent to setting the value of this
parameter to <code>signal</code> or <code>do</code>. If you set this option
to <code>warn</code>, cfengine sends no signal, but prints a message
detailing the processes which match the regular expression. 
If the option is set to <code>bymatch</code>, then signals are only sent
to the processes if the matches criteria fail.

</dl>

<p>Here is an example script which sends the hang-up signal to cron,
forcing it to reread its crontab files:

<pre>
processes:

   "cron" signal=hup

</pre>

<p>Here is a second example which may be used to restart the nameservice
on a solaris system:

<pre>
processes:

   solaris::

       "named" signal=kill restart "/usr/sbin/in.named"

</pre>

<p>A more complex match could be used to look for processes belonging to
a particular user. Here is a script which kills ftp related processes
belonging to a particular user who is known to spend the whole day
FTP-ing files:

<pre>
control:

    actionsequence = ( processes )

  #
  # Set a kill signal here for convenience
  #

    sig = ( kill )

  #
  # Better not find that dumpster here!
  #

    matches = ( 1 )

processes:

   #
   #  Look for Johnny Mnemonic trying to dump his head, user = jmnemon
   #

   ".*jmnemon.*ftp.*" signal=$(sig) matches=&lt;$(matches) action=$(do)

   # No mercy!

</pre>

<p>The regular expression <code>.*</code> matches any number of characters, so this
command searches for a line containing both the username and something to
do with ftp and sends these processes the kill signal.

<p>You can arrange for signals to be sent, only if the number of matches
fails the test. The <code>action=bymatch</code> option is used for this. 
For instance, to kill process `XXX' only if the number
of matches is greater than 20, one would write:

<pre>
processes:

"XXX" matches=&lt;20  action=bymatch signal=kill

</pre>

<p>See also filters See <a href="#filters">filters</a>, for more complex searches.

<p><hr>
Node:<a name="required">required</a>,
Next:<a rel=next href="#resolve">resolve</a>,
Previous:<a rel=previous href="#processes">processes</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>required</h2>

<p>This is a synonym for disks, See <a href="#disks">disks</a>. 
This action tests for the existence of a file or filesystem.  It should
be called after all NFS filesystems have been mounted.  You may use the
special variable <code>$(binserver)</code> here.

<pre>
  required:

    /<var>filesystem</var> freespace=<var>size-limit</var> define=<var>class-list</var>(,:.)

</pre>

<p>Files or filesystems which you consider to be essential to the operation
of the system can be declared as `required'.  Cfengine will warn
if such files are not found, or if they look funny.

<p>Suppose you mount your filesystem <code>/usr/local</code> via NFS from some
binary server.  You might want to check that this filesystem is not
empty! This might occur if the filesystem was actually <em>not</em>
mounted as expected, but failed for some reason.  It is therefore not
enough to check whether the directory <code>/usr/local</code> exists, one must
also check whether it contains anything sensible.

<p>Cfengine uses two variables: <code>sensiblesize</code> and
<code>sensiblecount</code> to figure out whether a file or filesystem is
sensible or not.  You can change the default values of these variables
(which are 1000 and 2 respectively) in the <code>control</code> section. 
See <a href="#control">control</a>.

<p>If a file is smaller than <code>sensiblesize</code> or does not exist, it
fails the `required' test.  If a directory does not exist, or contains
fewer than <code>sensiblecount</code> files, then it also fails the test and a
warning is issued.

<pre>
required:

   any::

      /$(site)/$(binserver)/local

</pre>

<p>If you set the <code>freespace</code> variable to a value (the default units are kilobytes,
but you may specify bytes or megabytes), e.g.

<pre>
required:

  /site/host/home1 freespace=50mb define=dotidy

</pre>

<p>then cfengine will warn when the filesystem concerned has less than this
amount of free space. By adding a <code>define</code> tag, you can switch on
any number of classes if this happens. This allows you to activate special
measures for dealing with a filesystem which is in danger of becoming
full.

<p><hr>
Node:<a name="resolve">resolve</a>,
Next:<a rel=next href="#shellcommands">shellcommands</a>,
Previous:<a rel=previous href="#required">required</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>resolve</h2>

<p>The file <code>/etc/resolv.conf</code> specifies the default nameserver for
each host, as well as the local domain name.  This file can also contain
other information, but these are the only two things cfengine currently
cares about.  In specifying nameservers you should use the dotted
numerical form of the IP addresses since your system may not understand
the text form if it is not correctly configured.  You may list as many
nameservers as you wish, with the default server at the top of the list. 
The resolver normally ignores entries if you add more than three.  The
statement:

<pre>
resolve:

  mygroup::

     129.240.22.35
     129.240.22.222
     129.240.2.3

</pre>

<p>declares a list of nameservers for hosts in the group or class
<code>mygroup</code>.  When you add the <code>resolve</code> command to the
<code>actionsequence</code>, this declaration together with the <code>domain</code>
variable (set here to <code>uio.no</code>) results in a
<code>/etc/resolv.conf</code> file of the form:

<pre>
domain uio.no
nameserver 129.240.22.35
nameserver 129.240.22.222
nameserver 129.240.2.3

</pre>

<p>Note that the <code>resolve</code> action does not delete anything from the
file <code>/etc/resolv.conf</code>.  It adds nameservers which do not
previously exist and reorders the lines of servers which do exist.

<p>As of version 1.3.11, you may use a quoted string to add non-nameserver
lines to this file. For example:

<pre>
resolve:

  mygroup::

     129.240.22.35
     129.240.22.222
     "# Comment line"
     "order bind, files"

</pre>

<p>If the line begins with a non-numeric character, the word `nameserver'
is not added to the line.

<p><hr>
Node:<a name="shellcommands">shellcommands</a>,
Next:<a rel=next href="#tidy">tidy</a>,
Previous:<a rel=previous href="#resolve">resolve</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>shellcommands</h2>

<p>Cfengine focuses on fairly simple minded tasks in order to be as general
as possible.  In many cases you will therefore want to write a script to
do something special on your system.  You can still take advantage of
the classes you have defined by executing these scripts or shell
commands from this section.

<p>The syntax is simply to quote the command you wish to be executed.

<pre>shellcommands:

  "<var>command-string</var>"

          timeout=<var>seconds</var>
          useshell=<b>true</b><var>/false</var>
          umask=<var>octal number</var>
          owner=<var>uid</var>
          group=<var>gid</var>
          define=<var>class-list</var>
          background=<b>false</b><var>/true</var>
          chdir=<var>directory</var>
          chroot=<var>directory</var>
          preview=<var>true</var>/<b>false</b>

</pre>

<p>The user and group ID's of the process can be set to restrict the
permissions of the shellcommand to another user only if cfengine is
executed by root. If you set the optional timeout string, then cfengine
will abort the shellcommand if it exceeds the specified time-limit in
seconds. This can be useful for avoiding situations caused by hung
network connections etc.

<p>Variable substitution works within the strings.  Here are some examples.

<pre>
shellcommands:

   sun4::

       "/usr/lib/find/updatedb"

   AllHomeServers.Sunday::

       "/dir/noseyparker /$(site)/$(host)/u1 $(sysadm) nomail"

   AllBinaryServers.sun4.Saturday::

      "/usr/etc/catman -w -M /usr/local/man"
      "/usr/etc/catman -w -M /usr/local/X11R5/man"
      "/usr/etc/catman -w -M /usr/man"
      "/usr/etc/catman -w -M /usr/local/gnu/man"

</pre>

<p>If you need to write more advanced scripts, which make detailed use of the
classes defined by cfengine, use the <code>$(allclasses)</code> variable to send
a complete list of classes to your script in the format

<pre>
CFALLCLASSES=class1:class2:class3...

</pre>

<p>This variable is kept up-to-date at any given time with only the classes
which are defined.  The command line option <code>-u</code> or
<code>--use-env</code> can be used to define an environment variable which
will be inherited by all scripts and contains the same information. 
This is not the standard approach, since some systems cannot
cope with this rapid change of environment and generate a Bus Error.

<p>Commands can be iterated over variable lists, provided there is
at least one space between each variable. For example:

<pre>
control:

      actionsequence =
         (
         shellcommands
         )

 var1 = ( a:b:c )
 var2 = ( x:y:z )

shellcommands:

   "/bin/echo $(var1) $(var2)"

</pre>

<p>This iterates over all values of the list variables. See <a href="cfengine-Tutorial.html#Iterating%20over%20lists">Iterating over lists</a>. 
If you are iterating over a list, the timeout applies to each separate
iteration, not to the sum of all the iterations.

<p>The <code>chroot</code> option changes the process root directory of the
command, creating a `sandbox' which the process cannot escape from. Best
used together with a change of owner, since a root process can break out
of such a confinement in principle. The <code>chdir</code> option changes the
current working directory of the restarted process.

<p>The <code>preview</code> option means that the shellcommand will also be executed during
the <code>--dry-run</code> (<code>-n</code>) options. This allows cfengine to be more aware
of the results of scripts which define classes. This option should be used
with care. 
Scripts should conform to the protocol of not executing unnecessary commands
when the classes <code>opt_dry_run</code> is defined.

<p><hr>
Node:<a name="tidy">tidy</a>,
Next:<a rel=next href="#unmount">unmount</a>,
Previous:<a rel=previous href="#shellcommands">shellcommands</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>tidy</h2>

<p>The tidy function is used to delete (remove permanently) unwanted files
from a system.  It is useful for tidying up in <code>/tmp</code> or cleaning
out <code>core</code> files from users' home directories.  The form of an
entry is:

<pre>tidy:

  <var>class</var>::

      <var>/directory</var>
                       pattern/include=<var>wildcard</var>

                       recurse=<var>number/inf</var>
                       age=<var>days</var>
                       size=<var>number/empty</var>
                       type=<var>ctime/mtime/</var><b>atime</b>
                       dirlinks=<var>keep/tidy/delete</var>
                       rmdirs=<var>true/<b>false</b>/all/sub</var>
                       links=<b>stop/keep</b><var>/traverse/tidy</var>

                       define=<var>classlist</var>
                       elsedefine=<var>classlist</var>

                       syslog=<var>true/on</var>/<var>false/off</var>
                       inform=<var>true/on</var>/<var>false/off</var>

                       filter=<var>filter alias</var>
                       ignore=<var>pattern</var>
                       exclude=<var>pattern</var>

</pre>

<p>Note that, each of the options below
can be written in either upper or lower case and abbreviated by any
unique abbreviation.

<dl>

<br><dt><code><var>/directory</var></code>
<dd>This is the directory name to directories which mark the start of a
search for files matching certain wildcards.  The wildcard <code>home</code>
may be used instead of an explicit directory, in which case cfengine
iterates over all home directories.  It is compulsory to specify a
directory.

<br><dt><code>pattern=<var>wildcard</var> or include=<var>wildcard</var></code>
<dd>A wildcard or filename to match the files you wish to be deleted.  The
pattern may contain the special symbols <code>?</code> which matches a single
character and <code>*</code> which matches any number of characters as in the
shell. These two options are synonymous, as of version 2.0.x.

<br><dt><code>exclude=<var>wildcard</var></code>
<dd>This does not work for the home directive; use the global ignore list for this.

<br><dt><code>ignore=<var>wildcard</var></code>
<dd>This does not work for the home directive; use the global ignore list for this.

<br><dt><code>recurse=<var>number/inf</var></code>
<dd>This specifier tells cfengine whether or not to recurse into
subdirectories.  If the value is zero, only the named file or directory
is affected.  If the value is 1, it will open at most one level of
subdirectory and affect the files within this scope.  If the value is
<code>inf</code> then cfengine opens all subdirectories and files beginning
from the specified filename. See <a href="#Recursion">Recursion</a>.

<br><dt><code>age=<var>days</var></code>
<dd>The age of a file in days represents a minimum <em>access</em> time
elapsed before the file will be deleted.  In other word a file will be
deleted if it has not been accessed for <var>days</var> days.

<br><dt><code>links=<var>stop/traverse/tidy</var></code>
<dd>Normally cfengine does not descend into subdirectories which are pointed
to by symbolic links.  If you wish to force it to do so (without using
the <code>-l</code> command line option) you may give this option the value
<code>true</code>, or <code>traverse</code>, or <code>follow</code>.  To specify no
recursion you set the value <code>false</code> or <code>stop</code>. 
Note that the value set here in the cfengine program <em>always
overrides</em> the value set by the <code>-l</code> command line option, so you
can protect certain actions from this command line option by specifying
a negative value here.  If you specify no value here, the behaviour is
determined by what you specify on the command line.

<p>The value <code>links=tidy</code> has the same effect as the <code>-L</code> command
line option except that here it may be specified per item rather than
globally.  Setting this value causes links which point to non-existent
files to be deleted. This feature will not work on commands with the
<code>home</code> wildcard feature.  If you want to clean up old links you
should either user a <code>files</code> command or the command line option
which sets the tidy feature globally.

<br><dt><code>size=&gt;<var>number/empty</var></code>
<dd>Old syntax <code>size=<var>number/empty</var></code>. 
The value of this parameter decides the size of files to be deleted. 
Files larger than this value will be deleted if they also are older than
the time specified in <code>age</code>. The default size is zero so that any
file which gets matched by another critereon is deleted. However, if you
want to single out only totally empty files, the <code>empty</code> may be used. 
With this option only empty files, nevery files with anything in them,
 will be deleted, if older than <code>age</code>. By default, the filesizes
are in kilobytes, but kilobytes and megabytes may also be specified by
appending b,k,m to the numbers. Only the first character after the
number is significant so you may write the numbers however it might be
convenient, e.g. <kbd>14k</kbd>, <kbd>14kB</kbd>, <kbd>14kilobytes</kbd>, the same as
for <code>disable</code>.

<br><dt><code>type=<var>ctime/mtime/atime</var></code>
<dd>This value is used to set the type of time comparison made using
<code>age</code>. The default is to compare access times (atime) or
the last time the file was read. A comparison by modification
time (mtime) uses the last time the contents of the file was
changed. The ctime parameter is the last time the contents, owner
or permissions of the file were changed.

<br><dt><code>dirlinks=<var>keep/tidy/delete</var></code>
<dd>This value is used to decide whether cfengine will delete
links which point to directories. The default value is to keep
the links. Note that, if the travlinks option is switched on,
cfengine will not tidy or delete links which point to directories,
instead it follows them into the subdirectory. This is a supplement
to the <code>rmdirs</code> option. You need both to make links
to directories disappear.

<br><dt><code>rmdirs=<var>true/false/all/sub</var></code>
<dd>Normally cfengine will not delete directories. If this option is
set to `true' then cfengine will delete any directories which
are <em>empty</em>. Non-empty directories will not be touched and no
message will be given unless in verbose mode. Note that this
option overrides the above option <code>dirlinks</code>, so that even
links which point to empty directories will be removed. 
If this is set to `sub' then the topmost directory will not
be removed, only sub-directories.

<br><dt><code>define=<var>classlist</var></code>
<dd>The colon, comma or dot separated list of classes becomes defined
if any file matching the specified pattern is deleted.

</dl>
Take a look at the following example:

<pre>tidy:

   AllHomeServers::

       home     pattern=core   R=inf age=0
       home     pattern=*~     R=inf age=7
       home     pattern=#*     R=inf age=30


   any::

       /tmp/    pat=*            R=inf   age=1
       /        pat=core         R=2     age=0
       /etc     pat=hosts.equiv  r=0     age=0

</pre>

<p>In the first example, all hosts in the group <code>AllHomeServers</code>
iterate a search over all user home directories looking for `core' files
(older than zero days) and <code>emacs</code> backup files <code>*~</code>,
<code>#*</code> older than seven days.

<p>The default values for these options are the empty string for the
wildcard pattern, zero for the recursion and a specification of the age
is compulsory.

<p>When cfengine tidies users' home directories, it keeps a log of all the
files it deletes each time it is run.  This means that, in case of
accidents, the user can see that the file has been deleted and restore
it from backup.  The log file is called <code>.cfengine.rm</code> and it is
placed in the home directory of each user.  The file is owned by root,
but is readable to the user concerned.

<p><hr>
Node:<a name="unmount">unmount</a>,
Previous:<a rel=previous href="#tidy">tidy</a>,
Up:<a rel=up href="#Cfagent%20reference">Cfagent reference</a>
<br>

<h2>unmount</h2>

<p>The unmount function unmounts non-required filesystems and removes the
appropriate entry from the filesystem table (<code>/etc/fstab</code> or
equivalent).  The syntax is simply

<pre>unmount:

   <var>class</var>::

      <var>mounthost</var>:<var>filesystem</var>

        deletedir=<var><b>true</b>/false</var>
        deletefstab=<var><b>true</b>/false</var>
        force=<var>true/<b>false</b></var>

</pre>

<p>The options allow you to temporarily unmount a directory without actually
removing it from the filesystem table. The option <code>force</code> is not currently
implemented and will likely have to be system dependent. 
For example:

<pre>unmount:

   physics::

      libraryserver:/$(site)/libraryserver/data

</pre>

<p>If the device is busy then the actual unmount will not take place until
it becomes free, or the machine is rebooted.  This feature should work
on AIX systems, in spite of these machines inherent peculiarities in the
form of the filesystem table.

<p>Some users do not mount filesystems on a directory of the same name as the
source directory. This can lead to confusion. 
Note, if you have problems removing a mounted filesystem, try using
the mountpoint of the filesystem, rather than the name of the filesystem itself,
in the unmount command.

<p><hr>
Node:<a name="Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>,
Next:<a rel=next href="#Cfexecd%20reference">Cfexecd reference</a>,
Previous:<a rel=previous href="#Cfagent%20reference">Cfagent reference</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Cfservd and cfrun reference</h1>

<ul>
<li><a href="#cfservd%20control">cfservd control</a>: 
<li><a href="#admit%20grant%20and%20deny">admit grant and deny</a>: 
<li><a href="#cfrun">cfrun</a>: 
<li><a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>: 
</ul>

<p>The server daemon is controlled by a file called
<code>cfservd.conf</code>. 
The syntax of this configuration file is deliberately modelled on
cfengine's own configuration file, but despite the similarities, they are separate.

<p>You can use <code>groups</code> and <code>import</code> in both files
to break up files into convenient modules and to import
common resources, such as lists of groups.

<p>Note that the classes in the <code>cfservd.conf</code> file do not tell you the
classes of host which have access to files and directories, but rather
which classes of host pay attention to the access and deny commands when
the file is parsed.

<p>Authentication is not by class or group but by hostname, like
the <code>/etc/exports</code> file on most Unix systems. The syntax for the
file is as follows:

<pre>
 control:

   <var>classes</var>::

       domain = ( <var>DNS-domain-name</var> )

       cfrunCommand = ( "<var>script/filename</var>" )  # Quoted

       MaxConnections = ( <var>maximum number of forked daemons</var> )

       ChecksumDatabase = ( <var>filename</var> )

       IfElapsed = ( <var>time-in-minutes</var> )

       DenyBadClocks = ( <var>false</var> )

       AllowConnectionsFrom = ( <var>IP numbers</var> )

       DenyConnectionsFrom = ( <var>IP numbers</var> )

       AllMultipleConnectionsFrom = ( <var>IP numbers</var> )

       TrustKeysFrom  = ( <var>IP numbers</var> )

       AllowUsers = ( mark systemuser )

       LogAllConnections = ( <var>false/true</var> )

       SkipVerify = ( <var>IP numbers</var> )

 groups:

   <var>Group definitions</var>

 import:

   <var>Files to import</var>

 admit: | grant:

   <var>classes</var>::

      /<var>file-or-directory</var>

        <var>wildcards/hostnames</var>

 deny:

   <var>classes</var>::

      /<var>file-or-directory</var>

        <var>wildcards/hostnames</var> root=<var>hostlist</var> encrypt=<var>true/on</var>

</pre>


<p>The file consists of a control section and access information.

<p><hr>
Node:<a name="cfservd%20control">cfservd control</a>,
Next:<a rel=next href="#admit%20grant%20and%20deny">admit grant and deny</a>,
Previous:<a rel=previous href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>,
Up:<a rel=up href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>
<br>

<h2>control</h2>

<ul>
<li><a href="#AllowConnectionsFrom">AllowConnectionsFrom</a>: 
<li><a href="#AllowMultipleConnectionsFrom">AllowMultipleConnectionsFrom</a>: 
<li><a href="#AllowUsers">AllowUsers</a>: 
<li><a href="#AutoExecCommand">AutoExecCommand</a>: 
<li><a href="#AutoExecInterval">AutoExecInterval</a>: 
<li><a href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>: 
<li><a href="#cfrunCommand">cfrunCommand</a>: 
<li><a href="#DenyBadClocks">DenyBadClocks</a>: 
<li><a href="#DenyConnectionsFrom">DenyConnectionsFrom</a>: 
<li><a href="#cfservd%20IfElapsed">cfservd IfElapsed</a>: 
<li><a href="#LogAllConnections">LogAllConnections</a>: 
<li><a href="#MaxConnections">MaxConnections</a>: 
<li><a href="#TrustKeysFrom">TrustKeysFrom</a>: 
</ul>

<p><hr>
Node:<a name="AllowConnectionsFrom">AllowConnectionsFrom</a>,
Next:<a rel=next href="#AllowMultipleConnectionsFrom">AllowMultipleConnectionsFrom</a>,
Previous:<a rel=previous href="#cfservd%20control">cfservd control</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>AllowConnectionsFrom</h3>

<p>This variable allows a list
of numerical IP masks to be specified, which cfservd will allow connections from. 
If the list is not empty and a host whose IP address is not specified
attempts to connect to the daemon, its connection will be closed
immediately. 
  This can be used to prevent hanging connection attacks from malicous
hosts and other denial of service attacks which would bind thread
resources.
<pre>     control:

      AllowConnectionsFrom = ( 128.39.89  192.2.0.10 )

</pre>

<p><hr>
Node:<a name="AllowMultipleConnectionsFrom">AllowMultipleConnectionsFrom</a>,
Next:<a rel=next href="#AllowUsers">AllowUsers</a>,
Previous:<a rel=previous href="#AllowConnectionsFrom">AllowConnectionsFrom</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>AllowMultipleConnectionsFrom</h3>

<p>This variable should contain a list of IP wildcards to hosts which are
allowed simultaneous sessions on the server. Hosts which are not in this
list are allowed to connect only once, i.e. they must terminate and
reconnect in order to establish a new session. This is to prevent a
possible attacker from opening multiple sockets and never closing them,
resulting in a denial of service attack. Hosts IP's can be placed here
if they could have overlapping copy sessions (e.g. long backup transfers
which can run over time). This prevents the error message "Multiple
connections denied/spam shield".

<p><hr>
Node:<a name="AllowUsers">AllowUsers</a>,
Next:<a rel=next href="#AutoExecCommand">AutoExecCommand</a>,
Previous:<a rel=previous href="#AllowMultipleConnectionsFrom">AllowMultipleConnectionsFrom</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>AllowUsers</h3>

<p>This list determines which users are to be allowed to connect to the daemon. 
Note that there is no way of identifying users except by their public keys. 
If a malicious asserts their identity, when no public key for the named
user is known to the server, then they could spoof the identity of that
user.  If users other than root are allowed to connect, they need to be here. 
This applies to use of cfrun.

<pre>
AllowUsers = ( mark )

</pre>

<p>In other words, this is a "security by obscurity" first defence against
picking up bad keys, when the server is in trust mode, with respect to a
host. The attacker must know a valid user name in order to even try
their luck entering into a key dialogue.

<p>This reduces the probability that spoofing can be successful. The only
real defence against spoofing is to make sure that all required public keys
are installed in advance, and to switch off trust.

<p><hr>
Node:<a name="AutoExecCommand">AutoExecCommand</a>,
Next:<a rel=next href="#AutoExecInterval">AutoExecInterval</a>,
Previous:<a rel=previous href="#AllowUsers">AllowUsers</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>AutoExecCommand</h3>

<p>This variable no longer exists in cfengine version 2.

<p><hr>
Node:<a name="AutoExecInterval">AutoExecInterval</a>,
Next:<a rel=next href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>,
Previous:<a rel=previous href="#AutoExecCommand">AutoExecCommand</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>AutoExecInterval</h3>

<p>This variable no longer exists in version 2 of cfengine.

<p><hr>
Node:<a name="ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>,
Next:<a rel=next href="#cfrunCommand">cfrunCommand</a>,
Previous:<a rel=previous href="#AutoExecInterval">AutoExecInterval</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>ChecksumDatabase</h3>

<p>This is the path and filename to a database which will cache
MD5 checksum values server-side. This optimization is only available
if you have the Berkeley database library <code>libdb</code> on your
system. If this variable is not defined, no database caching
will be used and checksum values will be computed directly on
request. The utility of this solution is a trade-off between
the time it takes to compute the checksum versus the time
for a disk-based lookup.

<p><hr>
Node:<a name="cfrunCommand">cfrunCommand</a>,
Next:<a rel=next href="#DenyBadClocks">DenyBadClocks</a>,
Previous:<a rel=previous href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>cfrunCommand</h3>

<p>This string is the command which you would like to be executed
remotely by the <code>cfrun</code> command.

<p><hr>
Node:<a name="DenyBadClocks">DenyBadClocks</a>,
Next:<a rel=next href="#DenyConnectionsFrom">DenyConnectionsFrom</a>,
Previous:<a rel=previous href="#cfrunCommand">cfrunCommand</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>DenyBadClocks</h3>

<p>If this is set to <code>off</code>, cfservd will not deny access to clients whose
clocks are off by more than one hour. The default is to deny access to
systems whose clocks differ by more than one hour. This can prevent
messages of the form `Can't stat' file when remote copying.

<p><hr>
Node:<a name="DenyConnectionsFrom">DenyConnectionsFrom</a>,
Next:<a rel=next href="#cfservd%20IfElapsed">cfservd IfElapsed</a>,
Previous:<a rel=previous href="#DenyBadClocks">DenyBadClocks</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>DenyConnectionsFrom</h3>

<p>Hosts which are included by the allow-list above can be explicitly
denied access using this list.
<pre>     control:

      DenyConnectionsFrom = ( 128.39.89.76 )  # rogue host

</pre>

<p><hr>
Node:<a name="cfservd%20IfElapsed">cfservd IfElapsed</a>,
Next:<a rel=next href="#LogAllConnections">LogAllConnections</a>,
Previous:<a rel=previous href="#DenyConnectionsFrom">DenyConnectionsFrom</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>IfElapsed</h3>

<p>The <code>IfElapsed</code> anti-spamming filter is also built into
<code>cfservd</code> so that a remote user cannot even get as far as
causing cfengine to parse its input files (which could
be used for spamming in itself). The time is in minutes,
the default is one hour.

<p><hr>
Node:<a name="LogAllConnections">LogAllConnections</a>,
Next:<a rel=next href="#MaxConnections">MaxConnections</a>,
Previous:<a rel=previous href="#cfservd%20IfElapsed">cfservd IfElapsed</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>LogAllConnections</h3>

<p>If set to true, every successful connection will be logged to syslog. 
This could be useful for identifying abuses of the service, if the server
should come under attack, e.g. a denial of service attack. The IP address
can then be excluded from the allowed connections list.

<p><hr>
Node:<a name="MaxConnections">MaxConnections</a>,
Next:<a rel=next href="#TrustKeysFrom">TrustKeysFrom</a>,
Previous:<a rel=previous href="#LogAllConnections">LogAllConnections</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>MaxConnections</h3>

<p>This integer value sets a limit on the maximum number of
child daemon threads which cfservd will `fork' in order
to handle remote requests. The default value is ten.

<p><hr>
Node:<a name="TrustKeysFrom">TrustKeysFrom</a>,
Previous:<a rel=previous href="#MaxConnections">MaxConnections</a>,
Up:<a rel=up href="#cfservd%20control">cfservd control</a>
<br>

<h3>TrustKeysFrom</h3>

<p>Hosts which are included in this list are automatically
trusted, if cfservd does not know their public key. This
allows public keys to be exchanged. Cfservd will not automatically
accept a public key from a host it does not know, since the
key will be used to assert strong authentication later. 
Once a pubic key has been associated with an IP address, it
will never be updated, unless the existing key is deleted by hand.

<pre>     control:

      TrustKeysFrom = ( 128.39.89.76 )  # trusted host

</pre>

<p><hr>
Node:<a name="admit%20grant%20and%20deny">admit grant and deny</a>,
Next:<a rel=next href="#cfrun">cfrun</a>,
Previous:<a rel=previous href="#cfservd%20control">cfservd control</a>,
Up:<a rel=up href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>
<br>

<h2>admit, grant and deny</h2>

<ul>
<li><a href="#root%3d">root=</a>: 
<li><a href="#encrypt%3d">encrypt=</a>: 
<li><a href="#SkipVerify">SkipVerify</a>: 
</ul>

<p><hr>
Node:<a name="root%3d">root=</a>,
Next:<a rel=next href="#encrypt%3d">encrypt=</a>,
Previous:<a rel=previous href="#admit%20grant%20and%20deny">admit grant and deny</a>,
Up:<a rel=up href="#admit%20grant%20and%20deny">admit grant and deny</a>
<br>

<h3><code>root=</code></h3>

<p>This list specificies the names of hosts which are to have read
access to files, regardless of the owner of the file. This effectively
gives root users on connecting hosts privileges to non-root owned
files on the server, but not vice-versa, similar to the NFS root mapping,
except that there is no question of a client being able to modify files
on the server. Caution: cfservd trusts the DNS service, so be aware that
cache poisoning attacks are a possible way of bypassing access controls.

<p><hr>
Node:<a name="encrypt%3d">encrypt=</a>,
Next:<a rel=next href="#SkipVerify">SkipVerify</a>,
Previous:<a rel=previous href="#root%3d">root=</a>,
Up:<a rel=up href="#admit%20grant%20and%20deny">admit grant and deny</a>
<br>

<h3><code>encrypt=true</code></h3>

<p>If this option is set, cfservd will only serve the named files
if the copy access type is <code>secure</code>, i.e. on an encrypted
link. This presupposes that cfengine has been compiled with
a working OpenSSL library.

<p><hr>
Node:<a name="SkipVerify">SkipVerify</a>,
Previous:<a rel=previous href="#encrypt%3d">encrypt=</a>,
Up:<a rel=up href="#admit%20grant%20and%20deny">admit grant and deny</a>
<br>

<h3>SkipVerify</h3>

<p>If connecting hosts use a Network Address Translator in order to share an IP address,
reverse lookup will fail to give a correct verification of host identity. 
You can switch off cfservd's verification of host identity for specific IP addresses
or patterns using this command. E.g.

<pre>
SkipVerify = ( 192.0.0.10  192.0.2.  )

</pre>

<p>NOTE!! This is a security risk because it means that cfservd implicitly
trusts the connecting hosts! You should be very careful in using
Network Address Translators in a secure environment. It is not recommended
for sites which require a high level of security.

<p><hr>
Node:<a name="cfrun">cfrun</a>,
Next:<a rel=next href="#Firewalls%20and%20NATs">Firewalls and NATs</a>,
Previous:<a rel=previous href="#admit%20grant%20and%20deny">admit grant and deny</a>,
Up:<a rel=up href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>
<br>

<h2><code>cfrun</code></h2>

<p>The general syntactic form of the <code>cfrun</code> command is

<pre>
  cfrun -<var>option</var> --<var>longoption</var> <var>class1</var> <var>class2 ...</var>

</pre>

<p>Since <code>cfrun</code> addresses remote hosts, there is an ambiguity in
whether options are intended for the <code>cfrun</code> command itself, on the local
host, or whether they are to be passed on to the agent on the remote hosts. 
To clarify this distinction, the arguments are organized as follows:

<pre>
  cfrun -<var>local options</var> -- <var>remote options</var> -- <var>remote classes</var>

</pre>

<p>Local options are processed by <code>cfrun</code> on the local host; remote options
are passed on as options to the remote <code>cfagent</code> (actually to the
command defined in <code>cfrunCommand</code> in the file <code>cfservd.conf</code>;
remote classes are processed by the remote <code>cfservd</code> service, and specifiy
classes which must be satisfied by the remote host in order to invoke the
remote command.

<p>The <code>-q</code> and <code>-I</code> options are
always assumed when executing cfengine remotely, so that <code>SplayTime</code> is
effectively zero when polling hosts serially, and the output always
shows what is happening on the remote hosts.

<p>Each host evaluates the classes sent by <code>cfrun</code>
and decides whether cfengine should be invoked. 
Only hosts which belong to the classes defined on the <code>cfrun</code>
command line are executed. This allows you to single out groups of hosts
which should execute cfengine, based on the very classes which you have
defined for your configuration.  If no classes are sent on the command
line, then all hosts are run.

<p><code>cfrun</code> uses a configuration file which is located under the
<code>CFINPUTS</code> directory in order to determine which hosts and in
which order it should try to connect. Because cfengine always uses a
reliable TCP protocol for connections, it verifies each connection
rather than simply broadcasting openly. Using this file you can even
simulate broadcasting to hosts outside your subnet.

<p>This file should contain every host name you ever want to
configure remotely, because you can still select subsets of
the file by specifying classes which the remote host will understand. 
If the remote host is not in one of the classes you specify when you
run <code>cfrun</code>, then it will simply ignore the request. Conversely,
if you do not place a host in this file, it will never be contacted
when you use the <code>cfrun</code> command. The format of the file
is as follows

<pre>
 #
 # Comment ..
 #
 domain=<var>my.domain</var>
 access=<var>user1</var>,<var>user2</var>
 outputdir=<var>directory</var>
 maxchild=<var>number limit</var>

 <var>hostname1</var>            <var>options</var>
 <var>hostname2</var>:<var>port</var> <var>options</var>
 ...

</pre>

<p>If the option <code>outputdir</code> is present, cfrun forks a separate
process for each host and passes the output to files in a named directory. 
The <code>maxchild</code> line limits the number of forked processes.

<p>It is important to add the domain-name to this file. 
The options you specifiy in this file, per host, are added to those
you might specify on the command line when invoking cfengine remotely. 
For instance, you might know of a bug on one host and decide not to
perform interface configuration on that one machine. You would write
a line like this:

<pre>
  funny.domain -- -i  # problem host

</pre>

<p>You could use <code>cfrun</code> inside one of your cfengine configuration
files in order to remotely execute cfengine on all of the other network
machines, by setting up a host list. The disadvantage however is that
cfengine has to poll the systems on the network, which means that
cfengine cannot be working in parallel on all hosts.

<p>Some other examples:

<pre>
e.g.  cfrun -- -- linux          Run on all linux machines
      cfrun -- -p                Ping and parse on all hosts
      cfrun -v -- -p             Ping all, local verbose
      cfrun -v -- -k -- solaris  Local verbose, all solaris, but no copy

</pre>

<p>Amongst the local options, one may specify a subset of the hosts which are to
be contacted by cfrun, i.e. to avoid processing the entire list of hosts. For
example, to contact only host1 and host2, given that they are already in
the list of hosts.

<pre>
cfrun -v host1 host2
cfrun -v host1 host2 -- -p

</pre>

<p><hr>
Node:<a name="Firewalls%20and%20NATs">Firewalls and NATs</a>,
Previous:<a rel=previous href="#cfrun">cfrun</a>,
Up:<a rel=up href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>
<br>

<h2>Firewalls and NATs</h2>

<p>Firewalls and Network Address Translators (NAT) can be a problem for
addressing.  Suppose you have a firewall and with a private IP-range
behind the firewall.  You want to update the nodes from a central
host. You can do a two stage configuration: first update the firewall and
then update from the firewall to the nodes.

<p>But suppose you already use SNAT (Source Network Address Translation) and DNAT
(Destination ...) for the nodes. With DNAT you can say that socket 22000
on the firewall is routed to <var>host-name</var>:5308. DNAT gives us the
possibilty to update the nodes from a central server in one step instead
of two.

<p>If the port command is given cfrun uses this to connect to the client
instead of the default (5308) one. 
Here is an example (<code>cfrun.hosts</code>):
<pre>
node1.example.org
node2.example.org:22000 -DNis
node2.example.org:22001

</pre>

<p>This connects to: 1) node1 with standard port, 2) node2 with port 22000 and extra options -DNis
and, 3) node2 with port 22000.

<p><hr>
Node:<a name="Cfexecd%20reference">Cfexecd reference</a>,
Next:<a rel=next href="#Problem%20solving">Problem solving</a>,
Previous:<a rel=previous href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Cfexecd reference</h1>

<p>In wrapper mode (non-forking, non-daemon mode), cfagent is run by adding a
line to the root crontab file of each system:
<pre>0,30 * * * * /usr/local/sbin/cfexecd -F
</pre>
This is enough to ensure that cfengine will get run. Any output generated
by this job, will be stored in <code>/var/cfengine/outputs</code>. 
In addition, if you add the following to the file <code>cfagent.conf</code>,
the system administrator will be emailed a summary of any output:
<pre>
control:

smtpserver = ( mailhub.example.org ) # site MTA which can talk smtp
sysadm     = ( mark@example.org )   # mail address of sysadm

</pre>

<p>Fill in suitable values for these variables. 
An alternative, or additional way to run cfengine, is to run the <code>cfexecd</code>
program is daemon mode (without the <code>-F</code>) option. In this mode, the daemon
lives in the background and sleeps, activating only in accordance with
a scheduling policy. The default policy is to run once every hour (equivalent
to <code>Min00_05</code>). Here is how you would modify <code>cfagent.conf</code> in
order to make the daemon execute cfagent every half-hour:
<pre>  control:

   # When should cfexecd in daemon mode wake up the agent?

   schedule   = ( Min00_05 Min30_35 )
</pre>
Note that the time specifications are the basic cfengine <em>time classes</em>. 
Although one of these methods should suffice,
no harm will arise from running both cron and the cfexecd side-by-side. 
Cfagents locking mechanisms ensure that no contention will occur.

<p>Note, that if problems with library path for compiled in libraries occur, an
explicit library path can be specified with the <code>-L</code> option.
<pre>0,30 * * * * /usr/local/sbin/cfexecd -F -L /local/iu/lib:/local/lib/mysql:/local/lib:/local/gnu/lib
</pre>

<p><hr>
Node:<a name="Problem%20solving">Problem solving</a>,
Next:<a rel=next href="#Example%20configuration%20file">Example configuration file</a>,
Previous:<a rel=previous href="#Cfexecd%20reference">Cfexecd reference</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Problem solving</h1>

<ul>
<li><a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>: 
<li><a href="#cfrc%20resource%20file">cfrc resource file</a>: 
</ul>

<p><hr>
Node:<a name="cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>,
Next:<a rel=next href="#cfrc%20resource%20file">cfrc resource file</a>,
Previous:<a rel=previous href="#Problem%20solving">Problem solving</a>,
Up:<a rel=up href="#Problem%20solving">Problem solving</a>
<br>

<h2><code>cf.preconf</code> bootstrap file</h2>

<p>In some cases you will want to run cfengine on a system to configure it
from scratch.  If the system is in a very bad way, it might not even be
able to parse the cfengine configuration file, perhaps because the
network was not properly configured or the DNS (Domain Name Service) was
out of action.  To help prevent this situation, cfengine looks for a
script called <code>cf.preconf</code> which gets executed prior to parsing and
can be used to perform any emergency tests.  This file needs only
contain enough to get the system to parse the configuration files.

<p><code>cf.preconf</code> may be any script in any language.  It need not exist
at all! It is fed one argument by cfengine, namely the system hard-class
for the current system (e.g.  <code>ultrix</code>).  Here is an example:

<pre>#!/bin/sh
#
# cf.preconf is an emergency/bootstrap file to get things going
# in case cfengine is unable to parse its config file
#

backupdir=/iu/nexus/local/iu/etc

 #
 # If these files don't exist, you might not be able to parse cfagent.conf
 #

if [ ! -s /etc/resolv.conf ]; then

 echo Patching basics resolv.conf file
 cat &gt; /etc/resolv.conf &lt;&lt; XX
domain iu.hioslo.no
nameserver 128.39.89.10
XX

fi

#
# SVR4
#

if [ "$1" = "solaris" ]; then

  if [ ! -s "/etc/passwd" ]; then

  echo Patching missing passwd file
    /bin/cp $backupdir/passwd /etc/passwd
  fi

  if [ ! -s "/etc/shadow" ]; then

   echo Patching missing passwd file
   /bin/cp $backupdir/shadow /etc/shadow
  fi
fi

#
# BSD 4.3
#

if [ "$1" = "linux" ]; then

   if [ ! -s "/etc/passwd"  ]
   then

    echo Patching missing passwd file
    /bin/cp $backupdir/passwd.linux /etc/passwd
   fi
fi




</pre>

<p><hr>
Node:<a name="cfrc%20resource%20file">cfrc resource file</a>,
Previous:<a rel=previous href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>,
Up:<a rel=up href="#Problem%20solving">Problem solving</a>
<br>

<h2><code>cfrc</code> resource file</h2>

<p>If, for some reason you are not satisfied with the defaults which
cfengine uses, then you can change them by making an entry in the
resource file.  The default values are defined in the source code file
<code>classes.c</code> in the distribution.  The format of the resource file
is:

<pre>hardclass.variable: value
</pre>

<p>For example, you might want to forget about where your HPUX system
mounts its mail directory and mount it under <code>/usr/spool/mail</code>.  In
this case you would add the line:

<pre>hpux.maildir: /usr/spool/mail
</pre>

<p>To redefine the filesystem table for GNU/linux, you would write:
<pre>linux.fstab: /etc/linuxfstab
</pre>

<p>The full list of re-definable resources is:

<pre>   mountcomm       # command used to mount filesystems
   unmountcomm     # command used to unmount filesystems
   ethernet        # name of the ethernet device
   mountopts       # options to above mount command
   fstab           # the name of the filesystemtable
   maildir         # the location of the mail directory
   netstat         # the full path to netstat and options
   pscomm          # the path to the system's ps command
   psopts          # the options used by ps (default aux/ef)
</pre>

<p>You should never need to redefine resources unless you decide to do something
non-standard.  Interested readers are referred to the values in <code>classes.c</code>.

<p>Cfengine is easily extensible so as to support a variety of
architectures.  You can even add your own.  To do so you need, first of
all, to define a new class for the operating system concerned.  The file
<em>classes.c</em> has been separated off from the remainder of the source
code so that you can easily see which data structures need to be
extended.

<p>To make life as straightforward as possible, three unused classes have
been defined.  They are called (unremarkably) <em>unused1</em>,
<em>unused2</em> and <em>unused3</em>.  If you add any further classes, it
will be necessary to increase the constant <em>clssattr</em> defined in
<em>cf.defs.h</em> by one for every new addition.  You do not need to
change <em>clssattr</em> if you simple replace one of the unused classes
by a real class.

<p>To see fully the impact of what you need to do, you should make a search
for the strings <em>unused?</em> in all of the source files.  Certain
special cases need to be handled for each operating system.  For
example, the form of the filesystem table is quite radically different
on some systems such as AIX.  One thing you must do is to fill in the
default values for the new operating system in the file
<em>classes.c</em>.

<p>If you fill in the details for a new operating system before it finds
its way into a new release, you might consider sending the details to
the bug list in the next paragraph.

<p><hr>
Node:<a name="Example%20configuration%20file">Example configuration file</a>,
Next:<a rel=next href="#Variable%20Index">Variable Index</a>,
Previous:<a rel=previous href="#Problem%20solving">Problem solving</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Example configuration files</h1>

<p>Here is a sample from a large configuration file, just to give you
some ideas. The file is broken up into manageable pieces for
convenience.

<ul>
<li><a href="#cfagent.conf">cfagent.conf</a>: 
<li><a href="#cf.groups">cf.groups</a>: 
<li><a href="#cf.main">cf.main</a>: 
<li><a href="#cf.site">cf.site</a>: 
<li><a href="#cf.motd">cf.motd</a>: 
<li><a href="#cf.users">cf.users</a>: 
<li><a href="#cf.solaris">cf.solaris</a>: 
<li><a href="#cf.linux">cf.linux</a>: 
<li><a href="#cf.freebsd">cf.freebsd</a>: 
<li><a href="#cfservd.conf">cfservd.conf</a>: 
</ul>

<p><hr>
Node:<a name="cfagent.conf">cfagent.conf</a>,
Next:<a rel=next href="#cf.groups">cf.groups</a>,
Previous:<a rel=previous href="#Example%20configuration%20file">Example configuration file</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cfagent.conf</h2>

<pre>#####################################################################
#
#  CFENGINE CONFIGURATION FOR site = iu.hioslo.no
#
#  This file is for root only.
#
######################################################################

###
#
# BEGIN cfagent.conf
#
###

import:

   #
   # Split things up to keep things tidy
   #

   any::
                    cf.groups
                    cf.main
                    cf.site
                    cf.motd

   hpux::           cf.hpux
   linux::          cf.linux
   solaris::        cf.solaris
   sun4::           cf.sun4
   ultrix::         cf.ultrix
   freebsd::        cf.freebsd

   #
   # Do you want to do this ?
   #

   AllHomeServers:: cf.users


###
#
# END cfengine.conf
#
###
</pre>

<p><hr>
Node:<a name="cf.groups">cf.groups</a>,
Next:<a rel=next href="#cf.main">cf.main</a>,
Previous:<a rel=previous href="#cfagent.conf">cfagent.conf</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.groups</h2>

<pre>##############################################################
#
# cf.groups - for iu.hioslo.no
#
# This file contains  all group/class definitions
#
#################################################################

###
#
# BEGIN cf.groups
#
###

groups:

   #
   # Define some groups
   #

   iu = ( nexus ferengi regula borg dax lore axis worf daystrom voyager
          aud1 aud2 aud3 aud4 bajor ds9 takpah takpeh nostromo galron
          thistledown rama chaos pc-steinarj pc-hildeh way jart kosh )

   diskless   = ( regula ferengi lore )

   standalone = ( nexus axis dax borg worf daystrom voyager
                  aud1 aud2 aud3 aud4 bajor ds9 takpah takpeh
                  nostromo galron thistledown rama pc-torejo
                  pc-steinarj pc-hildeh )

   AllHomeServers   = ( nexus )
   AllBinaryServers = ( nexus borg )

   XBootServer  = ( nexus )
   WWWServers   = ( nexus )
   FTPserver    = ( nexus )
   NameServers  = ( nexus )
   PasswdServer = ( nexus )
   BackupHost   = ( nexus )

   MailHub      = ( nexus )
   MailClients  = ( iu -nexus )

###
#
# END cf.groups
#
###

</pre>

<p><hr>
Node:<a name="cf.main">cf.main</a>,
Next:<a rel=next href="#cf.site">cf.site</a>,
Previous:<a rel=previous href="#cf.groups">cf.groups</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.main</h2>

<pre>##############################################################
#
# cf.main - for iu.hioslo.no
#
# This file contains generic config stuff
#
#################################################################

###
#
# BEGIN cf.main
#
###

control:

   access    = ( root )        # Only root should run this

   site      = ( iu )
   domain    = ( iu.hioslo.no )
   sysadm    = ( drift@iu.hioslo.no )

   repository = ( /var/spool/cfengine )

   netmask   = ( 255.255.255.0 )
   timezone  = ( MET )
   nfstype   = ( nfs )

   sensiblesize  = ( 1000 )
   sensiblecount = ( 2 )
   editfilesize  = ( 20000 )

   mountpattern = ( /$(site)/$(host) )
   homepattern  = ( u? )

   #
   # If we undefine this with cfengine -N longjob
   # then we switch off all jobs labelled with this class
   #

   addclasses = ( longjob )

   #
   # Macros &amp; constants are inherited downwards in imports
   # but are not passed up to parent files. Good idea to
   # define them all here
   #

   masterfiles = ( /iu/nexus/local/iu )
   main_server = ( nexus )
   cfbin       = ( /iu/nexus/local/gnu/lib/cfengine/bin )
   gnu         = ( /local/gnu )
   ftp         = ( /local/iu/ftp )
   nisslave    = ( dax )
   nisfiles    = ( /iu/nexus/local/iu/etc )

   #
   # The action sequence for daily (full) runs and
   # for hourly updates (called with -DHourly)
   #

   Hr00::

      actionsequence =
         (
         copy
         mountall
         mountinfo
         checktimezone
         netconfig
         resolve
         unmount
         shellcommands
         addmounts
         links.Prepare
         files.Prepare
         directories
         links.Rest
         mailcheck
         mountall
         required
         tidy
         disable
         editfiles
         files.Rest
         processes
         )

   !Hr00::

      actionsequence =
         (
         resolve
         shellcommands
         copy
         editfiles
         processes
	 links
         )

   force::

      actionsequence =
         (
         files.Prepare.Rest
         tidy
         )

######################################################################

homeservers:

   iu:: nexus

binservers:

   iu.solaris::                 nexus
   iu.linux::                   borg

mailserver:

   any:: nexus:/var/mail

mountables:

   any::
         nexus:/iu/nexus/u1
         nexus:/iu/nexus/u2
         nexus:/iu/nexus/u3
         nexus:/iu/nexus/u4
         nexus:/iu/nexus/u5
         nexus:/iu/nexus/u6
         nexus:/iu/nexus/ua
         nexus:/iu/nexus/ud
         nexus:/iu/nexus/local
         nexus:/opt/NeWSprint
         nexus:/opt/AcroRead
         borg:/iu/borg/local
         dax:/iu/dax/local

miscmounts:

   linux||freebsd::   nexus:/iu/nexus/local /iu/nexus/local ro

######################################################################

broadcast:

  ones

defaultroute:

   cadeler30-gw

######################################################################

resolve:

      128.39.89.10  # nexus
      158.36.85.10  # samson.hioslo.no
      129.241.1.99

######################################################################

tidy:

   #
   # Some global tidy-ups
   #

      /tmp/                    pat=*             r=inf     A=1
      /var/tmp                 pat=*             r=inf     A=1
      /                        pat=core          r=1       A=0
      /etc                     pat=core          r=1       A=0

######################################################################

ignore:                       # Don't check or tidy these directories

      /local/lib/gnu/emacs/lock/
      /local/tmp
      ftp
      projects
      /local/bin/top
      /local/lib/tex/fonts
      /local/iu/etc
      /local/etc
      /local/iu/httpd/conf
      /usr/tmp/locktelelogic
      /usr/tmp/lockIDE
      RootMailLog

      #
      # Emacs lock files etc
      #

      !*
      /local/lib/xemacs

      #
      # X11 keeps X server data in /tmp/.X11
      # better not delete this!
      #

      .X11

      #
      # Some users like to give a file or two 777 protection here
      # so netsurfers can update a log or counter when running as
      # `nobody'
      #

      www

#####################################################################

disable:

   /etc/hosts.equiv
   /etc/nologin
   /usr/lib/sendmail.fc


###
#
# END cf.main
#
###

</pre>

<p><hr>
Node:<a name="cf.site">cf.site</a>,
Next:<a rel=next href="#cf.motd">cf.motd</a>,
Previous:<a rel=previous href="#cf.main">cf.main</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.site</h2>

<pre>##############################################################
#
# cf.site - for iu.hioslo.no
#
# This file contains site specific data
#
#################################################################

###
#
# BEGIN cf.site
#
###

links:

   Prepare::

      /local     -&gt; /$(site)/$(binserver)/local
      /usr/local -&gt; /local

   dax::

      /iu/dax/local             +&gt; /iu/nexus/local
      /projects                 -&gt; /iu/dax/local/projects
      /iu/nexus/u1/sowille/data -&gt; /iu/dax/scratch/data

   XBootServer::

      #
      # Set up a /local/tftpboot area where all X terminal
      # stuff will be kept.
      #

      /tftpboot                  -&gt; /local/tftpboot
      /local/tftpboot/td/configs -&gt; /local/tftpboot/td/examples/configs
      /etc/bootptab              -&gt; /tftpboot/bootptab
      /tftpboot/usr/lib/X11/td   -&gt; /tftpboot/td

   NameServers::

      /etc/named.boot -&gt; /local/iu/named/named.boot

   MailHub::

      /etc/mail/sendmail.cf -&gt;! /iu/nexus/local/mail/sendmail.cf

   MailClients.solaris::

      /etc/mail/sendmail.cf -&gt;! /iu/nexus/local/mail/client.cf

   nexus::

	/local/bin +&gt; /local/latex/bin

#############################################################

disable:

  #
  # We run Berkeley sendmail and the config files are
  # all under /iu/nexus/local/lib/mail
  #

    /etc/aliases

 WWWServers.Sunday::

   #
   # Disabling these log files weekly prevents them from
   # growing so enormous that they fill the disk!
   #

   /local/iu/httpd/logs/access_log   rotate=empty
   /local/iu/httpd/logs/agent_log    rotate=empty
   /local/iu/httpd/logs/error_log    rotate=empty
   /local/iu/httpd/logs/referer_log  rotate=empty

   #
   # CERT warning, security fix
   #

  any::

    /usr/lib/expreserve

  FTPserver.Sunday.Hr00::

   /local/iu/xferlog rotate=3

#################################################################

files:

  Prepare::

      /etc/motd              m=0644 r=0 o=root act=touch
      /.cshrc                m=0644 r=0 o=root act=touch

   PasswdServer::

      /local/iu/etc/passwd m=0644 o=root g=other action=fixplain
      /local/iu/etc/shadow m=0644 o=root g=other action=fixplain

   WWWServers.Rest::

      /local/iu/www                           m=775        g=www act=fixall r=inf
      /local/iu/httpd/conf                    m=664 o=root g=www act=fixall r=inf
      /local/iu/www/cgi-bin-public/count_file m=777 o=root g=www act=fixplain

   FTPserver::

      #
      # Make sure anonymous ftp areas have the correct
      # protection, or logins won't be able to read
      # files - or perhaps a security risk. This is
      # solaris 2 specific...
      #

      $(ftp)/pub        mode=755 o=ftp  g=ftp  r=inf act=fixall
      $(ftp)/Obin       mode=111 o=root g=other      act=fixall
      $(ftp)/etc        mode=111 o=root g=other      act=fixdirs
      $(ftp)/usr/bin/ls mode=111 o=root g=other      act=fixall
      $(ftp)/dev        mode=555 o=root g=other      act=fixall
      $(ftp)/usr        mode=555 o=root g=other      act=fixdirs

   Prepare::

      /etc/shells mode=0644 action=touch

   AllBinaryServers.Rest.longjob::

     /local mode=-0002 r=inf owner=root,bin group=0,1,2,3,4,5,6,7,staff
            links=tidy action=fixall

     /local/iu/RootMailLog  m=0666 action=touch

   dax.Rest::

    /iu/dax/scratch        r=0 o=root mode=1777 action=fixall
    /iu/dax/local/projects r=0 o=root mode=755  action=fixdirs

   nexus::

    /local/mail/sendmail.cf o=root m=444 act=fixplain

    /iu/nexus/ua/robot/.rhosts o=robot m=600 act=touch

    /local/iu/named/pz         o=root  m=644 act=fixall r=1

    /local/latex/lib/tex/texmf/fonts  owner=root
                                      mode=1666
                                      recurse=inf
                                      action=fixall

#################################################################

tidy:

      #
      # Make sure the file repository doesn't fill up
      #

      /var/spool/cfengine pattern=*    age=3

      /var                pattern=core age=0  r=inf
      /var/spool/mqueue   pattern=*    age=14 type=mtime

   BackupHost::

      # Here we tidy old backup tar files from the backup area
      # A special tmp area gets cleared every 4 days. The files
      # are created by Audun's backup help script (see shellcommands)

      /iu/nexus/backup1      pat=*  age=7

#################################################################

shellcommands:

   PasswdServer::

      # Build and install the BSD compatible passwd file
      # from the master passwd/shadow file on solaris

      "/local/iu/bin/BuildPasswdFiles"
      "/local/iu/bin/BuildGroupFiles"

  BackupHost.Sunday.Hr00|BackupHost.Wednesday.Hr00::

      #
      # Make a system backup of /iu/nexus/u? with Audun's script
      #

      "$(cfbin)/cfbackup -p -f /iu/nexus/backup1 -s /iu/nexus/ud"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup1 -s /iu/nexus/ua"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup1 -s /iu/nexus/u1"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup1 -s /iu/nexus/u2"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup2 -s /iu/nexus/u3"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup2 -s /iu/nexus/u4"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup2 -s /iu/nexus/u5"
      "$(cfbin)/cfbackup -p -f /iu/nexus/backup2 -s /iu/nexus/u6"

  nexus.Sunday.longjob.Hr00::

      #
      # See how much rubbish users have accumulated each Sunday
      #

      "$(cfbin)/noseyparker /iu/nexus/u1 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/u2 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/u3 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/u4 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/u5 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/u6 $(sysadm) "
      "$(cfbin)/noseyparker /iu/nexus/ua $(sysadm) nomail"
      "$(cfbin)/noseyparker /iu/nexus/ud $(sysadm) nomail"

   nexus.longjob.Hr00::

      #
      # Update the GNU find/locate database each night
      #

      "$(gnu)/lib/locate/updatedb"
      "/local/iu/bin/newhomepage.sh"

###############################################################

editfiles:

    #
    # cfengine installs itself as a cron job - sneaky! :)
    #

    { /var/spool/cron/crontabs/root

    AppendIfNoSuchLine "0 * * * * $(cfbin)/cfwrap $(cfbin)/cfhourly"
    }

   FTPserver::

      { /etc/shells

      AppendIfNoSuchLine "/bin/tcsh"
      AppendIfNoSuchLine "/local/gnu/bin/bash"
      }


   XBootServer::

      { /etc/inetd.conf

      AppendIfNoSuchLine
          "bootp dgram udp wait root /local/bin/bootpd bootpd -i -d"
      }

   nexus::

      { /iu/nexus/ua/robot/.rhosts

      AppendIfNoSuchLine "borg"
      AppendIfNoSuchLine "borg.iu.hioslo.no"
      AppendIfNoSuchLine "aud4"
      AppendIfNoSuchLine "aud4.iu.hioslo.no"
      }

   dax::

      { /etc/system

      AppendIfNoSuchLine "set pt_cnt=128"
      }


######################################################################

required:

   #
   # Any host must have a /local, /usr/local fs. Check that
   # it exists and looks sensible. (i.e. not empty)
   #

   /$(site)/$(binserver)/local


######################################################################

copy:

   #
   # NIS seems broken at IU, so here we use NFS to fudge
   # a file distribution as a temporary solution. Actually
   # this makes the system work faster without NIS!
   #

      $(nisfiles)/services dest=/etc/services o=root g=other mode=0644
      $(nisfiles)/hosts.deny dest=/etc/hosts.deny o=root mode=0644

   !debian::

      $(nisfiles)/hosts    dest=/etc/hosts o=root g=other mode=0644

   PasswdServer::

      /etc/passwd dest=$(nisfiles)/passwd o=root g=other mode=0644
      /etc/shadow dest=$(nisfiles)/shadow o=root g=other mode=0644

   nexus::

      /local/iu/etc/dfstab dest=/etc/dfs/dfstab  o=root  mode=0744

   solaris.!PasswdServer::

      $(nisfiles)/passwd dest=/etc/passwd o=root g=other mode=0644
      $(nisfiles)/shadow dest=/etc/shadow o=root g=other mode=0600
      $(nisfiles)/group.solaris dest=/etc/group o=root g=other mode=0644

   linux::

      $(nisfiles)/passwd.linux dest=/etc/passwd o=root g=other mode=0644
      $(nisfiles)/group.linux dest=/etc/group o=root g=other mode=0644

###############################################################

processes:

      "eggdrop"                           signal=kill
      "irc"                               signal=kill
      "ping"                              signal=kill
      "NetXRay"                           signal=kill
      "netxray"                           signal=kill
      "ypserv"                            signal=kill
      "ypbind"                            signal=kill
      "rarpd"                             signal=kill
      "rpc.boot"                          signal=kill
      "README"                            signal=kill # You don't sh README !

   !XBootServer::

      "bootp"                             signal=kill

   #
   # These processes are not killed every hour, but once a day
   # when cfengine runs at night. Note that there are often
   # hanging pine and elm processes. These programs crash and
   # go berserk, using hundreds of hours of CPU time.
   #

   Hr00::

      "cron"                 signal=hup  # HUP these to update their config
      "inetd"                signal=hup

      "/local/sdt/sdt/bin"   signal=term # For those elektro dudes who forget
                                         # to log out
      "netscape"             signal=kill
      "pine"                 signal=kill
      "elm"                  signal=kill


###
#
# END cf.site
#
###

</pre>

<p><hr>
Node:<a name="cf.motd">cf.motd</a>,
Next:<a rel=next href="#cf.users">cf.users</a>,
Previous:<a rel=previous href="#cf.site">cf.site</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.motd</h2>

<pre>
##################################################################
#
# cf.motd
#
# This file is used to set the message of the day file on
# each host
#
##################################################################

 #####
 #
 # BEGIN cf.motd
 #
 #####


control:

   #
   # This points to the file containing general text
   #

   masterfile      = ( /iu/nexus/local/iu/etc/motd-master )
   local_message   = ( /etc/motd.local )

editfiles:

      { /etc/motd

      BeginGroupIfFileIsNewer "$(masterfile)"
        EmptyEntireFilePlease
        InsertFile "$(masterfile)"
        InsertFile "$(local_message)"
        PrependIfNoSuchLine "This system is running $(class):$(arch)"
      EndGroup
      }

 #####
 #
 # BEGIN cf.motd
 #
 #####

</pre>

<p><hr>
Node:<a name="cf.users">cf.users</a>,
Next:<a rel=next href="#cf.solaris">cf.solaris</a>,
Previous:<a rel=previous href="#cf.motd">cf.motd</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.users</h2>

<p>Whether or not you perform any special services for users, with or
without their consent is entirely a matter of local policy. In a school
or college situation, users are often uncooperative and some are even
irresponsible.  This file shows you what you could do in an environment
with inexperienced users, but please don't feel as though you have to be
this totalitarian.

<pre>#################################################################
#
# cf.users - for iu.hioslo.no
#
# This file contains user specific actions
#
#################################################################

###
#
# BEGIN cf.users
#
###

ignore:

    robot

tidy:

   longjob::

     #
     # Some users just don't understand what they are doing
     # and this is safest, allbeit totalitarian
     #

     home                 pat=.rhosts                      age=0

     #
     # Tidy up users' home dirs
     #

     home                 pat=core             r=inf       age=0
     home                 pat=a.out            r=inf       age=1
     home                 p=*%                 r=inf       age=2
     home                 p=*~                 r=inf       age=2
     home                 p=#*                 r=inf       age=1
     home                 p=*.dvi              r=inf       age=14   type=ctime
     home                 p=*.log              r=inf       age=2
     home                 p=Log.*              r=inf       age=3
     home                 p=CKP                r=inf       age=1
     home                 p=BAK                r=inf       age=1
     home                 p=log                r=inf       age=0
     home                 p=*.o                r=inf       age=0
     home                 p=*.aux              r=inf       age=3
     home                 p=*.zip              r=inf       age=7
     home/.deleted        p=*                  r=inf       age=0
     home/.wastebacket    p=*                  r=inf       age=14
     home/www             p=*~                 r=inf       age=1

     #
     # Clear the big cache files netscape creates
     #

     home/.netscape-cache  p=cache????*         r=inf       age=0
     home/.MCOM-cache      p=cache????*         r=inf       age=0
     home/.netscape/cache  p=*                  r=inf       age=0


#################################################################

files:

   AllHomeServers.longjob.rest::

     #
     # Check users files are not writable to the world
     # and there are no stale links (pointing nowhere)
     #

     home mode=o-w recurse=inf action=fixall # links=tidy

     home/.xsession mode=755 action=fixall
     home/.cshrc    mode=755 action=fixall

#################################################################

copy:

   Hr00.longjob::

   #
   # Make sure each user has an up to date standard
   # setup.  Cshrc just sources in a big standard file
   # which is kept in ~user/../.setupfiles/cshrc
   # to reduce disk wastage
   #

   $(masterfiles)/lib/Cshrc   dest=home/.cshrc
   $(masterfiles)/lib/tkgrc   dest=home/.tkgrc
   $(masterfiles)/lib/fvwm2rc dest=home/.fvwm2rc


###
#
# END cf.users
#
###
</pre>

<p><hr>
Node:<a name="cf.solaris">cf.solaris</a>,
Next:<a rel=next href="#cf.linux">cf.linux</a>,
Previous:<a rel=previous href="#cf.users">cf.users</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.solaris</h2>

<pre>#################################################################
#
# cf.solaris - for iu.hioslo.no
#
# This file contains solaris specific patches
#
#################################################################

###
#
# BEGIN cf.solaris
#
###

directories:

     #
     # httpd/netscape want this to exist for some bizarre reason
     #

      /usr/lib/X11/nls

################################################################

tidy:

     /var/log  pattern=syslog.* age=0

   MailHub::

     /var/mail pattern=lp       age=0

#################################################################

files:

  #
  # If this doesn't exist fork will not work and the
  # system will not even be able to run the /etc/rc
  # scripts at boottime
  #

  /etc/system     o=root g=root m=644 action=touch

  /var/log/syslog o=root        m=666 action=touch

#############################################################

copy:

   #
   # Some standard setup files, can't link because
   # machine won't boot if their not on / partition.
   #

   /local/bin/tcsh dest=/bin/tcsh mode=755

   /local/iu/etc/nsswitch.standalone dest=/etc/nsswitch.conf

  #
  # Our named server uses a newer BIND
  # Put this here so that it will be preserved under
  # solaris reinstallation
  #

  NameServers::

   /local/iu/sbin/in.named         dest=/usr/sbin/in.named         mode=555
   /local/iu/sbin/in.named.reload  dest=/usr/sbin/in.named.reload  mode=555
   /local/iu/sbin/in.named.restart dest=/usr/sbin/in.named.restart mode=555
   /local/iu/sbin/in.ndc           dest=/usr/sbin/in.ndc           mode=555
   /local/iu/sbin/named-xfer       dest=/usr/sbin/named-xfer       mode=555
   /local/iu/lib/nslookup.help     dest=/usr/lib/nslookup.help     mode=444

  any::
   /local/iu/lib/libresolv.a        dest=/usr/lib/libresolv.a      mode=444
   /local/iu/lib/libresolv.so.2     dest=/usr/lib/libresolv.so.2   mode=444
   /local/bin/nslookup              dest=/usr/sbin/nslookup        mode=444

##############################################################

editfiles:

      { /etc/netmasks

      AppendIfNoSuchLine "128.39  255.255.255.0"
      }

      { /etc/defaultrouter

      AppendIfNoSuchLine "128.39.89.1"
      }

      { /usr/openwin/lib/app-defaults/XConsole

      AppendIfNoSuchLine "XConsole.autoRaise: on"
      }

   #
   # CERT security patch for vold vulnerability
   #

   { /etc/rmmount.conf

   HashCommentLinesContaining "action cdrom"
   HashCommentLinesContaining "action floppy"
   }

##############################################################

disable:

    /etc/.login  type=file
    /etc/aliases

   #
   # These files are ENORMOUS, don't let them fill the disk
   #

   Wednesday::

      /var/lp/logs/lpsched rotate=empty

      /var/adm/wtmpx       rotate=empty
      /var/adm/wtmp        rotate=empty

##############################################################

files:

    /etc/passwd        m=0644 o=root g=other action=fixplain
    /etc/shadow        m=0600 o=root g=other action=fixplain
    /etc/defaultrouter m=0644 o=root g=other action=touch
    /var/adm/wtmpx     m=0664 o=adm  g=adm   action=touch
    /var/adm/wtmp      m=0644 o=root g=adm   action=touch
    /var/adm/utmp      m=0644 o=root g=adm   action=fixplain
    /var/adm/utmpx     m=0664 o=adm  g=adm   action=fixplain

    /tmp m=1777                              action=fixdirs

##############################################################

disable:

   #
   # CERT security patch
   #

   /usr/openwin/bin/kcms_calibrate
   /usr/openwin/bin/kcms_configure
   /usr/bin/admintool

################################################################

shellcommands:

   AllBinaryServers.Saturday.longjob.Hr00::

      #
      # Make sure the man -k / apropos data are up to date
      #

      "/usr/bin/catman  -M /local/man"
      "/usr/bin/catman  -M /local/X11R5/man"
      "/usr/bin/catman  -M /usr/man"
      "/usr/bin/catman  -M /local/gnu/man"
      "/usr/bin/catman  -M /usr/openwin/share/man"
      "/usr/bin/catman  -M /local/X11R5/man"
      "/usr/bin/catman  -M /usr/share/man"

################################################################

editfiles:


      #
      # A painless way to add an rc.local script to the rc files
      # under solaris without having to fight though inittab
      #

      { /etc/rc3.d/S15nfs.server

      AppendIfNoSuchLine "sh /local/iu/etc/rc.local"
      }

      #
      # umask defined when inetd starts is inherited by all subprocesses
      # including ftpd which saves with mode 666 (!) unless we do this
      #

      { /etc/rc2.d/S72inetsvc

      PrependIfNoSuchLine "umask 022"
      }


###
#
# END cf.solaris
#
###

</pre>

<p><hr>
Node:<a name="cf.linux">cf.linux</a>,
Next:<a rel=next href="#cf.freebsd">cf.freebsd</a>,
Previous:<a rel=previous href="#cf.solaris">cf.solaris</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.linux</h2>

<pre>#################################################################
#
# cf.linux - for iu.hioslo.no
#
# This file contains debian linux specific patches
#
#################################################################

###
#
# BEGIN cf.linux
#
###

files:

      /etc/printcap m=644 o=root action=fixplain

     #
     # Cert advisories
     #

      /bin/mount         m=755 o=root action=fixall
      /bin/umount        m=755 o=root action=fixall

#######################################################################

  disable:

     #
     # Cert advisories
     #

      /sbin/dip-3.3.7n

########################################################################

links:

    /local/bin/tcsh   -&gt;  /bin/tcsh

    /local/lib/mail   -&gt;  /$(site)/$(main_server)/local/lib/mail

########################################################################

editfiles:

  #
  # Samba default mode needs to be set...
  #

   { /etc/smb.conf

   ReplaceAll "700" With "644"
   }

  #
  # Linux date is very stupid and needs a very careful
  # TZ definition, otherwise it loses
  #

   { /etc/csh.cshrc

   AppendIfNoSuchLine "setenv TZ 'MET-1MET DST-2,M3.5.0/2,M10.5.0/3'"
   }

  #
  # resolv+ ordering
  #

   { /etc/host.conf

   PrependIfNoSuchLine "order bind"
   }


  #
  # Should have been configured already (!)
  #

   { /etc/ld.so.conf

   AppendIfNoSuchLine "/usr/X11R6/lib"
   }

  #
  # Kill annoying messages
  #

   { /etc/cron.daily/standard

   HashCommentLinesContaining "security"
   }

#########################################################################

shellcommands:

  Hr00::

     #
     # Find/locate database
     #

     "/usr/bin/updatedb"

###
#
# END cf.linux
#
###


</pre>

<p><hr>
Node:<a name="cf.freebsd">cf.freebsd</a>,
Next:<a rel=next href="#cfservd.conf">cfservd.conf</a>,
Previous:<a rel=previous href="#cf.linux">cf.linux</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cf.freebsd / cf.netbsd</h2>

<p>FreeBSD, OpenBSD and NetBSD are sufficiently similar to have a single
file for all.

<pre>#################################################################
#
# cf.bsd - for iu.hioslo.no
#
# This file contains bsd specific patches
#
#################################################################

###
#
# BEGIN cf.bsd
#
###

links:

    /usr/spool        -&gt;  /var/spool
    /local/bin/tcsh   -&gt;  /bin/tcsh
    /local/bin/perl   -&gt;  /usr/bin/perl
    /usr/lib/sendmail -&gt;  /usr/sbin/sendmail

#################################################################

files:

   /usr/tmp mode=1777 owner=root action=fixall

#################################################################

editfiles:

   #
   # Comment out all lines to shut up this annoying cfengine-like
   # script, which sends mail every day!!!
   #

   { /etc/crontab

   HashCommentLinesContaining "daily"
   HashCommentLinesContaining "weekly"
   HashCommentLinesContaining "monthly"
   }

#################################################################

copy:

      $(masterfiles)/etc/printcap.client      dest=/etc/printcap mode=0644

#########################################################################

shellcommands:

  Hr00::

    "/usr/libexec/locate.updatedb"
    "/usr/bin/makewhatis /usr/share/man:/usr/X11R6/man"

###
#
# END cf.bsd
#
###


</pre>

<p><hr>
Node:<a name="cfservd.conf">cfservd.conf</a>,
Previous:<a rel=previous href="#cf.freebsd">cf.freebsd</a>,
Up:<a rel=up href="#Example%20configuration%20file">Example configuration file</a>
<br>

<h2>cfservd.conf</h2>

<pre>#########################################################
#
# This is a cfservd config file
#
#########################################################

 #
 # Could import cf.groups here and use a structure like
 # in cfengine.conf, cf.main, cf.groups
 #

control:

  public = ( /usr/local/publicfiles )

  almost_public = ( /usr/local/almostpublicfiles )

  cfrunCommand = ( /iu/nexus/ud/mark/comp/Tests/cfrun-command )

  MaxConnections = ( 10 )

#########################################################

admit:   # or grant:

     $(public) *

     $(almost_public) *.iu.hioslo.no *.gnu.ai.mit.edu

     /etc/passwd *.iu.hioslo.no

     #
     # Who can exec cfengine remotely?
     #

     $(cfrunCommand) *.iu.hioslo.no

#########################################################

deny:

     $(public)/special *.moneyworld.com


</pre>

<p><hr>
Node:<a name="Variable%20Index">Variable Index</a>,
Next:<a rel=next href="#Concept%20Index">Concept Index</a>,
Previous:<a rel=previous href="#Example%20configuration%20file">Example configuration file</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Variable Index</h1>

<ul compact>
<li><code>!</code>: <a href="#Cfengine%20classes">Cfengine classes</a>
<li><code>$(arch)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(binserver)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(class)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(cr)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(date)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(dblquote)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(dollar)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(domain)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(faculty)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(fqhost)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(host)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(ipaddress)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(lf)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(n)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(quote)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(site)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(spc)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(sysadm)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(tab)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(timezone)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>$(year)</code>: <a href="#Special%20variables">Special variables</a>
<li><code>+</code>: <a href="#groups">groups</a>
<li><code>-D option</code>: <a href="#addclasses">addclasses</a>, <a href="#Cfengine%20classes">Cfengine classes</a>
<li><code>-l</code>: <a href="#tidy">tidy</a>
<li><code>-L</code>: <a href="#Single%20links">Single links</a>
<li><code>-l</code>: <a href="#Syntax">Syntax</a>
<li><code>-N option</code>: <a href="#addclasses">addclasses</a>, <a href="#Cfengine%20classes">Cfengine classes</a>
<li><code>-x option</code>: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>.cfengine.rm</code>: <a href="#tidy">tidy</a>
<li><code>/etc/host.conf</code>: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>/var/cfengine/output</code>: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li><code>a=</code>: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li><code>AccessedBefore()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>action</code>: <a href="#Syntax">Syntax</a>
<li><code>actionsequence</code>: <a href="#actionsequence">actionsequence</a>, <a href="#control">control</a>
<li><code>AddClasses</code>: <a href="#addclasses">addclasses</a>
<li><code>AddInstallable</code>: <a href="#addinstallable">addinstallable</a>
<li><code>addmounts</code>: <a href="#actionsequence">actionsequence</a>
<li><code>age</code>: <a href="#tidy">tidy</a>
<li><code>AllowUsers</code>: <a href="#AllowUsers">AllowUsers</a>
<li><code>backup=</code>: <a href="#copy">copy</a>
<li><code>binserver</code>: <a href="#Link%20Children">Link Children</a>, <a href="#Single%20links">Single links</a>
<li><code>binservers</code>: <a href="#binservers">binservers</a>
<li><code>broadcast</code>: <a href="#broadcast">broadcast</a>
<li><code>cf.preconf</code>: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>CFALLCLASSES</code>: <a href="#Special%20variables">Special variables</a>, <a href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>
<li><code>cfrc</code>: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li><code>ChangedBefore()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>ChecksumDatabase</code>: <a href="#ChecksumDatabase">ChecksumDatabase</a>
<li><code>ChecksumUpdates</code>: <a href="#ChecksumUpdates">ChecksumUpdates</a>
<li><code>checktimezone</code>: <a href="#actionsequence">actionsequence</a>
<li><code>childlinks</code>: <a href="#actionsequence">actionsequence</a>
<li><code>control</code>: <a href="#control">control</a>
<li><code>create</code>: <a href="#create">create</a>
<li><code>directories</code>: <a href="#actionsequence">actionsequence</a>
<li><code>disable</code>: <a href="#disable">disable</a>, <a href="#actionsequence">actionsequence</a>
<li><code>domain</code>: <a href="#domain">domain</a>, <a href="#control">control</a>
<li><code>DryRun</code>: <a href="#dryrun">dryrun</a>
<li><code>editbinaryfilesize</code>: <a href="#editbinaryfilesize">editbinaryfilesize</a>
<li><code>editfiles</code>: <a href="#actionsequence">actionsequence</a>
<li><code>editfilesize</code>: <a href="#editfilesize">editfilesize</a>, <a href="#control">control</a>
<li><code>empty</code>: <a href="#disable">disable</a>
<li><code>EmptyResolvConf</code>: <a href="#emptyresolvconf">emptyresolvconf</a>
<li><code>Exclamation</code>: <a href="#exclamation">exclamation</a>
<li><code>exclude=</code>: <a href="#Syntax">Syntax</a>
<li><code>FileExtensions</code>: <a href="#fileextension">fileextension</a>
<li><code>files</code>: <a href="#files">files</a>, <a href="#actionsequence">actionsequence</a>
<li><code>filter</code>: <a href="#filters">filters</a>
<li><code>force=</code>: <a href="#copy">copy</a>
<li><code>freespace=</code>: <a href="#required">required</a>, <a href="#disks">disks</a>
<li><code>g=</code>: <a href="#Syntax">Syntax</a>
<li><code>group</code>: <a href="#Syntax">Syntax</a>
<li><code>groups</code>: <a href="#groups">groups</a>
<li><code>home</code>: <a href="#Syntax">Syntax</a>
<li><code>homepattern</code>: <a href="#mountables">mountables</a>
<li><code>HomePattern</code>: <a href="#homepattern">homepattern</a>
<li><code>homeservers</code>: <a href="#homeservers">homeservers</a>
<li><code>import</code>: <a href="#import">import</a>
<li><code>include=</code>: <a href="#Syntax">Syntax</a>
<li><code>interface configuration</code>: <a href="#interfaces">interfaces</a>
<li><code>InterfaceName</code>: <a href="#interfacename">interfacename</a>
<li><code>IsDir()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>IsLink()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>IsNewerThan()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>IsPlain()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>l=</code>: <a href="#Syntax">Syntax</a>
<li><code>LD_LIBRARY_PATH</code>: <a href="#control">control</a>
<li><code>link</code>: <a href="#Syntax">Syntax</a>
<li><code>linkchildren</code>: <a href="#Link%20Children">Link Children</a>, <a href="#Files%20linkchildren">Files linkchildren</a>
<li><code>links</code>: <a href="#links">links</a>, <a href="#actionsequence">actionsequence</a>
<li><code>m=</code>: <a href="#Syntax">Syntax</a>
<li><code>mailcheck</code>: <a href="#mailserver">mailserver</a>, <a href="#actionsequence">actionsequence</a>
<li><code>mailserver</code>: <a href="#mailserver">mailserver</a>
<li><code>MaxCfengines</code>: <a href="#Special%20variables">Special variables</a>
<li><code>miscmounts</code>: <a href="#miscmounts">miscmounts</a>
<li><code>mode</code>: <a href="#Syntax">Syntax</a>
<li><code>module:</code>: <a href="#actionsequence">actionsequence</a>
<li><code>moduledirectory</code>: <a href="#moduledirectory">moduledirectory</a>
<li><code>mountables</code>: <a href="#mountables">mountables</a>, <a href="#homeservers">homeservers</a>
<li><code>mountall</code>: <a href="#actionsequence">actionsequence</a>
<li><code>mountinfo</code>: <a href="#actionsequence">actionsequence</a>
<li><code>mountpattern</code>: <a href="#mountpattern">mountpattern</a>
<li><code>netconfig</code>: <a href="#actionsequence">actionsequence</a>
<li><code>netmask</code>: <a href="#netmask">netmask</a>, <a href="#control">control</a>
<li><code>nfstype</code>: <a href="#nfstype">nfstype</a>, <a href="#control">control</a>
<li><code>o=</code>: <a href="#Syntax">Syntax</a>
<li><code>ones</code>: <a href="#broadcast">broadcast</a>
<li><code>OutputPrefix</code>: <a href="#Special%20variables">Special variables</a>
<li><code>owner</code>: <a href="#Syntax">Syntax</a>
<li><code>p=</code>: <a href="#tidy">tidy</a>
<li><code>pattern</code>: <a href="#tidy">tidy</a>
<li><code>processes</code>: <a href="#actionsequence">actionsequence</a>
<li><code>purge=</code>: <a href="#copy">copy</a>
<li><code>r=</code>: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li><code>recurse</code>: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li><code>RepChar</code>: <a href="#repchar">repchar</a>
<li><code>repchar</code>: <a href="#Special%20variables">Special variables</a>
<li><code>required</code>: <a href="#actionsequence">actionsequence</a>
<li><code>resolve</code>: <a href="#resolve">resolve</a>, <a href="#actionsequence">actionsequence</a>
<li><code>Restricting access</code>: <a href="#access">access</a>
<li><code>ReturnsZero()</code>: <a href="#Evaluated%20classes">Evaluated classes</a>
<li><code>rotate=</code>: <a href="#disable">disable</a>
<li><code>scheduling</code>: <a href="#schedule">schedule</a>
<li><code>SecureInput</code>: <a href="#secureinput">secureinput</a>
<li><code>SensibleCount</code>: <a href="#sensiblecount">sensiblecount</a>
<li><code>sensiblecount</code>: <a href="#control">control</a>
<li><code>SensibleSize</code>: <a href="#sensiblesize">sensiblesize</a>
<li><code>sensiblesize</code>: <a href="#control">control</a>
<li><code>shellcommands</code>: <a href="#actionsequence">actionsequence</a>
<li><code>ShowActions</code>: <a href="#showactions">showactions</a>
<li><code>singlelinks</code>: <a href="#actionsequence">actionsequence</a>
<li><code>site</code>: <a href="#site">site</a>, <a href="#control">control</a>
<li><code>smtpserver</code>: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li><code>split</code>: <a href="#split">split</a>, <a href="#Special%20variables">Special variables</a>
<li><code>SpoolDirectories</code>: <a href="#spooldirectories">spooldirectories</a>
<li><code>SuspiciousNames</code>: <a href="#suspiciousnames">suspiciousnames</a>
<li><code>sysadm</code>: <a href="#Cfexecd%20reference">Cfexecd reference</a>, <a href="#sysadm">sysadm</a>, <a href="#control">control</a>
<li><code>tidy</code>: <a href="#tidy">tidy</a>, <a href="#actionsequence">actionsequence</a>
<li><code>timezone</code>: <a href="#control">control</a>
<li><code>touch</code>: <a href="#touch">touch</a>
<li><code>truncate</code>: <a href="#disable">disable</a>
<li><code>type=</code>: <a href="#Hard%20links">Hard links</a>, <a href="#disable">disable</a>
<li><code>underscoreclasses</code>: <a href="#Special%20variables">Special variables</a>
<li><code>unmount</code>: <a href="#unmount">unmount</a>, <a href="#actionsequence">actionsequence</a>
<li><code>Wildcards</code>: <a href="#tidy">tidy</a>
<li><code>zeroes</code>: <a href="#broadcast">broadcast</a>
<li><code>zeros</code>: <a href="#broadcast">broadcast</a>
</ul>
<p><hr>
Node:<a name="Concept%20Index">Concept Index</a>,
Next:<a rel=next href="#FAQ%20Index">FAQ Index</a>,
Previous:<a rel=previous href="#Variable%20Index">Variable Index</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>Concept Index</h1>

<ul compact>
<li>!: <a href="#Cfengine%20classes">Cfengine classes</a>
<li><code>--dry-run</code> option: <a href="#shellcommands">shellcommands</a>
<li>-D option: <a href="#addclasses">addclasses</a>
<li>-l option: <a href="#tidy">tidy</a>
<li><code>-L</code> option: <a href="#Single%20links">Single links</a>
<li>-l option: <a href="#Syntax">Syntax</a>
<li>-x option: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>.cfdisabled</code>: <a href="#disable">disable</a>
<li>.cfengine.rm: <a href="#tidy">tidy</a>
<li><code>.cfnew</code> files: <a href="#copy">copy</a>
<li><code>.cfsaved</code> files: <a href="#Multiple%20Links">Multiple Links</a>
<li>.X11 directory: <a href="#ignore">ignore</a>
<li>/etc/host.conf: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>/etc/hosts.equiv</code>: <a href="#disable">disable</a>
<li>/var/cfengine/output: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li>Absolute links: <a href="#Single%20links">Single links</a>
<li>Access control: <a href="#access">access</a>
<li>Access control lists: <a href="#acl">acl</a>
<li>ACL key: <a href="#ACEs">ACEs</a>
<li>ACLs: <a href="#acl">acl</a>
<li>action sequence: <a href="#actionsequence">actionsequence</a>
<li>Adding defined classes: <a href="#addclasses">addclasses</a>
<li>Adding new classes: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li>AFS: <a href="#nfstype">nfstype</a>
<li>allclasses variable: <a href="#shellcommands">shellcommands</a>
<li><code>AllowConnectionsFrom</code> variable: <a href="#AllowConnectionsFrom">AllowConnectionsFrom</a>
<li>AllowUsers in cfservd: <a href="#AllowUsers">AllowUsers</a>
<li>Andrew filesystem: <a href="#nfstype">nfstype</a>
<li>atime tidies: <a href="#tidy">tidy</a>
<li><code>AutoCreate</code>: <a href="#editfiles">editfiles</a>
<li><code>AutoExecInterval</code> variable: <a href="#AutoExecInterval">AutoExecInterval</a>
<li>automounter: <a href="#editfiles">editfiles</a>
<li>awk, editing: <a href="#editfiles">editfiles</a>
<li>Backup of files in copy: <a href="#copy">copy</a>
<li><code>BeginGroupIfDefined</code>: <a href="#editfiles">editfiles</a>
<li><code>BeginGroupIfFileExists</code>: <a href="#editfiles">editfiles</a>
<li><code>BeginGroupIfFileIsNewer</code>: <a href="#editfiles">editfiles</a>
<li><code>BeginGroupIfNotDefined</code>: <a href="#editfiles">editfiles</a>
<li>Binary servers and links: <a href="#Link%20Children">Link Children</a>, <a href="#Single%20links">Single links</a>
<li>Binary servers, defining: <a href="#binservers">binservers</a>
<li>Binary servers, priority: <a href="#Single%20links">Single links</a>, <a href="#binservers">binservers</a>
<li>Bootstrap file: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li>Broadcast address: <a href="#broadcast">broadcast</a>
<li>Broadcasts to the cfengine service.: <a href="#cfrun">cfrun</a>
<li>CatchAbort: <a href="#editfiles">editfiles</a>
<li><code>cf.groups</code>: <a href="#cf.groups">cf.groups</a>
<li><code>cf.main</code>: <a href="#cf.main">cf.main</a>
<li><code>cf.motd</code>: <a href="#cf.motd">cf.motd</a>
<li>cf.preconf bootstrap file: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li><code>cf.site</code>: <a href="#cfservd.conf">cfservd.conf</a>, <a href="#cf.site">cf.site</a>
<li><code>cfagent.conf</code>: <a href="#cfagent.conf">cfagent.conf</a>
<li>CFALLCLASSES: <a href="#shellcommands">shellcommands</a>, <a href="#Special%20variables">Special variables</a>
<li>cfenvd and key entropy: <a href="#Cfkey">Cfkey</a>
<li>cfexecd: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li>cfrc resource file: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li>cfrun, limiting users on server: <a href="#AllowUsers">AllowUsers</a>
<li><code>cfrunCommand</code> variable: <a href="#cfrunCommand">cfrunCommand</a>
<li><code>cfservd.conf</code> file: <a href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd.conf and cfrun reference</a>
<li>Changing cfengine port: <a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>
<li>Checksum warning, turning off exclamation: <a href="#exclamation">exclamation</a>
<li>ChecksumDatabase: <a href="#ChecksumDatabase">ChecksumDatabase</a>
<li><code>ChecksumDatabase</code> variable: <a href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>
<li>ChecksumUpdates: <a href="#ChecksumUpdates">ChecksumUpdates</a>
<li>Class data and scripts: <a href="#Special%20variables">Special variables</a>
<li>Class decided by shell command: <a href="#groups">groups</a>
<li>Class dependencies: <a href="#groups">groups</a>
<li>Class information, passing to scripts: <a href="#shellcommands">shellcommands</a>
<li><code>classes</code>: <a href="#groups">groups</a>, <a href="#classes">classes</a>
<li>classes: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Classes, adding and defining: <a href="#addclasses">addclasses</a>
<li>Classes, compound: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Classes, defining and undefining: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Classes, inbuilt functions: <a href="#Evaluated%20classes">Evaluated classes</a>
<li>Comparing file objects: <a href="#Evaluated%20classes">Evaluated classes</a>
<li>Compound classes: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Contacting specific hosts with cfrun: <a href="#cfrun">cfrun</a>
<li>control section: <a href="#control">control</a>
<li>Controlling the size of log files: <a href="#disable">disable</a>
<li>copy: <a href="#copy">copy</a>
<li>Copy, exact filetree images: <a href="#copy">copy</a>
<li>Copying files: <a href="#copy">copy</a>
<li>Creating files: <a href="#create">create</a>
<li>ctime tidies: <a href="#tidy">tidy</a>
<li>DCE key: <a href="#DFS%20ACLs">DFS ACLs</a>
<li>Deadlock: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li>Deadlock zombie bug in restart: <a href="#processes">processes</a>
<li>Declaring classes: <a href="#addinstallable">addinstallable</a>
<li>Decrementing line pointer in editfiles: <a href="#editfiles">editfiles</a>
<li>Defining a binary server: <a href="#binservers">binservers</a>
<li>Defining a home server: <a href="#homeservers">homeservers</a>
<li>Defining a mail server: <a href="#mailserver">mailserver</a>
<li>Defining a mountable: <a href="#mountables">mountables</a>
<li>Defining before use: <a href="#addinstallable">addinstallable</a>
<li>Defining classes: <a href="#classes">classes</a>, <a href="#addclasses">addclasses</a>
<li>Defining groups: <a href="#groups">groups</a>
<li>DeleteNonOwnerMail: <a href="#deletenonownerfiles">deletenonownerfiles</a>
<li>DeleteNonUserFiles: <a href="#deletenonownerfiles">deletenonownerfiles</a>
<li>DeleteNonUserMail DeleteNonUserFiles: <a href="#deletenonuserfiles">deletenonuserfiles</a>
<li>Deleting directories: <a href="#tidy">tidy</a>
<li>Deleting files: <a href="#tidy">tidy</a>
<li>Deleting stale links: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li><code>DenyBadClocks</code> variable: <a href="#DenyBadClocks">DenyBadClocks</a>
<li><code>DenyConnectionsFrom</code> variable: <a href="#DenyConnectionsFrom">DenyConnectionsFrom</a>
<li>Dependencies: <a href="#groups">groups</a>
<li>Device boundaries: <a href="#copy">copy</a>
<li>Device boundaries and files: <a href="#Recursion">Recursion</a>
<li>DFS: <a href="#nfstype">nfstype</a>
<li>DHCP: <a href="#actionsequence">actionsequence</a>
<li>Directories, deleting: <a href="#tidy">tidy</a>
<li>Directories, hidden: <a href="#fileextension">fileextension</a>
<li>Directories, making: <a href="#directories">directories</a>
<li>Directory for cfengine modules: <a href="#moduledirectory">moduledirectory</a>
<li>Directory permissions: <a href="#Directory%20permissions">Directory permissions</a>
<li>Disabling file types: <a href="#disable">disable</a>
<li>Disabling files: <a href="#disable">disable</a>
<li>disks actions: <a href="#disks">disks</a>
<li>DNS: <a href="#resolve">resolve</a>
<li>domain: <a href="#domain">domain</a>
<li>Domain name: <a href="#netmask">netmask</a>
<li>Dots in hostnames: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Double quotes: <a href="#editfiles">editfiles</a>
<li>DryRun: <a href="#dryrun">dryrun</a>
<li>Dual homed hosts: <a href="#interfaces">interfaces</a>
<li>Empty files: <a href="#tidy">tidy</a>
<li>Emptying old nameservers from <code>/etc/resolv.conf</code>: <a href="#emptyresolvconf">emptyresolvconf</a>
<li>Environment variable CFALLCLASSES: <a href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>
<li>Example configuration files: <a href="#Example%20configuration%20file">Example configuration file</a>
<li>Exclamation marks, turning off: <a href="#exclamation">exclamation</a>
<li>Excluding classes: <a href="#addclasses">addclasses</a>
<li>Excluding files from a file sweep: <a href="#Syntax">Syntax</a>
<li>Field separator in editfiles: <a href="#editfiles">editfiles</a>
<li>File images (copy): <a href="#copy">copy</a>
<li>File management: <a href="#files">files</a>
<li>File sizes, specifying: <a href="#tidy">tidy</a>
<li>File tree images: <a href="#copy">copy</a>
<li>File types: <a href="#Evaluated%20classes">Evaluated classes</a>
<li>Files, breaking up into several: <a href="#import">import</a>
<li>Files, checking permissions: <a href="#files">files</a>
<li>Files, home wildcard: <a href="#home%20directive">home directive</a>
<li>Files, importing: <a href="#import">import</a>
<li>Files, ownership: <a href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>
<li>Files, recursion: <a href="#Recursion">Recursion</a>
<li>Files, setting owner: <a href="#files">files</a>
<li>Files, syntax: <a href="#Syntax">Syntax</a>
<li>Force copying: <a href="#copy">copy</a>
<li>freespace=: <a href="#required">required</a>, <a href="#disks">disks</a>
<li>Full disk warnings: <a href="#required">required</a>, <a href="#disks">disks</a>
<li>Fully qualified names: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Group dependencies: <a href="#groups">groups</a>
<li>Group field, editing: <a href="#editfiles">editfiles</a>
<li><code>groups</code>: <a href="#groups">groups</a>
<li>groups: <a href="#classes">classes</a>
<li>Groups, defining: <a href="#groups">groups</a>
<li>Hard class name collision: <a href="#Special%20variables">Special variables</a>
<li>Hardlinks: <a href="#Hard%20links">Hard links</a>
<li>Hashes of files: <a href="#Syntax">Syntax</a>, <a href="#ChecksumDatabase">ChecksumDatabase</a>
<li>home directive: <a href="#home%20directive">home directive</a>
<li>Home path: <a href="#homepattern">homepattern</a>
<li>Home servers, defining: <a href="#homeservers">homeservers</a>
<li>home wildcard: <a href="#Syntax">Syntax</a>
<li>Homepattern variable.: <a href="#mountables">mountables</a>
<li>Host name gets truncated: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Hostname collision: <a href="#Special%20variables">Special variables</a>
<li>Hung machine: <a href="#cf.preconf%20bootstrap%20file">cf.preconf bootstrap file</a>
<li>ignore command: <a href="#ignore">ignore</a>
<li>Import files, variables in: <a href="#import">import</a>
<li>Importing files: <a href="#import">import</a>
<li>Incrementing line pointer in editfiles: <a href="#editfiles">editfiles</a>
<li>Interface name, redefining by class: <a href="#interfacename">interfacename</a>
<li>InterfaceName: <a href="#interfacename">interfacename</a>
<li>Internal classes, switching off: <a href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>
<li>Internet address: <a href="#netmask">netmask</a>
<li>IP address: <a href="#netmask">netmask</a>
<li>Iterating over lists in shellcommands: <a href="#shellcommands">shellcommands</a>
<li>Iteration over lists: <a href="#split">split</a>
<li>Key entropy and cfenvd: <a href="#Cfkey">Cfkey</a>
<li>Key security of users: <a href="#AllowUsers">AllowUsers</a>
<li>Key, ACL: <a href="#DFS%20ACLs">DFS ACLs</a>
<li>Kilobyte, filesize unit: <a href="#tidy">tidy</a>
<li>Linkchildren: <a href="#Link%20Children">Link Children</a>, <a href="#Files%20linkchildren">Files linkchildren</a>
<li>Links and binary servers: <a href="#Link%20Children">Link Children</a>, <a href="#Single%20links">Single links</a>
<li>Links, absolute: <a href="#Single%20links">Single links</a>
<li>Links, deleting stale: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li>Links, forcing for non-existent files: <a href="#Single%20links">Single links</a>
<li>Links, making: <a href="#links">links</a>
<li>Links, multiple: <a href="#Multiple%20Links">Multiple Links</a>
<li>Links, removing dead: <a href="#Single%20links">Single links</a>
<li>Links, single: <a href="#Single%20links">Single links</a>
<li>Links, traversing in searches: <a href="#tidy">tidy</a>, <a href="#Syntax">Syntax</a>
<li>Local disk space, make use of: <a href="#Link%20Children">Link Children</a>
<li>Log files, controlling the size of: <a href="#disable">disable</a>
<li>Logical NOT: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Mail server, defining: <a href="#mailserver">mailserver</a>
<li>Mailing output: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li>Making directories: <a href="#directories">directories</a>
<li>Making links: <a href="#links">links</a>
<li>Making paths: <a href="#directories">directories</a>
<li>Making use of local disk space: <a href="#Link%20Children">Link Children</a>
<li><code>MaxConnections</code> variable: <a href="#MaxConnections">MaxConnections</a>
<li>Megabytes, filesize unit: <a href="#tidy">tidy</a>
<li>Message digests: <a href="#Syntax">Syntax</a>, <a href="#ChecksumDatabase">ChecksumDatabase</a>
<li>Miscellaneous mount operations: <a href="#miscmounts">miscmounts</a>
<li>Module directory: <a href="#moduledirectory">moduledirectory</a>
<li>Modules, user defined: <a href="#actionsequence">actionsequence</a>
<li>Mount paths: <a href="#mountpattern">mountpattern</a>
<li>Mountable resources, defining: <a href="#mountables">mountables</a>, <a href="#homeservers">homeservers</a>
<li>Mounted filesystems: <a href="#copy">copy</a>
<li>Mounting filesystems.: <a href="#miscmounts">miscmounts</a>
<li>mtime tidies: <a href="#tidy">tidy</a>
<li>Multiple links: <a href="#Multiple%20Links">Multiple Links</a>
<li>Name collision: <a href="#Special%20variables">Special variables</a>
<li>NAT: <a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>
<li>Negating classes: <a href="#actionsequence">actionsequence</a>
<li>Negating entries from netgroups: <a href="#groups">groups</a>
<li>Netgroups: <a href="#groups">groups</a>
<li>Netgroups, negating entries: <a href="#groups">groups</a>
<li>Netmask: <a href="#netmask">netmask</a>
<li>netmask: <a href="#netmask">netmask</a>
<li>Network address translator: <a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>
<li>Network Address Translators: <a href="#SkipVerify">SkipVerify</a>
<li>Network interfaces, several: <a href="#interfaces">interfaces</a>
<li>New systems, support for: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li>nfs: <a href="#nfstype">nfstype</a>
<li>NFS mount model and automounter: <a href="#editfiles">editfiles</a>
<li>nfstype: <a href="#nfstype">nfstype</a>
<li>NIS, netgroup support: <a href="#groups">groups</a>
<li>NOT operator: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>NT, ACL: <a href="#NT%20ACLs">NT ACLs</a>
<li>ones: <a href="#broadcast">broadcast</a>
<li>Operator ordering: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Output logs: <a href="#Cfexecd%20reference">Cfexecd reference</a>
<li>Ownership of files: <a href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>
<li>Password file, editing: <a href="#editfiles">editfiles</a>
<li>Path to home directories: <a href="#homepattern">homepattern</a>
<li>Path to mounted filesystems: <a href="#mountpattern">mountpattern</a>
<li>Paths, making: <a href="#directories">directories</a>
<li>Pattern matching in file sweeps: <a href="#Syntax">Syntax</a>
<li>Permissions, directories: <a href="#Directory%20permissions">Directory permissions</a>
<li>Port, connecting to different: <a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>
<li>Preserving file times in copy: <a href="#copy">copy</a>
<li>Previewing shellcommands: <a href="#shellcommands">shellcommands</a>
<li>PRNG not seeded: <a href="#Cfkey">Cfkey</a>
<li>Processes, 0 to 3: <a href="#processes">processes</a>
<li>Processes, checking existence of: <a href="#processes">processes</a>
<li>Processes, counting: <a href="#processes">processes</a>
<li>Processes, signalling: <a href="#processes">processes</a>
<li>Public keys: <a href="#copy">copy</a>
<li>Quoted strings: <a href="#editfiles">editfiles</a>
<li>Recursion in files: <a href="#Recursion">Recursion</a>
<li>Relative links: <a href="#Single%20links">Single links</a>
<li>Removing directories: <a href="#tidy">tidy</a>
<li>Removing entries from netgroups: <a href="#groups">groups</a>
<li>Renaming files: <a href="#disable">disable</a>
<li>Replacing file by link: <a href="#disable">disable</a>
<li>Repository filenames, changing: <a href="#repchar">repchar</a>
<li>resolv.conf: <a href="#resolve">resolve</a>
<li>Resolver configuration: <a href="#resolve">resolve</a>
<li>Resource file: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li>Restart zombie deadlock bug: <a href="#processes">processes</a>
<li>Restricting the size of binary files to be edited: <a href="#editbinaryfilesize">editbinaryfilesize</a>
<li>Restricting the size of files to be edited: <a href="#editfilesize">editfilesize</a>
<li>rmdirs: <a href="#tidy">tidy</a>
<li>Rotating log files: <a href="#disable">disable</a>
<li>Running cfengine from a single master host: <a href="#cfrun">cfrun</a>
<li>Running <code>cfrun</code>: <a href="#cfrun">cfrun</a>
<li>scheduling: <a href="#schedule">schedule</a>
<li>Scripts and class information: <a href="#shellcommands">shellcommands</a>
<li>Scripts, passing classes to: <a href="#Special%20variables">Special variables</a>
<li>Search patterns in <code>files</code>: <a href="#Syntax">Syntax</a>
<li>Searching for home directories: <a href="#homepattern">homepattern</a>
<li>Searching, advanced: <a href="#filters">filters</a>
<li>Secure input: <a href="#secureinput">secureinput</a>
<li>sed, editing: <a href="#editfiles">editfiles</a>
<li>Selecting files in searches: <a href="#filters">filters</a>
<li>Sensible file sizes: <a href="#sensiblesize">sensiblesize</a>
<li>Sensible limits on files in a directory: <a href="#sensiblecount">sensiblecount</a>
<li>Setting uid on restarted processes: <a href="#processes">processes</a>
<li>Several files: <a href="#import">import</a>
<li>Shell command to decide class: <a href="#groups">groups</a>
<li>Single links: <a href="#Single%20links">Single links</a>
<li>Single quotes: <a href="#editfiles">editfiles</a>
<li>site: <a href="#site">site</a>
<li>size field in disable: <a href="#disable">disable</a>
<li>Specifying file sizes: <a href="#tidy">tidy</a>
<li>SplayTime in cfrun: <a href="#cfrun">cfrun</a>
<li>split: <a href="#split">split</a>
<li>SplitOn: <a href="#editfiles">editfiles</a>
<li>SpoolDirectories: <a href="#spooldirectories">spooldirectories</a>
<li>Subnet mask: <a href="#netmask">netmask</a>
<li>Support for new systems: <a href="#cfrc%20resource%20file">cfrc resource file</a>
<li>suspiciousnames: <a href="#suspiciousnames">suspiciousnames</a>
<li>Switching off backup in copy: <a href="#copy">copy</a>
<li>Switching off internal classes: <a href="#Cfagent%20Runtime%20Options">Cfagent Runtime Options</a>
<li>Symbolic links, absolute: <a href="#Single%20links">Single links</a>
<li>Symbolic links, relative: <a href="#Single%20links">Single links</a>
<li>sysadm: <a href="#sysadm">sysadm</a>
<li>Testing files: <a href="#Evaluated%20classes">Evaluated classes</a>
<li>Tidy by ctime, mtime, atime: <a href="#tidy">tidy</a>
<li>Tidy log files for users: <a href="#LogTidyHomeFiles">LogTidyHomeFiles</a>
<li>Tidying empty files: <a href="#tidy">tidy</a>
<li>Tidying files: <a href="#tidy">tidy</a>
<li><code>timeout=</code> in shellcommands: <a href="#shellcommands">shellcommands</a>
<li>Timeouts during iterations: <a href="#shellcommands">shellcommands</a>
<li>Too many open files error: <a href="#Too%20many%20open%20files">Too many open files</a>
<li>Touching files: <a href="#touch">touch</a>
<li>Tree copying, exact: <a href="#copy">copy</a>
<li>Tripwire functionality: <a href="#Syntax">Syntax</a>, <a href="#ChecksumDatabase">ChecksumDatabase</a>
<li>Truncating log files: <a href="#disable">disable</a>
<li>Trusted hosts: <a href="#copy">copy</a>
<li><code>TrustKeysFrom</code> variable: <a href="#TrustKeysFrom">TrustKeysFrom</a>
<li>umask: <a href="#shellcommands">shellcommands</a>, <a href="#processes">processes</a>, <a href="#editfiles">editfiles</a>
<li>underscoreclasses: <a href="#Special%20variables">Special variables</a>
<li>Unmounting filesystems: <a href="#unmount">unmount</a>
<li>Variables in import files: <a href="#import">import</a>
<li>Warning about full disks: <a href="#required">required</a>, <a href="#disks">disks</a>
<li>Wildcard home: <a href="#Syntax">Syntax</a>
<li>Wildcards in homepattern: <a href="#homepattern">homepattern</a>
<li>WWW server logs: <a href="#disable">disable</a>
<li>xdev (File system boundaries): <a href="#Recursion">Recursion</a>
<li>zeros: <a href="#broadcast">broadcast</a>
</ul>
<p><hr>
Node:<a name="FAQ%20Index">FAQ Index</a>,
Previous:<a rel=previous href="#Concept%20Index">Concept Index</a>,
Up:<a rel=up href="#Top">Top</a>
<br>

<h1>FAQ Index</h1>

<ul compact>
<li>Brackets (parentheses) in classes.: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Can't stat error when remote copying: <a href="#DenyBadClocks">DenyBadClocks</a>
<li>Changing repository name conventions: <a href="#repchar">repchar</a>
<li>Checksums take too long to compute.: <a href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>
<li>copy doesn't always copy files: <a href="#copy">copy</a>
<li>ctime copy doesn't always copy files: <a href="#copy">copy</a>
<li>Denial of service attacks: <a href="#AllowConnectionsFrom">AllowConnectionsFrom</a>
<li>Hanging commands, timeouts: <a href="#shellcommands">shellcommands</a>
<li>Hanging connections attacks: <a href="#AllowConnectionsFrom">AllowConnectionsFrom</a>
<li>Hey! Cannot stat file error: <a href="#copy">copy</a>
<li>How can I avoid hanging shellcommands?: <a href="#shellcommands">shellcommands</a>
<li>How can I set a timeout for a shell command?: <a href="#shellcommands">shellcommands</a>
<li>How to create files while editing: <a href="#editfiles">editfiles</a>
<li>Iterating over lists: <a href="#split">split</a>
<li>MD5 checksums take a long time to compute.: <a href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase in cfservd</a>
<li>Parentheses in classes.: <a href="#Cfengine%20classes">Cfengine classes</a>
<li>Remote copy problems, can't stat: <a href="#copy">copy</a>
<li>Too many open files error: <a href="#Too%20many%20open%20files">Too many open files</a>
</ul>

<h1>Table of Contents</h1>
<ul>
<li><a href="#Top">Cfengine-Reference</a>
<li><a href="#Reference%20introduction">Inroduction to reference manual</a>
<ul>
<li><a href="#Installation">Installation</a>
<li><a href="#Work%20directory">Work directory</a>
<li><a href="#Hard%20classes">Cfengine hard classes</a>
<li><a href="#Evaluated%20classes">Evaluated classes</a>
<li><a href="#Filenames%20and%20paths">Filenames and paths</a>
</ul>
<li><a href="#Cfkey">Cfkey reference</a>
<li><a href="#Cfagent%20reference">Cfagent reference</a>
<ul>
<li><a href="#Cfagent%20intro">Cfagent intro</a>
<ul>
<li><a href="#The%20file%20cfagent.conf">The file cfagent.conf</a>
<li><a href="#Cfagent%20Runtime%20Options">Cfagent runtime options</a>
</ul>
<li><a href="#Special%20variables">Special variables</a>
<li><a href="#Cfengine%20classes">Cfengine classes</a>
<li><a href="#acl">acl</a>
<ul>
<li><a href="#ACEs">Access control entries</a>
<li><a href="#Solaris%20ACLs">Solaris ACLs</a>
<li><a href="#DFS%20ACLs">DFS ACLs</a>
<li><a href="#NT%20ACLs">NT ACLs</a>
</ul>
<li><a href="#NT%20ACLs">ACL Example</a>
<ul>
<li><a href="#ACL%20Example">ACL Example</a>
</ul>
<li><a href="#binservers">binservers</a>
<li><a href="#broadcast">broadcast</a>
<li><a href="#control">control</a>
<ul>
<li><a href="#access">access</a>
<li><a href="#actionsequence">actionsequence</a>
<li><a href="#addclasses">AddClasses</a>
<li><a href="#addinstallable">AddInstallable</a>
<li><a href="#BinaryPaddingChar">BinaryPaddingChar</a>
<li><a href="#ChecksumDatabase">ChecksumDatabase</a>
<li><a href="#ChecksumUpdates">ChecksumUpdates</a>
<li><a href="#childlibpath">ChildLibPath</a>
<li><a href="#copylinks">CopyLinks</a>
<li><a href="#defaultcopytype">DefaultCopyType</a>
<li><a href="#deletenonuserfiles">DeleteNonUserFiles</a>
<li><a href="#deletenonownerfiles">DeleteNonOwnerFiles</a>
<li><a href="#deletenonusermail">DeleteNonUserMail</a>
<li><a href="#deletenonownermail">DeleteNonOwnerMail</a>
<li><a href="#domain">domain</a>
<li><a href="#dryrun">DryRun</a>
<li><a href="#editbinaryfilesize">editbinaryfilesize</a>
<li><a href="#editfilesize">editfilesize</a>
<li><a href="#emptyresolvconf">EmptyResolvConf</a>
<li><a href="#exclamation">Exclamation</a>
<li><a href="#excludecopy">ExcludeCopy</a>
<li><a href="#excludelinks">ExcludeLinks</a>
<li><a href="#ExpireAfter">ExpireAfter</a>
<li><a href="#homepattern">HomePattern</a>
<li><a href="#IfElapsed">IfElapsed</a>
<li><a href="#Inform">Inform</a>
<li><a href="#interfacename">InterfaceName</a>
<li><a href="#fileextension">FileExtensions</a>
<li><a href="#linkcopies">LinkCopies</a>
<li><a href="#LogDirectory">LogDirectory</a>
<li><a href="#LogTidyHomeFiles">LogTidyHomeFiles</a>
<li><a href="#moduledirectory">moduledirectory</a>
<li><a href="#mountpattern">mountpattern</a>
<li><a href="#netmask">netmask</a>
<li><a href="#nonalphanumfiles">NonAlphaNumFiles</a>
<li><a href="#nfstype">nfstype</a>
<li><a href="#repchar">RepChar</a>
<li><a href="#repository">Repository</a>
<li><a href="#schedule">Schedule</a>
<li><a href="#secureinput">SecureInput</a>
<li><a href="#sensiblecount">SensibleCount</a>
<li><a href="#sensiblesize">SensibleSize</a>
<li><a href="#showactions">ShowActions</a>
<li><a href="#site">site/faculty</a>
<li><a href="#SplayTime">SplayTime</a>
<li><a href="#split">Split</a>
<li><a href="#spooldirectories">SpoolDirectories</a>
<li><a href="#suspiciousnames">suspiciousnames</a>
<li><a href="#sysadm">sysadm</a>
<li><a href="#Syslog">Syslog</a>
<li><a href="#timezone">timezone</a>
<li><a href="#TimeOut">TimeOut</a>
<li><a href="#Verbose">Verbose</a>
<li><a href="#Warnings">Warnings</a>
<li><a href="#warnnonuserfiles">WarnNonUserFiles</a>
<li><a href="#warnnonownerfiles">WarnNonOwnerFiles</a>
<li><a href="#warnnonusermail">WarnNonUserMail</a>
<li><a href="#warnnonownermail">WarnNonOwnerMail</a>
</ul>
<li><a href="#classes">classes</a>
<li><a href="#copy">copy</a>
<ul>
<li><a href="#hard%20links%20in%20copy">Hard links in copying</a>
<li><a href="#Too%20many%20open%20files">Too many open files</a>
</ul>
<li><a href="#defaultroute">defaultroute</a>
<li><a href="#disks">disks</a>
<li><a href="#directories">directories</a>
<li><a href="#disable">disable</a>
<li><a href="#editfiles">editfiles</a>
<li><a href="#files">files</a>
<ul>
<li><a href="#Syntax">Syntax</a>
<li><a href="#Recursion">Recursion</a>
<li><a href="#Directory%20permissions">Directory permissions</a>
<li><a href="#home%20directive"><code>home</code> directive</a>
<li><a href="#Owner%20and%20group%20wildcards">Owner and group wildcards</a>
<li><a href="#Files%20linkchildren">Files linkchildren</a>
<li><a href="#touch">touch</a>
<li><a href="#create">create</a>
</ul>
<li><a href="#filters">filters</a>
<ul>
<li><a href="#Complete%20filter%20examples">Complete filter examples</a>
</ul>
<li><a href="#groups">groups/classes</a>
<li><a href="#homeservers">homeservers</a>
<li><a href="#ignore">ignore</a>
<li><a href="#import">import</a>
<li><a href="#interfaces">interfaces</a>
<li><a href="#links">links</a>
<ul>
<li><a href="#Single%20links">Single links</a>
<li><a href="#Multiple%20Links">Multiple Links</a>
<li><a href="#Link%20Children">Link Children</a>
<li><a href="#Relative%20and%20absolute%20links">Relative and absolute links</a>
<li><a href="#Hard%20links">Hard Links</a>
</ul>
<li><a href="#mailserver">mailserver</a>
<li><a href="#miscmounts">miscmounts</a>
<li><a href="#mountables">mountables</a>
<li><a href="#processes">processes</a>
<li><a href="#required">required</a>
<li><a href="#resolve">resolve</a>
<li><a href="#shellcommands">shellcommands</a>
<li><a href="#tidy">tidy</a>
<li><a href="#unmount">unmount</a>
</ul>
<li><a href="#Cfservd.conf%20and%20cfrun%20reference">Cfservd and cfrun reference</a>
<ul>
<li><a href="#cfservd%20control">control</a>
<ul>
<li><a href="#AllowConnectionsFrom">AllowConnectionsFrom</a>
<li><a href="#AllowMultipleConnectionsFrom">AllowMultipleConnectionsFrom</a>
<li><a href="#AllowUsers">AllowUsers</a>
<li><a href="#AutoExecCommand">AutoExecCommand</a>
<li><a href="#AutoExecInterval">AutoExecInterval</a>
<li><a href="#ChecksumDatabase%20in%20cfservd">ChecksumDatabase</a>
<li><a href="#cfrunCommand">cfrunCommand</a>
<li><a href="#DenyBadClocks">DenyBadClocks</a>
<li><a href="#DenyConnectionsFrom">DenyConnectionsFrom</a>
<li><a href="#cfservd%20IfElapsed">IfElapsed</a>
<li><a href="#LogAllConnections">LogAllConnections</a>
<li><a href="#MaxConnections">MaxConnections</a>
<li><a href="#TrustKeysFrom">TrustKeysFrom</a>
</ul>
<li><a href="#admit%20grant%20and%20deny">admit, grant and deny</a>
<ul>
<li><a href="#root%3d"><code>root=</code></a>
<li><a href="#encrypt%3d"><code>encrypt=true</code></a>
<li><a href="#SkipVerify">SkipVerify</a>
</ul>
<li><a href="#cfrun"><code>cfrun</code></a>
<li><a href="#Firewalls%20and%20NATs">Firewalls and NATs</a>
</ul>
<li><a href="#Cfexecd%20reference">Cfexecd reference</a>
<li><a href="#Problem%20solving">Problem solving</a>
<ul>
<li><a href="#cf.preconf%20bootstrap%20file"><code>cf.preconf</code> bootstrap file</a>
<li><a href="#cfrc%20resource%20file"><code>cfrc</code> resource file</a>
</ul>
<li><a href="#Example%20configuration%20file">Example configuration files</a>
<ul>
<li><a href="#cfagent.conf">cfagent.conf</a>
<li><a href="#cf.groups">cf.groups</a>
<li><a href="#cf.main">cf.main</a>
<li><a href="#cf.site">cf.site</a>
<li><a href="#cf.motd">cf.motd</a>
<li><a href="#cf.users">cf.users</a>
<li><a href="#cf.solaris">cf.solaris</a>
<li><a href="#cf.linux">cf.linux</a>
<li><a href="#cf.freebsd">cf.freebsd / cf.netbsd</a>
<li><a href="#cfservd.conf">cfservd.conf</a>
</ul>
<li><a href="#Variable%20Index">Variable Index</a>
<li><a href="#Concept%20Index">Concept Index</a>
<li><a href="#FAQ%20Index">FAQ Index</a>
</ul>


</body></html>

